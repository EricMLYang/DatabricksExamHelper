# Generate Variants - 情境變形題生成技能

> 針對高頻錯題或核心考點，產生 3-5 題情境變形題，防止死背答案

---

## 🎯 技能目的

此技能用於**從單一原題擴展出多個變形題**，確保：
1. **深度理解** - 不只記住答案，而是真正掌握考點
2. **情境遷移** - 能在不同場景下應用相同概念
3. **陷阱免疫** - 透過多角度練習，避開常見陷阱

適用情境：
- 針對錯題進行變形訓練，避免死背答案
- 強化核心考點的理解深度
- 考前衝刺時針對弱點主題密集練習

---

## 📥 輸入格式

### 必要資訊
```markdown
**原題 ID:** Q-XXX-XXX
**原題題幹:** [原始題目描述]
**核心考點:** [要變形的考點]
**正確答案:** [原題正解]
```

### 選填資訊
- **變形方向:** [指定變形的面向，如「改變參數」、「改變情境」、「反向提問」]
- **難度調整:** [L1/L2/L3，預設與原題相同]
- **排除陷阱:** [不希望重複的陷阱類型]

---

## 📤 輸出結構

### 每個變形題包含
1. **變形題 ID** - 格式：原題 ID + `-V{序號}` (例如：Q-MOCK01-023-V1)
2. **題幹** - 改寫後的情境描述
3. **選項** - 4 個選項（A/B/C/D）
4. **正確答案**
5. **變形重點** - 說明此變形題與原題的差異
6. **簡要解析** - 核心考點與解題關鍵

---

## 🔄 六種變形策略

### 策略 1: 參數變換
改變題目中的數值、單位、或配置參數。

**適用場景:** 測試對參數範圍、單位換算的理解
**範例:** RETAIN 30 天 → RETAIN 7 天 / 90 天

---

### 策略 2: 情境改寫
維持考點，但改變應用情境或業務背景。

**適用場景:** 測試概念遷移能力
**範例:** Delta Lake 清理 → Streaming Checkpoint 清理

---

### 策略 3: 反向提問
將題目問法反向，如「哪個正確」→「哪個錯誤」。

**適用場景:** 測試是否真正理解，而非記答案
**範例:** 「以下哪個可以刪除舊版本」→「以下哪個**不能**刪除舊版本」

---

### 策略 4: 組合考點
將原題考點與其他相關概念組合。

**適用場景:** 測試綜合理解能力
**範例:** VACUUM 單一考點 → VACUUM + Time Travel 組合

---

### 策略 5: 錯誤診斷
提供錯誤的指令或程式碼，要求找出問題。

**適用場景:** 測試debug能力與細節觀察
**範例:** 「以下哪個指令有錯誤」

---

### 策略 6: 最佳實踐
將考點延伸至生產環境的最佳實踐選擇。

**適用場景:** 測試實務判斷能力
**範例:** 「在生產環境中，VACUUM 的 RETAIN 應設定為多少」

---

## 📋 完整使用範例

### 輸入

```markdown
**原題 ID:** Q-MOCK01-023
**原題題幹:** 在 Delta Lake 中，您需要永久刪除超過 30 天的舊版本資料以節省儲存空間。以下哪個指令可以達成此目的？
**核心考點:** Delta Lake VACUUM 指令與 RETAIN 參數
**正確答案:** VACUUM table_name RETAIN 720 HOURS
**變形方向:** 參數變換、反向提問、錯誤診斷
**難度調整:** L2-Intermediate
```

---

### 輸出

## 變形題組：Delta Lake VACUUM 指令變形練習

**原題考點:** Delta Lake VACUUM 指令與 RETAIN 參數
**變形題數:** 5 題
**難度範圍:** L1-Basic 到 L3-Advanced

---

### 變形題 1: 參數變換 - 保留期限縮短

**變形題 ID:** `Q-MOCK01-023-V1`
**難度:** `L1-Basic`

**題幹:**
在 Delta Lake 中，您需要永久刪除超過 **7 天** 的舊版本資料。以下哪個指令可以達成此目的？

**選項:**
- A. `VACUUM table_name RETAIN 7 HOURS`
- B. `VACUUM table_name RETAIN 168 HOURS`
- C. `VACUUM table_name RETAIN 7 DAYS`
- D. `VACUUM table_name`

**正確答案:** B

**變形重點:**
- 將保留期限從 30 天改為 7 天
- 增加「不帶參數的 VACUUM」作為選項D，測試預設值理解
- 保留時間單位換算的核心考點

**簡要解析:**
- **正解 B:** 7 天 × 24 小時 = 168 小時
- **錯誤 A:** 單位換算錯誤（7 小時 ≠ 7 天）
- **錯誤 C:** VACUUM 不接受 DAYS 單位
- **錯誤 D:** 預設保留 168 小時（7 天），但題目要求明確指定

---

### 變形題 2: 反向提問 - 哪個無法達成目的

**變形題 ID:** `Q-MOCK01-023-V2`
**難度:** `L2-Intermediate`

**題幹:**
在 Delta Lake 中，您需要永久刪除超過 30 天的舊版本資料以節省儲存空間。以下哪個指令**無法**達成此目的？

**選項:**
- A. `VACUUM table_name RETAIN 720 HOURS`
- B. `VACUUM table_name RETAIN 1000 HOURS`
- C. `DELETE FROM table_name WHERE _commit_timestamp < current_date() - 30`
- D. `OPTIMIZE table_name ZORDER BY (date_column)`

**正確答案:** C 和 D (多選題)

**變形重點:**
- 反向提問：從「哪個可以」變成「哪個無法」
- 改為多選題，增加難度
- 測試對 DELETE、OPTIMIZE 與 VACUUM 差異的理解

**簡要解析:**
- **正確 A:** 標準 VACUUM 寫法，可達成目的
- **正確 B:** 保留超過 30 天（約 41.7 天），仍可達成目的
- **錯誤 C:** DELETE 是邏輯刪除，不釋放空間
- **錯誤 D:** OPTIMIZE 不刪除舊版本

---

### 變形題 3: 錯誤診斷 - 找出語法錯誤

**變形題 ID:** `Q-MOCK01-023-V3`
**難度:** `L2-Intermediate`

**題幹:**
以下哪個 VACUUM 指令有**語法錯誤**，無法成功執行？

**選項:**
- A. `VACUUM delta.\`default\`.my_table RETAIN 720 HOURS;`
- B. `VACUUM my_table RETAIN 720 HOURS DRY RUN;`
- C. `VACUUM my_table RETAIN 30 DAYS;`
- D. `VACUUM my_table WHERE date < '2024-01-01' RETAIN 168 HOURS;`

**正確答案:** C 和 D

**變形重點:**
- 從應用題變成語法題
- 測試對 VACUUM 完整語法的熟悉度
- 包含較少見的語法（DRY RUN、三段式命名）

**簡要解析:**
- **正確 A:** 三段式命名（catalog.schema.table）合法
- **正確 B:** DRY RUN 是合法選項，用於預覽將刪除的檔案
- **錯誤 C:** RETAIN 不接受 DAYS 單位，只能用 HOURS
- **錯誤 D:** VACUUM 不支援 WHERE 子句

---

### 變形題 4: 組合考點 - VACUUM + Time Travel

**變形題 ID:** `Q-MOCK01-023-V4`
**難度:** `L3-Advanced`

**題幹:**
您對 Delta Table 執行 `VACUUM my_table RETAIN 720 HOURS`。執行後，以下哪個操作**會失敗**？

**選項:**
- A. `SELECT * FROM my_table VERSION AS OF 100`（版本號 100 是 25 天前的版本）
- B. `SELECT * FROM my_table TIMESTAMP AS OF '2024-01-01'`（該日期是 35 天前）
- C. `SELECT * FROM my_table`（查詢當前版本）
- D. `DESCRIBE HISTORY my_table LIMIT 10`（查詢版本歷史）

**正確答案:** B

**變形重點:**
- 結合 VACUUM 與 Time Travel 兩個考點
- 測試對「VACUUM 刪除舊版本後，Time Travel 的影響」的理解
- 進階難度，需要綜合判斷

**簡要解析:**
- **正確 A:** 25 天前的版本仍在保留範圍內（< 30 天），可查詢
- **錯誤 B:** 35 天前的資料檔案已被 VACUUM 刪除，Time Travel 失敗
- **正確 C:** 當前版本不受 VACUUM 影響
- **正確 D:** DESCRIBE HISTORY 顯示元資料，不依賴實體檔案

---

### 變形題 5: 最佳實踐 - 生產環境設定

**變形題 ID:** `Q-MOCK01-023-V5`
**難度:** `L3-Advanced`

**題幹:**
在生產環境中，您的 Delta Table 每天有大量寫入，且需要支援 7 天內的 Time Travel 用於資料復原。考量儲存成本與資料安全，VACUUM 的 RETAIN 應設定為多少？

**選項:**
- A. `RETAIN 168 HOURS`（7 天）
- B. `RETAIN 192 HOURS`（8 天）
- C. `RETAIN 240 HOURS`（10 天）
- D. `RETAIN 720 HOURS`（30 天）

**正確答案:** B 或 C (都可接受，B 為最低安全值)

**變形重點:**
- 從單純技術題變成實務判斷題
- 測試對「安全邊際」的理解
- 需考慮多個因素（Time Travel 需求、儲存成本、容錯空間）

**簡要解析:**
- **錯誤 A:** 設定為 7 天剛好滿足需求，但無容錯空間。若 Time Travel 操作延遲或 VACUUM 提前執行，可能導致資料無法復原
- **正解 B:** 8 天 = 7 天需求 + 1 天容錯，最低安全值
- **正解 C:** 10 天 = 7 天需求 + 3 天容錯，更安全
- **備選 D:** 30 天過於保守，儲存成本較高

**最佳實踐建議:**
\`\`\`
RETAIN = Time Travel 需求 + 容錯天數
建議容錯天數：1-3 天（依業務重要性調整）
\`\`\`

---

## 📊 變形題組總結

### 考點覆蓋矩陣

| 變形題 | 核心考點 | 次要考點 | 陷阱類型 | 難度 |
|-------|---------|---------|---------|------|
| V1 | RETAIN 參數 | 預設值 | 單位換算 | L1 |
| V2 | 指令差異 | 反向邏輯 | 概念混淆 | L2 |
| V3 | VACUUM 語法 | DRY RUN, WHERE | 語法錯誤 | L2 |
| V4 | VACUUM + Time Travel | 版本保留機制 | 綜合判斷 | L3 |
| V5 | 最佳實踐 | 安全邊際 | 實務判斷 | L3 |

### 練習建議
1. **循序漸進:** 依難度順序練習（V1 → V2 → ... → V5）
2. **錯題重做:** 錯誤的變形題，隔天再次練習
3. **交叉驗證:** 完成變形題組後，回顧原題，確認理解深度

---

## 🎯 變形品質標準

### 優質變形題的特徵
- [ ] 保持核心考點不變
- [ ] 情境合理且貼近實務
- [ ] 選項設計有明確的陷阱邏輯
- [ ] 難度適當（與原題 ±1 等級）
- [ ] 每個選項都有排除理由

### 避免的變形錯誤
- ❌ 完全改變考點（失去變形意義）
- ❌ 情境過於牽強（脫離實務）
- ❌ 選項設計隨意（無陷阱邏輯）
- ❌ 難度跳躍過大（L1 直跳 L3）

---

## 💡 使用技巧

### 針對錯題生成變形
```markdown
**我的錯題:** Q-STREAM-015 (誤選 Trigger.Once)
**變形方向:**
1. 改變 Trigger 模式組合
2. 改變資料來源（Kafka → Event Hubs）
3. 加入錯誤處理情境
```

### 針對弱點主題生成變形
```markdown
**弱點主題:** Unity Catalog 權限管理
**原型題:** GRANT / REVOKE 語法
**變形方向:**
1. 不同層級的權限（Metastore / Catalog / Schema）
2. 權限繼承規則
3. 權限撤銷的影響範圍
```

---

## 📋 輸出檢查清單

生成變形題組後，請確認：
- [ ] 至少產生 3 題變形
- [ ] 涵蓋至少 2 種變形策略
- [ ] 每題都有變形重點說明
- [ ] 每題都有簡要解析
- [ ] 難度分佈合理（不全集中在同一等級）

---

## 📞 相關資源

- [solve-question.md](./solve-question.md) - 完整題目解析技能
- [explain-why-not.md](./explain-why-not.md) - 錯誤選項深度拆解
- [tooling/tagging-schema.md](../../tooling/tagging-schema.md) - 標籤規範

---

**透過變形題訓練，從記憶答案提升到深度理解！🔄**
