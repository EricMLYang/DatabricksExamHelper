# Question 2

## Question
A data engineer has the following streaming query with a blank:



```

- spark.readStream
-        .table("orders_cleaned")
-        .groupBy(
-            ___________________________,
-            "author")
-        .agg(
-            count("order_id").alias("orders_count"),
-            avg("quantity").alias("avg_quantity"))
-     .writeStream
-        .option("checkpointLocation", "dbfs:/path/checkpoint")
-        .table("orders_stats")
```





They want to calculate the orders count and average quantity for each non-overlapping 15-minute interval.




Which option correctly fills in the blank to meet this requirement ?

## Options
- A. window("order_timestamp", "15 minutes") (Correct)
- B. trigger(processingTime="15 minutes") 
- C. withWatermark("order_timestamp", "15 minutes") 
- D. withWindow("order_timestamp", "15 minutes") 

## Explanation
Pyspark.sql.functions.window function bucketizes rows into one or more time windows given a timestamp specifying column.




Reference:

https://spark.apache.org/docs/3.1.3/api/python/reference/api/pyspark.sql.functions.window.html




Study materials from our exam preparation course on Udemy:

Hands-on
