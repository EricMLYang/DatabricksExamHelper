# Question 6

## Question
A data engineering team is building a LDP pipeline to clean and validate product data streaming in from various sources. They notice that some records in the bronze_products table contain invalid price values, specifically some prices are zero or negative, which violates business rules.




To handle this issue, they implemented the following LDP code:



```

- @dlt.table
- @dlt.expect_or_drop("positive_price", "price > 0")
- def silver_products():
-     return spark.readStream.table("bronze_products")
-  
- @dlt.table
- @dlt.expect_or_drop("invalid_price", "price <= 0")
- def quarantine_products():
-     return spark.readStream.table("bronze_products")
```





Which of the following correctly describes the result of running this pipeline?

## Options
- A. Records with positive prices are loaded into the silver_products table, while records with zero or negative prices are loaded into the quarantine_products table. (Correct)
- B. All records are loaded into the silver_products table, with a flag "quarantine_products" indicating whether the price is valid or not. 
- C. Records with positive prices are loaded into the silver_products table, while records with zero or negative prices are deleted from the bronze_products table. 
- D. All records are updated in the bronze_products table with a flag "quarantine_products" that indicates whether the price is valid or not. 

## Explanation
This LDP* pipeline uses a common pattern for quarantining records by creating a second table that stores the invalid records.




The silver_products table uses `@dlt.expect_or_drop("positive_price", "price > 0")`, which means that only records meeting the condition price > 0 are kept, while any records with zero or negative prices are dropped. As a result, the silver_products table contains only valid product records where prices are positive, ensuring that downstream processes receive clean and business-rule-compliant data.




On the other hand, the quarantine_products table is defined with `@dlt.expect_or_drop("invalid_price", "price <= 0")`, meaning only records with zero or negative prices satisfy this expectation and are retained. This effectively routes all invalid price records into the quarantine table for further inspection or correction.




The original bronze_products table remains unchanged, and no records are deleted from it.




* Databricks has recenlty open-sourced this solution, integrating it into the Apache Spark ecosystem under the name Spark Declarative Pipelines (SDP).
