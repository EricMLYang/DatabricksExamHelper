# Question 45

## Question
A data engineer run the following CTAS statement in a SQL notebook attached to an All-purpose cluster:



```

- CREATE TABLE course_students
- AS ( 	SELECT c.course_name, t.student_id, t.student_name
-         FROM courses c
-         LEFT JOIN (
-             SELECT s.student_id, s.student_name, e.course_id
-             FROM students s 
-             INNER JOIN enrollments e
-             ON s.student_id = e.student_id
-         ) t
-         ON c.course_id = t.course_id
-         WHERE c.active = true
- )
```





Which statement describes the resulting course_students table ?

## Options
- A. It's a session-scoped table. The SELECT statement will be executed at the table creation, but its output will be stored in the cache of the current active Spark session. 
- B. It's a virtual table that has no physical data. The SELECT statement will be executed each time the course_students table is queried. 
- C. It's a cluster-scoped table. The SELECT statement will be executed at the table creation, but its output will be stored in the memory of the currently active cluster. 
- D. It's a Delta Lake table. The SELECT statement will be executed at the table creation, and its output will be stored in Delta format on the underlying storage. (Correct)

## Explanation
`CREATE TABLE AS SELECT` statements, or CTAS statements create new Delta tables and populate them using the output of a SELECT query. So, The query result is stored in Delta format in the directory of the newly created table.







Reference: (cf. AS query clause)

https://docs.databricks.com/sql/language-manual/sql-ref-syntax-ddl-create-table-using.html




Study materials from our exam preparation course on Udemy:
- 

Lecture (Associate course)
- 

Hands-on (Associate course)
