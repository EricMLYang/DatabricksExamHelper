# Question 29

## Question
A data engineering team manages a Delta Lake table in Unity Catalog called employees, with columns: id, name, salary, and region. They want to apply row filtering on this table so that only members of the HR team can access all records. If the table is queried by a non-HR team member, it should only show records in the France (FR) region. To achieve this, they implemented the following user-defined function:



```

- CREATE FUNCTION fr_filter(region STRING)
- RETURN IF(IS_ACCOUNT_GROUP_MEMBER('hr_team'), true, region='FR');
```





Which of the following commands can the team use to apply this function as a row filter to the table?

## Options
- A. SET ROW FILTER fr_filter ON TABLE employees TO COLUMN region 
- B. ALTER TABLE employees SET ROW FILTER fr_filter; 
- C. ALTER TABLE employees SET ROW FILTER fr_filter ON (region); (Correct)
- D. ALTER TABLE employees ALTER COLUMN region SET ROW FILTER fr_filter; 

## Explanation
The correct command to apply the function as a row filter to the Delta Lake table is:




`ALTER TABLE employees SET ROW FILTER fr_filter ON (region);`




This command correctly associates the user-defined function fr_filter with the region column of the employees table, ensuring that access to rows is filtered based on the function's logic. In this setup, when a user queries the table, if they belong to the hr_team account group, they will be able to see all rows; otherwise, only rows where the region column equals 'FR' will be visible.
