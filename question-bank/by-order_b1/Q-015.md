# Question 15

## Question
A data engineer is tasked with creating a comprehensive dashboard to track and analyze the consumption of computing resources across various workloads in their organization. To accomplish this, the engineer writes the following SQL query against the usage system table:



```
- SELECT
-     identity_metadata.run_as,
-     sku_name,
-     usage_date,
-     usage_quantity
- FROM system.billing.usage
- WHERE usage_unit = 'DBU'
```





Which of the following statements most accurately describes the purpose and level of detail provided by this query?

## Options
- A. It monitors the detailed DUB consumption for each type of computing resource per workspace. 
- B. It monitors the detailed DUB consumption for each pipeline run per compute type. 
- C. It monitors the detailed DUB consumption for each type of computing resource per user. (Correct)
- D. It monitors the detailed DUB consumption for each job run per compute type. 

## Explanation
This query aggregates the DBU usage by the user who ran the workload (run_as) and the specific resource type (sku_name) on a daily basis.




Here's a breakdown of why:
- 

system.billing.usage: This is a system table that tracks billable usage in detail.
- 

usage_unit = 'DBU': This explicitly filters the records to only show consumption measured in Databricks Units (DBUs), the standard unit of consumption for compute.
- 

identity_metadata.run_as: This column logs the user or service principal (identity) who ran the workload. This is the per user component.
- 

sku_name: This column identifies the specific type of computing resource (e.g., ALL_PURPOSE_COMPUTE, JOBS_COMPUTE, SERVERLESS_SQL) that consumed the DBUs. This gives the type of computing resource detail.
- 

usage_quantity: This is the actual DBU consumption amount.
- 

usage_date: This provides the daily temporal detail.
