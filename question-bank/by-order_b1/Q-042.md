# Question 42

## Question
A finance analytics team manages a Delta Lake table in Unity Catalog called "transactions" with columns: id, amount, region, and account_manager. They want to apply row filtering on this table so that:



- 

Finance team members can see all transactions, while
- 

Other users can only see records from the US region.




Which of the following user-defined functions help achieve this?

## Options
- A. ```
- CREATE FUNCTION us_filter(region STRING)
- RETURN IF(IS_ACCOUNT_GROUP_MEMBER('finance_team'), true, region='US');
``` (Correct)
- B. ```
- CREATE FUNCTION us_filter(region STRING)
- RETURN CASE
- WHEN IS_ACCOUNT_GROUP_MEMBER('finance_team') THEN region='US'
- ELSE true END
``` 
- C. ```
- CREATE FUNCTION us_filter(region STRING)
- RETURN CASE
- WHEN IS_ACCOUNT_GROUP_MEMBER('finance_team') THEN true
- ELSE region END
``` 
- D. ```
- CREATE FUNCTION us_filter(region STRING)
- RETURN IF(IS_ACCOUNT_GROUP_MEMBER('finance_team'), region='US', true);
``` 

## Explanation
The correct user-defined function is:



```
- CREATE FUNCTION us_filter(region STRING)
- RETURN IF(IS_ACCOUNT_GROUP_MEMBER('finance_team'), true, region='US');
```





This function properly enforces the desired row-level security logic. It first checks whether the current user belongs to the finance_team group using `IS_ACCOUNT_GROUP_MEMBER('finance_team')`. If the user is a member, the function returns true, allowing them to see all transaction records without restriction. For all other users who are not part of the finance team, the function evaluates whether the region value equals 'US', thereby restricting their visibility to only U.S. transactions.
