# Question 12

## Question
A data engineer has the following streaming query with a blank:



```
- spark.readStream
-        .table("orders_cleaned")
-        ____________________________
-        .groupBy(
-            "order_timestamp",
-            "author")
-        .agg(
-            count("order_id").alias("orders_count"),
-            avg("quantity").alias("avg_quantity"))
-     .writeStream
-        .option("checkpointLocation", "dbfs:/path/checkpoint")
-        .table("orders_stats")
```





For handling late-arriving data, they want to maintain the streaming state information for 30 minutes. 




Which option correctly fills in the blank to meet this requirement ?

## Options
- A. .trigger(processingTime="30 minutes") 
- B. .withWatermark("order_timestamp", "30 minutes") (Correct)
- C. .awaitWatermark("order_timestamp", "30 minutes") 
- D. .window("order_timestamp", "30 minutes") 

## Explanation
pyspark.sql.DataFrame.withWatermark function allows you to only track state information for a window of time in which we expect records could be delayed.




Reference:

https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.sql.DataFrame.withWatermark.html




Study materials from our exam preparation course on Udemy:

Hands-on
