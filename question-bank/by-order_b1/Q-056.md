# Question 56

## Question
Which of the following approaches allows to correctly perform streaming deduplication?

## Options
- A. De-duplicate records in all batches with watermarking, and then overwrite the target table by the result 
- B. De-duplicate records within each batch, rank the result, and then insert only records having rank = 1 into the target table 
- C. De-duplicate records within each batch, and then merge the result into the target table using insert-only merge (Correct)
- D. De-duplicate records within each batch, and then append the result into the target table 

## Explanation
To perform streaming deduplication, we use dropDuplicates() function to eliminate duplicate records within each new micro batch. In addition, we need to ensure that records to be inserted are not already in the target table. We can achieve this using insert-only merge.

Reference:

https://spark.apache.org/docs/3.1.2/api/python/reference/api/pyspark.sql.DataFrame.dropDuplicates.html

https://docs.databricks.com/delta/merge.html#data-deduplication-when-writing-into-delta-tables




Study materials from our exam preparation course on Udemy:

Hands-on
