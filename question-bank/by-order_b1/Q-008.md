# Question 8

## Question
A data engineering team at a large cloud services company is responsible for ensuring high availability and performance of hundreds of servers. To proactively detect unusual spikes or drops in CPU utilization that could indicate potential issues, the team decides to analyze server CPU usage. They want to capture both the minimum and maximum CPU usage during predefined intervals for each server, allowing them to quickly identify patterns of high or low utilization and trigger alerts if necessary.




The team writes the following query:
```
- SELECT
-     server_id,
-     window.start AS window_start,
-     window.end AS window_end,
-     MIN(cpu_usage) AS min_cpu,
-     MAX(cpu_usage) AS max_cpu
- FROM server_metrics
- GROUP BY server_id,
-          window(event_time, '10 minutes', '10 minutes', '3 minutes')
- ORDER BY server_id,
-          window_start;
```


 

What is the primary purpose of this query in the context of the data engineering team's objectives?

## Options
- A. To calculate the metrics per server for every 10-minute interval, sliding every 3 minutes, with a 10-minute offset. 
- B. To calculate the metrics per server for every non-overlapping 10-minute interval, offset by 3 minutes (Correct)
- C. To calculate the metrics per server for every non-overlapping 3-minute interval, offset by 10 minutes 
- D. To calculate the metrics per server for every 3-minute interval, sliding every 10 minutes, with a 10-minute offset. 

## Explanation
The signature of the window function in Spark SQL is:

`window(time_column, window_size, slide_interval, starting_offset)`



- 

window_size: how long each window lasts.
- 

slide_interval (sometimes called step): how often a new window starts.
- 

starting_offset: shifts all windows forward or backward in time.




In this question, the function was:

`window(event_time, '10 minutes', '10 minutes', '3 minutes')`



- 

window_size = '10 minutes' → Each window spans 10 minutes.
- 

slide_interval = '10 minutes' → Windows slide every 10 minutes, i.e., non-overlapping.
- 

starting_offset= '3 minutes' → Windows start 3 minutes later than the natural alignment.




So, the query is computing 10-minute windows for each server, with a 3-minute offset, and aggregating MIN and MAX CPU usage in each window.
