# Question 7

## Question
A data engineer has the following query to join the large sales table (about 10 billion records) with a smaller customers table (about 5 million records):



```
- SELECT ______________
-     s.sale_id, s.amount, c.customer_name
- FROM sales AS s
- INNER JOIN customers AS c
- ON s.customer_id = c.customer_id;
```





The engineer wants to add a broadcast hint to instruct the query optimizer to perform a broadcast join on the customers table.




Which option correctly fills in the blank to achieve this?

## Options
- A. BROADCAST(c) 
- B. /*+ BROADCAST(c) */ (Correct)
- C. - - BROADCAST(c) -- 
- D. BROADCAST ON (c) 

## Explanation
In Spark SQL, to explicitly hint that a smaller table should be broadcast in a join, you use the `/*+ BROADCAST(table_alias) */` syntax before the SELECT keyword:



```
- SELECT /*+ BROADCAST(c) */
-     s.sale_id, s.amount, c.customer_name
- FROM sales AS s
- INNER JOIN customers AS c
- ON s.customer_id = c.customer_id;
```





This tells Spark to broadcast the customers table (small table) to all worker nodes, enabling a much faster join with the huge sales table.




Remember, broadcasting the smaller table sends it to all worker nodes so each partition of the large table can join locally, avoiding expensive shuffles across the cluster. This drastically reduces network I/O and speeds up the join when one table is much smaller than the other.
