# Question 45

## Question
A data engineering team is tasked with anonymizing sensitive customer data in their ETL pipeline. They need to generate a SHA-2 hash for a column holding customer credit card numbers. The team is aware that Spark's sha2 function supports certain bit lengths but not all arbitrary numbers.




Which of the following SHA-2 function calls would fail due to an invalid bit length?

## Options
- A. sha2(credit_card, 256) 
- B. sha2(credit_card, 128) (Correct)
- C. sha2(credit_card, 512) 
- D. sha2(credit_card, 0) 

## Explanation
In Apache Spark, the `sha2(expression, bitLength)` returns a checksum of the SHA-2 family as a hex string of an expression. It only supports specific SHA-2 bit lengths: 224, 256, 384, and 512. Any other bit length, such as 128, is invalid and would cause the function to fail. Notice that bitLength 0 is equivalent to 256.




So, `sha2(credit_card, 128)` would fail due to an unsupported bit length.
