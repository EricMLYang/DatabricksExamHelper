# Question 56

## Question
The data engineering team has a large Delta table named 'user_messages' with the following schema:




msg_id INT, user_id INT, msg_time TIMESTAMP, msg_title STRING, msg_body STRING




The msg_body field represents user messages in free-form text. The table has a performance issue when it's queried with filters on this field.




Which of the following could explain the reason for this performance issue ?

## Options
- A. The table does not leverage file skipping because it's not optimized with Z-ORDER on the msg_body column. 
- B. The table does not leverage file skipping because Delta Lake statistics are not captured on columns of type STRING 
- C. The table does not leverage file skipping because Delta Lake statistics are uninformative for string fields with very high cardinality (Correct)
- D. The table does not leverage file skipping because it's not partitioned on the msg_body column. 

## Explanation
Delta Lake automatically captures statistics in the transaction log for each added data file of the table. By default, Delta Lake collects the statistics on the first 32 columns of each table. However, statistics are generally uninformative for string fields with very high cardinality (such as free text fields).




Calculating statistics on free-form text fields (like user messages, product reviews, etc) can be time consuming. So, you need to omit these fields from statistics collection by setting them later in the schema after the first 32 columns.




Study materials from our exam preparation course on Udemy:

Lecture

Hands-on
