# Question 42

## Question
A data engineer in a call center needs to implement an SQL alert to track ticket volume and status changes. They want to set the alert based on multiple columns of the tickets table. The alert should be triggered when both of the following conditions are met:



- 

The number of new tickets exceeds 200.
- 

The number of tickets under processing exceeds 150.




Which of the following SQL queries correctly implements this alert logic?

## Options
- A. ```
SELECT new_tickets, under_processing
FROM (
  SELECT
    SUM(CASE WHEN status = 'new' THEN 1 ELSE 0 END) AS new_tickets,
    SUM(CASE WHEN status = 'in_progress' THEN 1 ELSE 0 END) AS under_processing
  FROM tickets
) statistics
WHERE new_tickets > 200
AND under_processing > 150
``` 
- B. ```
SELECT new_tickets + under_processing
FROM (
  SELECT
    SUM(CASE WHEN status = 'new' THEN 1 ELSE 0 END) AS new_tickets,
    SUM(CASE WHEN status = 'in_progress' THEN 1 ELSE 0 END) AS under_processing
  FROM tickets
) statistics
WHERE new_tickets + under_processing > 350
``` 
- C. ```
SELECT
  SUM(CASE WHEN status = 'new' THEN 1 ELSE 0 END) AS new_tickets,
  SUM(CASE WHEN status = 'in_progress' THEN 1 ELSE 0 END) AS under_processing
FROM tickets
WHERE new_tickets > 200
AND under_processing > 150
``` 
- D. ```
SELECT CASE
  WHEN new_tickets > 200 AND under_processing > 150 THEN 1
    ELSE 0
  END
FROM (
  SELECT
    SUM(CASE WHEN status = "new" THEN 1 ELSE 0 END) AS new_tickets,
    SUM(CASE WHEN status = "in_progress" THEN 1 ELSE 0 END) AS under_processing
  FROM tickets
) statistics
``` (Correct)

## Explanation
This query correctly calculates the sums of new and in-progress tickets in a subquery, and then uses a CASE statement to trigger the alert when both conditions are met (new_tickets > 200 AND under_processing > 150), which matches the intended alert logic.




Remember, alerts in Databricks can only evaluate a single field. That's why we use a CASE WHEN expression to combine multiple conditions into one alert field.
