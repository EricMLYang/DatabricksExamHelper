# Question 28

## Question
A data engineer at a global bank manages a Delta Lake table customer_accounts with columns:

customer_id, name, account_number, credit_card. They want to apply a mask on the credit_card column so that only analysts in the Fraud Detection Department can view the actual values. To achieve this, they implemented the following user-defined function:



```

- CREATE FUNCTION card_mask(credit_card STRING)
- RETURN CASE WHEN is_account_group_member('FraudDetectionDept') THEN credit_card
-         ELSE '****-****-****-****' END;
```





Which command can the data engineer use to apply this function as a column mask to the table?

## Options
- A. ALTER TABLE customer_accounts SET MASK card_mask ON (credit_card); 
- B. SET MASK card_mask ON TABLE customer_accounts TO COLUMN credit_card; 
- C. ALTER TABLE customer_accounts SET MASK card_mask; 
- D. ALTER TABLE customer_accounts ALTER COLUMN credit_card SET MASK card_mask; (Correct)

## Explanation
To ensure that only analysts in the Fraud Detection Department can view the actual credit card numbers while others see masked values, the data engineer should apply the masking function directly to the specific column in the Delta Lake table. The correct SQL command to achieve this is:




`ALTER TABLE customer_accounts ALTER COLUMN credit_card SET MASK card_mask;`




This command modifies the existing credit_card column by associating it with the card_mask function, which conditionally reveals or masks the credit card data based on the user's group membership.
