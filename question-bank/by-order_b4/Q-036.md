# Question 36

## Question
The data engineering team has a Delta Lake table named 'daily_activities' that is completely overwritten each night with new data received from the source system.




For auditing purposes, the team wants to set up a post-processing task that uses Delta Lake Time Travel functionality to determine the difference between the new version and the previous version of the table. They start by getting the current table version via this code:



```
current_version = spark.sql("SELECT max(version) FROM (DESCRIBE HISTORY daily_activities)").collect()[0][0]
```





Which of the following queries can be used by the team to complete this task ?

## Options
- A. ```
SELECT * FROM daily_activities
MINUS
SELECT * FROM daily_activities AS VERSION = {current_version-1}
``` 
- B. ```
SELECT * FROM daily_activities
UNION
SELECT * FROM daily_activities AS VERSION = {current_version-1}
``` 
- C. ```
SELECT * FROM daily_activities
INTERSECT
SELECT * FROM daily_activities AS VERSION = {current_version-1}
``` 
- D. ```
SELECT * FROM daily_activities
EXCEPT
SELECT * FROM daily_activities@v{current_version-1}
``` (Correct)

## Explanation
Each operation that modifies a Delta Lake table creates a new table version. You can use history information to audit operations or query a table at a specific point in time using:



- 

Version number
```
SELECT * FROM my_table@v36
SELECT * FROM my_table VERSION AS OF 36
```




- 

Timestamp
```
SELECT * FROM my_table TIMESTAMP AS OF "2019-01-01"
```





Using the EXCEPT set operator, you can get the difference between the new version and the previous version of the table




Study materials from our exam preparation course on Udemy:
- 

Hands-on
- 

Lecture (Associate course)
- 

Hands-on (Associate course)
