# Question #28

---

## 題目資訊

### 題目編號
**ID:** `Q-01-028`

### 來源
**來源:** Real Exam Recall

### 難度等級
**難度:** `L3-Advanced`

---

## 題目內容

### 題幹

A junior data engineer seeks to leverage Delta Lake's Change Data Feed functionality to create a Type 1 table representing all of the values that have ever been valid for all rows in a bronze table created with the property delta.enableChangeDataFeed = true.

They plan to execute the following code as a daily job:

```python
from pyspark.sql.functions import col
(spark.read.format("delta")
 .option("readChangeFeed", "true")
 .option("startingVersion", 0)
 .table("bronze")
 .filter(col("_change_type").isin(["update_postimage", "insert"]))
 .write
 .mode("append")
 .table("bronze_history_type1")
)
```

Which statement describes the execution and results of running the above query multiple times?

### 選項

- **A.** Each time the job is executed, newly updated records will be merged into the target table, overwriting previous values with the same primary keys.
- **B.** Each time the job is executed, the entire available history of inserted or updated records will be appended to the target table, resulting in many duplicate entries.
- **C.** Each time the job is executed, the target table will be overwritten using the entire history of inserted or updated records, giving the desired result.
- **D.** Each time the job is executed, the differences between the original and current versions are calculated; this may result in duplicate entries for some records.
- **E.** Each time the job is executed, only those records that have been inserted or updated since the last execution will be appended to the target table, giving the desired result.

---

## 標籤系統

### Topic Tags (技術主題標籤)
**Topics:** `Change-Data-Feed`, `Type-1-SCD`, `Delta-Lake`, `Incremental-Processing`

### Trap Tags (陷阱類型標籤)
**Traps:** `CDF-StartingVersion`, `Append-Behavior`

### Knowledge Domain (知識領域)
**Domain:** `Delta Lake`

---

## 答案與解析連結

### 正確答案
**正解:** `B`

### 解析檔案
**詳細解析:** [點此查看解析](../analysis/Q-01-028-analysis.md)

---

## 相關資源

### 官方文件
- [Change Data Feed](https://docs.databricks.com/delta/delta-change-data-feed.html)
- [Reading Change Data](https://docs.databricks.com/delta/delta-change-data-feed.html#read-changes-in-batch-queries)
