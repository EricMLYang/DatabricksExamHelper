# Question #13

---

## 題目資訊

### 題目編號
**ID:** `Q-01-013`

### 來源
**來源:** Real Exam Recall

### 難度等級
**難度:** `L3-Advanced`

---

## 題目內容

### 題幹

An upstream system is emitting change data capture (CDC) logs that are being written to a cloud object storage directory.

Each record in the log indicates the change type (insert, update, or delete) and the values for each field after the change.

The source table has a primary key identified by the field pk_id.

For auditing purposes, the data governance team wishes to maintain a full record of all values that have ever been valid in the source system.

For analytical purposes, only the most recent value for each record needs to be recorded.

The Databricks job to ingest these records occurs once per hour, but each individual record may have changed multiple times over the course of an hour.

Which solution meets these requirements?

### 選項

- **A.** Create a separate history table for each pk_id resolve the current state of the table by running a union all filtering the history tables for the most recent state.
- **B.** Use MERGE INTO to insert, update, or delete the most recent entry for each pk_id into a bronze table, then propagate all changes throughout the system.
- **C.** Iterate through an ordered set of changes to the table, applying each in turn; rely on Delta Lake's versioning ability to create an audit log.
- **D.** Use Delta Lake's change data feed to automatically process CDC data from an external system, propagating all changes to all dependent tables in the Lakehouse.
- **E.** Ingest all log information into a bronze table; use MERGE INTO to insert, update, or delete the most recent entry for each pk_id into a silver table to recreate the current table state.

---

## 標籤系統

### Topic Tags (技術主題標籤)
**Topics:** `CDC`, `MERGE`, `Medallion-Architecture`, `Data-Governance`

### Trap Tags (陷阱類型標籤)
**Traps:** `Architecture-Pattern`, `CDC-vs-CDF`

### Knowledge Domain (知識領域)
**Domain:** `Data Engineering`

---

## 答案與解析連結

### 正確答案
**正解:** `E`

### 解析檔案
**詳細解析:** [點此查看解析](../analysis/Q-01-013-analysis.md)

---

## 相關資源

### 官方文件
- [Change Data Capture](https://docs.databricks.com/structured-streaming/delta-lake.html#change-data-capture)
- [MERGE INTO](https://docs.databricks.com/sql/language-manual/delta-merge-into.html)
- [Medallion Architecture](https://docs.databricks.com/lakehouse/medallion.html)
