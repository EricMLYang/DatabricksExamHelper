# Question #120

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-120`

### ä¾†æº
**ä¾†æº:** Mock Exam / Community Contributed

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

The business reporting team requires that data for their dashboards be **updated every hour**. The total processing time for the pipeline that extracts, transforms, and loads the data runs in **10 minutes**.

Assuming normal operating conditions, which configuration will meet their service-level agreement requirements with the **lowest cost**?

### é¸é …

- **A.** Configure a job that executes **every time new data lands** in a given directory
- **B.** Schedule a job to execute the pipeline **once an hour** on a **new job cluster**
- **C.** Schedule a **Structured Streaming** job with a trigger interval of 60 minutes
- **D.** Schedule a job to execute the pipeline **once an hour** on a **dedicated interactive cluster**

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Job-Scheduling`, `Cost-Optimization`, `Cluster-Types`, `Job-Cluster-vs-Interactive`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Cluster-Cost-Comparison`, `Streaming-Misconception`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Cost Optimization

---

## ç­”æ¡ˆèˆ‡ä¾†æº

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** B
- **ç¤¾ç¾¤å…±è­˜:** B (83%)
- **é—œè¯é¡Œç›®:** èˆ‡ Question 62 å…§å®¹å¹¾ä¹ç›¸åŒ

### ç¤¾ç¾¤è¨è«–é‡é»
- **æˆæœ¬æ•ˆç›Š:** Job Cluster åªåœ¨ä½œæ¥­åŸ·è¡ŒæœŸé–“ï¼ˆ10 åˆ†é˜ï¼‰é‹è¡Œï¼Œå®Œæˆå¾Œçµ‚æ­¢ï¼Œåªæ”¯ä»˜ 10 åˆ†é˜è²»ç”¨
- **é¸é … C å•é¡Œ:** Streaming å¢é›†é€šå¸¸ 24/7 é‹è¡Œï¼Œå°è‡´é–’ç½®æ™‚é–“é•·ä¸”æˆæœ¬é«˜
- **é¸é … D å•é¡Œ:** Interactive Cluster è²»ç‡è¼ƒé«˜ï¼Œä¸é©åˆå›ºå®šæ’ç¨‹çš„ç”Ÿç”¢ä½œæ¥­

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Cluster Types & Cost Optimization  
**é—œéµæ¦‚å¿µ:** Job Cluster vs Interactive Clusterã€Batch vs Streaming æˆæœ¬

**éœ€æ±‚åˆ†æï¼š**
- æ›´æ–°é »ç‡ï¼šæ¯å°æ™‚ 1 æ¬¡
- åŸ·è¡Œæ™‚é–“ï¼š10 åˆ†é˜
- ç›®æ¨™ï¼š**æœ€ä½æˆæœ¬**

---

## âœ… æ­£è§£èªªæ˜

### B - Job Cluster æ¯å°æ™‚åŸ·è¡Œ

**æˆæœ¬è¨ˆç®—ï¼š**

```
Job Cluster æˆæœ¬æ¨¡å‹ï¼š
- é‹è¡Œæ™‚é–“ï¼š10 åˆ†é˜/æ¬¡
- åŸ·è¡Œé »ç‡ï¼š24 æ¬¡/å¤©
- ç¸½é‹è¡Œæ™‚é–“ï¼š240 åˆ†é˜/å¤© (4 å°æ™‚)
- é–’ç½®æ™‚é–“ï¼š0 åˆ†é˜ âœ…

æ¯æ—¥æˆæœ¬ = 4 å°æ™‚ Ã— DBU è²»ç‡
```

**ç‚ºä»€éº¼æœ€ä¾¿å®œï¼Ÿ**

| å„ªå‹¢ | èªªæ˜ |
|------|------|
| **æŒ‰éœ€å•Ÿå‹•** | åªåœ¨éœ€è¦æ™‚å•Ÿå‹• Cluster |
| **è‡ªå‹•çµ‚æ­¢** | ä½œæ¥­å®Œæˆå¾Œç«‹å³çµ‚æ­¢ |
| **ç„¡é–’ç½®æˆæœ¬** | ä¸é‹è¡Œ = ä¸æ”¶è²» |
| **ç¬¦åˆéœ€æ±‚** | æ¯å°æ™‚åŸ·è¡Œå®Œå…¨æ»¿è¶³ SLA |

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤ï¼ˆç²¾ç°¡ç‰ˆï¼‰

### A - è³‡æ–™åˆ°é”æ™‚è§¸ç™¼

**å•é¡Œï¼š**
- âŒ ä¸å¯é æ¸¬ï¼šè‹¥è³‡æ–™æ¯ 5 åˆ†é˜åˆ°é” â†’ åŸ·è¡Œæ¬¡æ•¸ Ã— 12
- âŒ æˆæœ¬æš´å¢ï¼šåŸ·è¡Œé »ç‡å¯èƒ½é è¶…éœ€æ±‚
- âŒ ä¸ç¬¦éœ€æ±‚ï¼šé¡Œç›®è¦æ±‚ã€Œæ¯å°æ™‚æ›´æ–°ã€ï¼Œéå³æ™‚

### C - Streaming (60 åˆ†é˜ trigger)

**å•é¡Œï¼š**
```
Streaming Cluster æˆæœ¬ï¼š
- é‹è¡Œæ™‚é–“ï¼š24/7 æŒçºŒé‹è¡Œ
- ç¸½é‹è¡Œæ™‚é–“ï¼š1440 åˆ†é˜/å¤© (24 å°æ™‚)
- å¯¦éš›åŸ·è¡Œï¼š240 åˆ†é˜/å¤© (10 åˆ†é˜ Ã— 24 æ¬¡)
- é–’ç½®æ™‚é–“ï¼š1200 åˆ†é˜/å¤© âŒ

æ¯æ—¥æˆæœ¬ = 24 å°æ™‚ Ã— DBU è²»ç‡
æˆæœ¬æ˜¯é¸é … B çš„ 6 å€ï¼
```

### D - Interactive Cluster æ¯å°æ™‚åŸ·è¡Œ

**å•é¡Œï¼š**
- âŒ **DBU è²»ç‡æ›´é«˜**ï¼ˆInteractive é€šå¸¸æ˜¯ Job Cluster çš„ 1.5-2 å€ï¼‰
- âŒ **éœ€æ‰‹å‹•ç®¡ç†**ï¼ˆè‡ªå‹•çµ‚æ­¢æ™‚é–“ã€é‡å•Ÿç­‰ï¼‰
- âŒ ç”¨æ–¼é–‹ç™¼ï¼Œéç”Ÿç”¢æ’ç¨‹

**æˆæœ¬å°æ¯”ï¼š**

| Cluster é¡å‹ | é‹è¡Œæ™‚é–“/å¤© | ç›¸å° DBU è²»ç‡ | ç›¸å°æˆæœ¬ |
|-------------|-----------|-------------|---------|
| **Job Cluster (B)** | 4 å°æ™‚ | 1.0x | **1x** âœ… |
| Interactive (D) | 4 å°æ™‚ | 1.5x | 1.5x |
| Streaming (C) | 24 å°æ™‚ | 1.0x | 6x |

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£
**ã€Œæ‰¹æ¬¡æ’ç¨‹ç”¨ Job Clusterï¼ŒçœéŒ¢çœå¿ƒæœ€ç¶“æ¿Ÿã€**

### Cluster é¸æ“‡æ±ºç­–æ¨¹

```
éœ€æ±‚æ˜¯ä»€éº¼ï¼Ÿ
â”‚
â”œâ”€ å›ºå®šæ™‚é–“æ’ç¨‹ï¼ˆæ¯å°æ™‚/æ¯å¤©ï¼‰
â”‚  â””â”€ âœ… Job Cluster (é¸é … B)
â”‚
â”œâ”€ äº’å‹•å¼é–‹ç™¼/æ¢ç´¢
â”‚  â””â”€ Interactive Cluster
â”‚
â”œâ”€ å³æ™‚ä¸²æµè™•ç†ï¼ˆç§’ç´šå»¶é²ï¼‰
â”‚  â””â”€ Streaming (ä½†æˆæœ¬é«˜)
â”‚
â””â”€ äº‹ä»¶é©…å‹•ï¼ˆä¸å¯é æ¸¬ï¼‰
   â””â”€ è©•ä¼°é »ç‡ï¼Œå¯èƒ½ä¸æ˜¯æœ€ä¾¿å®œ
```

### æˆæœ¬å„ªåŒ–åŸå‰‡

| åŸå‰‡ | èªªæ˜ |
|------|------|
| **æŒ‰éœ€å•Ÿå‹•** | Job Cluster åªåœ¨éœ€è¦æ™‚é‹è¡Œ |
| **é¿å…é–’ç½®** | Streaming 24/7 é‹è¡Œ = å¤§é‡é–’ç½® |
| **é¸å°é¡å‹** | Job Cluster < Interactive Cluster |

---

## ğŸ’¡ å¯¦å‹™è£œå……

### Job Cluster é…ç½®ç¯„ä¾‹

```python
# åœ¨ Databricks Jobs UI è¨­å®š
{
  "name": "Hourly Dashboard Update",
  "schedule": {
    "quartz_cron_expression": "0 0 * * * ?",  # æ¯å°æ™‚åŸ·è¡Œ
    "timezone_id": "America/Los_Angeles"
  },
  "tasks": [{
    "task_key": "etl_task",
    "new_cluster": {  # â† Job Cluster
      "spark_version": "13.3.x-scala2.12",
      "node_type_id": "i3.xlarge",
      "num_workers": 2,
      "autotermination_minutes": 0  # ä½œæ¥­å®Œæˆå¾Œç«‹å³çµ‚æ­¢
    },
    "notebook_task": {
      "notebook_path": "/pipelines/dashboard_etl"
    }
  }]
}
```

### éŒ¯èª¤åšæ³•å°æ¯”

```python
# âŒ éŒ¯èª¤ï¼šä½¿ç”¨ Interactive Cluster
{
  "existing_cluster_id": "interactive-cluster-123",  # è²»ç‡é«˜
  "schedule": "0 0 * * * ?"
}

# âŒ éŒ¯èª¤ï¼šStreaming æŒçºŒé‹è¡Œ
spark.readStream \
  .trigger(processingTime="60 minutes") \
  .start()
# Cluster éœ€ 24/7 é‹è¡Œ
```

---

## ğŸ“š åƒè€ƒæ–‡ä»¶

- [Databricks Docs - Job Clusters](https://docs.databricks.com/clusters/job-clusters.html)
- [Databricks Docs - Pricing](https://databricks.com/product/pricing)

---

## ğŸ¯ è€ƒè©¦æŠ€å·§

**çœ‹åˆ°ã€Œlowest costã€ç«‹å³æ€è€ƒï¼š**
1. âœ… **é‹è¡Œæ™‚é–“æœ€çŸ­** â†’ Job Cluster (æŒ‰éœ€å•Ÿå‹•)
2. âœ… **é¿å… 24/7 é‹è¡Œ** â†’ æ’é™¤ Streaming
3. âœ… **é¿å… Interactive** â†’ è²»ç‡è¼ƒé«˜

**æˆæœ¬æ’åºï¼ˆåŒé‹è¡Œæ™‚é–“ï¼‰ï¼š**
```
Job Cluster < Interactive Cluster < Dedicated Streaming
```

**é—œéµå­—åˆ¤æ–·ï¼š**
- ã€Œ**hourly/daily schedule**ã€â†’ Job Cluster
- ã€Œ**lowest cost**ã€â†’ é¿å…æŒçºŒé‹è¡Œ
- ã€Œ**10 minutes processing**ã€â†’ ä¸éœ€è¦ 24/7 Cluster
