# Question #005

---

## é¡Œç›®è³‡è¨Š
### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-005`
### ä¾†æº
**ä¾†æº:** Community
### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L1-Basic`

---

## é¡Œç›®å…§å®¹
### é¡Œå¹¹
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
As a general rule, before scheduling notebooks in production, which of the following commands should be removed from the code?

### é¸é …
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
- **A.** Markup language commands
- **B.** Display commands
- **C.** Import commands
- **D.** Magic commands

---

## æ¨™ç±¤ç³»çµ±
### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Databricks-Workflows`, `ETL-Patterns`
### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Concept-Confusion`
### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Best Practices

---

## ç­”æ¡ˆèˆ‡ä¾†æº
### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`
### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** B
- **ç¤¾ç¾¤å…±è­˜:** B

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥
**æ ¸å¿ƒæŠ€è¡“:** Production Notebook Best Practices
**é—œéµæ¦‚å¿µ:** ç”Ÿç”¢ç’°å¢ƒæº–å‚™ã€æ•ˆèƒ½å„ªåŒ–ã€é™¤éŒ¯æŒ‡ä»¤æ¸…ç†
**é¡Œç›®é—œéµå­—ï¼š**
- **scheduling notebooks in production**: ç”Ÿç”¢ç’°å¢ƒæ’ç¨‹
- **should be removed**: éœ€è¦ç§»é™¤çš„æŒ‡ä»¤
- **Display commands**: é¡¯ç¤ºæŒ‡ä»¤

---

## âœ… æ­£è§£èªªæ˜
### ç‚ºä»€éº¼ B æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**Display commands** æ˜¯é–‹ç™¼å’Œé™¤éŒ¯ç”¨çš„ï¼Œåœ¨ç”Ÿç”¢ç’°å¢ƒä¸­æ‡‰è©²ç§»é™¤ã€‚

#### ç‚ºä»€éº¼è¦ç§»é™¤ Display Commandsï¼Ÿ
| å•é¡Œ | èªªæ˜ |
|------|------|
| **æ•ˆèƒ½å½±éŸ¿** | display() æœƒè§¸ç™¼ actionï¼Œæ¶ˆè€—è¨ˆç®—è³‡æº |
| **ç„¡æ„ç¾©è¼¸å‡º** | æ’ç¨‹åŸ·è¡Œæ™‚æ²’æœ‰äººçœ‹è¼¸å‡º |
| **è¨˜æ†¶é«”æµªè²»** | ç”¢ç”Ÿä¸å¿…è¦çš„çµæœé›† |
| **æ—¥èªŒé›œäº‚** | æ±¡æŸ“åŸ·è¡Œæ—¥èªŒ |

#### å¸¸è¦‹çš„ Display Commands
```python
# é€™äº›æŒ‡ä»¤æ‡‰è©²åœ¨ç”Ÿç”¢ç’°å¢ƒç§»é™¤æˆ–è¨»è§£ï¼š

display(df)              # Databricks display
df.show()                # Spark show
print(df.count())        # é™¤éŒ¯ç”¨çš„ print
df.describe().show()     # çµ±è¨ˆæ‘˜è¦é¡¯ç¤º

# SQL ä¸­çš„é™¤éŒ¯æŸ¥è©¢
SELECT * FROM table LIMIT 10  # ç´”ç²¹ç‚ºäº†æŸ¥çœ‹è³‡æ–™
```

#### ç”Ÿç”¢ç’°å¢ƒæº–å‚™æ¸…å–®
```
ä¸Šç·šå‰æª¢æŸ¥ï¼š
â”œâ”€â”€ ç§»é™¤/è¨»è§£ display() æŒ‡ä»¤
â”œâ”€â”€ ç§»é™¤/è¨»è§£ show() æŒ‡ä»¤
â”œâ”€â”€ ç§»é™¤/è¨»è§£é™¤éŒ¯ç”¨çš„ print()
â”œâ”€â”€ ç§»é™¤/è¨»è§£æ¸¬è©¦ç”¨çš„ DROP TABLE
â”œâ”€â”€ ç¢ºèª checkpoint è·¯å¾‘æ­£ç¢º
â””â”€â”€ ç¢ºèªç›®æ¨™è¡¨æ ¼åç¨±æ­£ç¢º
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A. Markup language commands
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Markdown æ¨™è¨˜åªæ˜¯**æ–‡ä»¶èªªæ˜**
- ä¸æœƒå½±éŸ¿ç¨‹å¼åŸ·è¡Œ
- ä¿ç•™æœ‰åŠ©æ–¼ç¶­è­·å’Œç†è§£ç¨‹å¼ç¢¼

```python
# %md
# ## é€™æ˜¯èªªæ˜æ–‡å­—
# é€™ä¸å½±éŸ¿åŸ·è¡Œï¼Œå¯ä»¥ä¿ç•™
```

### C. Import commands
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- **Import æ˜¯å¿…è¦çš„**
- æ²’æœ‰ importï¼Œç¨‹å¼ç„¡æ³•åŸ·è¡Œ
- çµ•å°ä¸èƒ½ç§»é™¤

```python
from pyspark.sql.functions import col, sum  # å¿…é ˆä¿ç•™ï¼
```

### D. Magic commands
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Magic commands æœ‰äº›æ˜¯**åŠŸèƒ½æ€§çš„**
- ä¾‹å¦‚ `%python`, `%sql` æ˜¯åˆ‡æ›èªè¨€å¿…é ˆçš„
- ä¾‹å¦‚ `%run` æ˜¯åŸ·è¡Œå…¶ä»– notebook å¿…é ˆçš„

```python
%run ./setup_notebook    # å¯èƒ½æ˜¯å¿…è¦çš„
%sql SELECT ...          # èªè¨€åˆ‡æ›ï¼ŒåŠŸèƒ½æ€§çš„
```

---

## ğŸ§  è¨˜æ†¶æ³•
### å£è¨£
**ã€Œç”Ÿç”¢ä¸Šç·šå‰ï¼Œdisplay è¦è¨»è§£ã€**

### é–‹ç™¼ vs ç”Ÿç”¢çš„æŒ‡ä»¤
| æŒ‡ä»¤é¡å‹ | é–‹ç™¼ç’°å¢ƒ | ç”Ÿç”¢ç’°å¢ƒ |
|----------|----------|----------|
| `display()` | âœ… ç”¨æ–¼æª¢è¦– | âŒ ç§»é™¤ |
| `show()` | âœ… ç”¨æ–¼é™¤éŒ¯ | âŒ ç§»é™¤ |
| `print()` | âœ… ç”¨æ–¼é™¤éŒ¯ | âŒ ç§»é™¤ï¼ˆé™¤éå¿…è¦ï¼‰ |
| `import` | âœ… | âœ… å¿…é ˆä¿ç•™ |
| `%md` | âœ… | âœ… å¯ä¿ç•™ |

### ç”Ÿç”¢ç’°å¢ƒæª¢æŸ¥æ¸…å–®
```
âœ… ä¿ç•™ï¼š
â”œâ”€â”€ import èªå¥
â”œâ”€â”€ æ¥­å‹™é‚è¼¯ç¨‹å¼ç¢¼
â”œâ”€â”€ å¿…è¦çš„ magic commands
â”œâ”€â”€ æ–‡ä»¶èªªæ˜ï¼ˆmarkdownï¼‰
â””â”€â”€ éŒ¯èª¤è™•ç†ç¨‹å¼ç¢¼

âŒ ç§»é™¤/è¨»è§£ï¼š
â”œâ”€â”€ display() / show()
â”œâ”€â”€ é™¤éŒ¯ç”¨çš„ print()
â”œâ”€â”€ æ¸¬è©¦ç”¨çš„ DROP / DELETE
â”œâ”€â”€ ç¡¬ç·¨ç¢¼çš„æ¸¬è©¦è³‡æ–™
â””â”€â”€ é–‹ç™¼ç”¨çš„æš«æ™‚æª”æ¡ˆè·¯å¾‘
```

### ç‚ºä»€éº¼ display() ç‰¹åˆ¥é‡è¦ï¼Ÿ
```
display() çš„å•é¡Œï¼š
â”œâ”€â”€ åœ¨èƒŒæ™¯åŸ·è¡Œæ™‚æ²’æœ‰ UI é¡¯ç¤ºçµæœ
â”œâ”€â”€ ä½†ä»æœƒåŸ·è¡Œ action æ¶ˆè€—è³‡æº
â”œâ”€â”€ å¦‚æœè³‡æ–™é‡å¤§ï¼Œæœƒæµªè²»å¤§é‡æ™‚é–“
â””â”€â”€ ä¾‹å¦‚ï¼šdisplay(spark.table("huge_table")) æœƒè®€å–æ•´å€‹è¡¨

æœ€ä½³å¯¦è¸ï¼š
â”œâ”€â”€ é–‹ç™¼æ™‚ä½¿ç”¨ display(df.limit(10))
â”œâ”€â”€ ç”Ÿç”¢å‰è¨»è§£æˆ–åˆªé™¤
â””â”€â”€ æˆ–ä½¿ç”¨ if DEBUG: display(df)
```

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶
- [Databricks Notebook Best Practices](https://docs.databricks.com/notebooks/best-practices.html)
- [Production Job Recommendations](https://docs.databricks.com/workflows/jobs/jobs-best-practices.html)

---

**[è¿”å›é¡Œç›®](#question-005)**
