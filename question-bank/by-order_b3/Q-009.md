# Question 9

## Question
A data engineer at a healthcare organization manages a Delta Lake table patient_records with columns: patient_id, name, department, and diagnosis. They want to create a user-defined function that masks the diagnosis column so that only doctors can view values in that column.




Which of the following functions can the data engineer use to achieve this?

## Options
- A. ```

- CREATE FUNCTION patient_mask(diagnosis STRING)
- RETURN CASE WHEN is_account_group_member('doctors') THEN 'CONFIDENTIAL' ELSE diagnosis END;
``` 
- B. ```

- CREATE FUNCTION patient_mask(doctors STRING)
- RETURN CASE WHEN is_account_group_member('diagnosis') THEN doctors ELSE 'CONFIDENTIAL' END;
``` 
- C. ```

- CREATE FUNCTION patient_mask(diagnosis STRING)
- RETURN CASE WHEN is_account_group_member('doctors') THEN diagnosis ELSE 'CONFIDENTIAL' END;
``` (Correct)
- D. ```

- CREATE FUNCTION patient_mask(diagnosis STRING)
- RETURN CASE WHEN diagnosis IS NOT NULL THEN diagnosis ELSE 'CONFIDENTIAL' END;
``` 

## Explanation
The correct answer is:



```

- CREATE FUNCTION patient_mask(diagnosis STRING)
- RETURN CASE WHEN is_account_group_member('doctors') THEN diagnosis ELSE 'CONFIDENTIAL' END;
```





This fucntion properly implements role-based access control by verifying if the current user belongs to the "doctors" group using the is_account_group_member('doctors') function. If the user is a doctor, the function reveals the actual diagnosis value; otherwise, it replaces the diagnosis with the string "CONFIDENTIAL" to protect sensitive patient information.




This approach ensures compliance with healthcare data privacy requirements while allowing authorized medical staff to access the necessary information.
