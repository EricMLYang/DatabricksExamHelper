# Question 34

## Question
A data engineer needs to programmatically extract the data quality results of a LDP pipeline from the associated event log table.




Which of the following code snippets can the data engineer use to achieve this task?

## Options
- A. ```

- SELECT data_quality
- FROM catalog.schema.event_log
- WHERE event_type = 'metrics'
``` 
- B. ```

- SELECT expectations
- FROM catalog.schema.event_log
- WHERE event_type = 'flow_progress'
``` 
- C. ```

- SELECT details:flow_progress.data_quality.expectations
- FROM catalog.schema.event_log
- WHERE event_type = 'flow_progress'
``` (Correct)
- D. ```

- SELECT expectations
- FROM catalog.schema.event_log
- WHERE event_type = 'metrics'
``` 

## Explanation
In the event log table for LDP* pipelines, the data quality results are logged under events of type 'flow_progress' and stored inside the details column in a nested JSON structure:



- 

details:flow_progress: contains information about a pipeline's execution progress
- 

details:flow_progress.data_quality: contains the data quality results (expectations, dropped_records, etc.)
- 

details:flow_progress:data_quality.expectations: specifically holds the expectation results


* Databricks has recenlty open-sourced this solution, integrating it into the Apache Spark ecosystem under the name Spark Declarative Pipelines (SDP).
