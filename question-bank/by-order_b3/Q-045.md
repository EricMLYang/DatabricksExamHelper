# Question 45

## Question
A data engineer is analyzing a dataset of clickstream events from a high-traffic website. The dataset includes fields such as user_id, timestamp, event_type, and page_url. During a join operation between the clickstream logs and a user profile dataset (joined on user_id), the job's performance is significantly hindered due to uneven data distribution. Further analysis confirms a data skew caused by a small subset of users generating a disproportionately large number of events.




Which of the following approaches is NOT an appropriate solution to mitigate the skew in this scenario?

## Options
- A. Use salting by appending a random prefix to skewed user_id values to distribute the load across partitions. 
- B. Broadcast the skewed keys to all worker nodes to avoid shuffle during the join. (Correct)
- C. Separate processing of skewed keys by handling high-frequency users in a dedicated job. 
- D. Repartition the clickstream dataset on user_id to increase the number of partitions before the join. 

## Explanation
Broadcasting is typically used to share small lookup datasets with all executors to avoid joins that cause shuffles. However, broadcasting skewed keys, especially if the associated data is large, does not solve the skew problem and may actually increase memory pressure on each executor.




Other options are appropriate solutions:

- Use salting by appending a random prefix to skewed user_id values to distribute the load across partitions.
Salting is an effective technique to mitigate skew by artificially spreading out hot keys across multiple partitions. This approach reduces bottlenecks caused by skewed keys during shuffles.

- Repartition the clickstream dataset to increase the number of partitions before the join.
Increasing the number of partitions via repartition() helps balance the data load and enhances parallelism. It can help mitigate skew by distributing keys more evenly.




- Separate processing of skewed keys by handling high-frequency users in a dedicated job.

Isolating skewed keys for specialized processing prevents them from affecting the entire join operation. This targeted approach can improve performance by tailoring resources to problematic keys.
