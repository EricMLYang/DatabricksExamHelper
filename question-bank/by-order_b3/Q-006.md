# Question #006

---

## é¡Œç›®è³‡è¨Š
### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-006`
### ä¾†æº
**ä¾†æº:** Community
### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹
### é¡Œå¹¹
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
During the setup of Delta Sharing with an external partner, a data engineer asks the partner for their sharing identifier.

Which of the following best describes the sharing identifier within the context of Databricks-to-Databricks Sharing?

### é¸é …
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
- **A.** It acts as the authentication token for API calls with the recipient's endpoint
- **B.** It provides a unique reference for the recipient's Unity Catalog metastore
- **C.** It serves as a public encryption key used during data writes to the partner's tables
- **D.** It identify the partner's network IP address for firewall whitelisting

---

## æ¨™ç±¤ç³»çµ±
### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `UC-Sharing`, `Unity-Catalog`, `Security`
### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Concept-Confusion`
### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Data Architecture

---

## ç­”æ¡ˆèˆ‡ä¾†æº
### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`
### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** B
- **ç¤¾ç¾¤å…±è­˜:** B

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥
**æ ¸å¿ƒæŠ€è¡“:** Delta Sharing / Sharing Identifier
**é—œéµæ¦‚å¿µ:** Databricks-to-Databricks Sharingã€Metastore è­˜åˆ¥
**é¡Œç›®é—œéµå­—ï¼š**
- **sharing identifier**: å…±äº«è­˜åˆ¥ç¢¼
- **Databricks-to-Databricks**: D2D å…±äº«
- **Unity Catalog metastore**: Metastore è­˜åˆ¥

---

## âœ… æ­£è§£èªªæ˜
### ç‚ºä»€éº¼ B æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**Sharing Identifier** æ˜¯ç”¨ä¾†å”¯ä¸€è­˜åˆ¥ Recipient çš„ **Unity Catalog Metastore** çš„å­—ä¸²ã€‚

#### Sharing Identifier æ ¼å¼
```
æ ¼å¼ï¼š<cloud>:<region>:<uuid>

ç¯„ä¾‹ï¼šaws:us-west-2:19a84bee-54bc-43a2-87de-023d0ec16016
      â”‚   â”‚         â”‚
      â”‚   â”‚         â””â”€â”€ Metastore UUID
      â”‚   â””â”€â”€ é›²ç«¯å€åŸŸ
      â””â”€â”€ é›²ç«¯ä¾›æ‡‰å•†
```

#### å„éƒ¨åˆ†èªªæ˜
| çµ„æˆéƒ¨åˆ† | èªªæ˜ | ç¯„ä¾‹ |
|----------|------|------|
| **cloud** | é›²ç«¯ä¾›æ‡‰å•† | aws, azure, gcp |
| **region** | å€åŸŸ | us-west-2, eastus |
| **uuid** | Metastore å”¯ä¸€è­˜åˆ¥ç¢¼ | UUID æ ¼å¼ |

#### Sharing Identifier çš„ç”¨é€”
```
Sharing æµç¨‹ï¼š
1. Recipient å–å¾—è‡ªå·±çš„ Sharing Identifier
   â””â”€â”€ SELECT CURRENT_METASTORE();

2. Recipient å°‡ Identifier æä¾›çµ¦ Provider

3. Provider ä½¿ç”¨ Identifier å»ºç«‹ Recipient
   â””â”€â”€ CREATE RECIPIENT recipient_name
       USING ID '<sharing-identifier>';

4. Provider æˆæ¬Š Share çµ¦ Recipient
   â””â”€â”€ GRANT SELECT ON SHARE my_share TO RECIPIENT recipient_name;
```

#### å–å¾— Sharing Identifier çš„æ–¹å¼
```sql
-- æ–¹æ³• 1ï¼šSQL æŸ¥è©¢
SELECT CURRENT_METASTORE();

-- æ–¹æ³• 2ï¼šCatalog Explorer UI
-- Workspace Settings â†’ Metastore â†’ Sharing Identifier
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A. It acts as the authentication token for API calls
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Sharing Identifier **ä¸æ˜¯èªè­‰ token**
- èªè­‰æ˜¯é€é Databricks çš„èº«ä»½é©—è­‰æ©Ÿåˆ¶
- Identifier åªæ˜¯è­˜åˆ¥ Metastoreï¼Œä¸ç”¨æ–¼ API èªè­‰

### C. It serves as a public encryption key
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Sharing Identifier **ä¸æ˜¯åŠ å¯†é‡‘é‘°**
- åŠ å¯†æ˜¯åœ¨å‚³è¼¸å±¤è™•ç†ï¼ˆTLSï¼‰
- Identifier åªæ˜¯è­˜åˆ¥ç¢¼ï¼Œä¸åƒèˆ‡åŠ å¯†

### D. It identify the partner's network IP address
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Sharing Identifier **ä¸æ˜¯ IP ä½å€**
- ä¸ç”¨æ–¼é˜²ç«ç‰†ç™½åå–®
- æ˜¯ Metastore çš„é‚è¼¯è­˜åˆ¥ç¢¼ï¼Œä¸æ˜¯ç¶²è·¯ä½å€

---

## ğŸ§  è¨˜æ†¶æ³•
### å£è¨£
**ã€ŒSharing ID æ‰¾ Metastoreï¼Œcloud:region:uuid ä¸‰éƒ¨æ›²ã€**

### Sharing Identifier çµ„æˆ
```
Sharing Identifier = cloud + region + uuid
                   = èª° + å“ªè£¡ + å“ªå€‹ Metastore
```

### Delta Sharing æ¦‚å¿µæ¯”è¼ƒ
| æ¦‚å¿µ | ç”¨é€” | ç¯„ä¾‹ |
|------|------|------|
| **Sharing Identifier** | è­˜åˆ¥ Recipient çš„ Metastore | aws:us-west-2:uuid |
| **Share** | è¦åˆ†äº«çš„è³‡æ–™é›†åˆ | CREATE SHARE my_share |
| **Recipient** | æ¥æ”¶è³‡æ–™çš„å°è±¡ | CREATE RECIPIENT partner |
| **Provider** | åˆ†äº«è³‡æ–™çš„ä¸€æ–¹ | - |

### Sharing è¨­å®šæµç¨‹
```
Provider ç«¯ï¼š
1. CREATE SHARE my_share;
2. ALTER SHARE my_share ADD TABLE ...;
3. CREATE RECIPIENT partner USING ID '<sharing-id>';
4. GRANT SELECT ON SHARE my_share TO RECIPIENT partner;

Recipient ç«¯ï¼š
1. å–å¾— Sharing Identifier (SELECT CURRENT_METASTORE())
2. æä¾›çµ¦ Provider
3. CREATE CATALOG shared_data USING SHARE provider.my_share;
```

### å¸¸è¦‹éŒ¯èª¤ç†è§£
```
âŒ éŒ¯èª¤ç†è§£ï¼š
â”œâ”€â”€ Sharing ID æ˜¯èªè­‰ token â†’ ä¸æ˜¯ï¼Œåªæ˜¯è­˜åˆ¥ç¢¼
â”œâ”€â”€ Sharing ID æ˜¯åŠ å¯†é‡‘é‘° â†’ ä¸æ˜¯ï¼Œä¸åƒèˆ‡åŠ å¯†
â”œâ”€â”€ Sharing ID æ˜¯ IP ä½å€ â†’ ä¸æ˜¯ï¼Œæ˜¯é‚è¼¯è­˜åˆ¥ç¢¼
â””â”€â”€ Sharing ID æœƒéæœŸ â†’ ä¸æœƒï¼Œæ˜¯ Metastore çš„æ°¸ä¹…è­˜åˆ¥ç¢¼
```

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶
- [Delta Sharing Identifier](https://docs.databricks.com/data-sharing/share-data-databricks.html#get-the-sharing-identifier)
- [Databricks-to-Databricks Sharing](https://docs.databricks.com/data-sharing/share-data-databricks.html)
- [Create a Recipient](https://docs.databricks.com/data-sharing/create-recipient.html)

---

**[è¿”å›é¡Œç›®](#question-006)**
