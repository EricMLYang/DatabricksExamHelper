# Question 48

## Question
A data engineer has been asked to develop a nightly batch job for workforce productivity analytics. The job will process events of employees productivity of the previous day, and store the performance of each employee in the Delta table "employees_performance". The table has the following schema:




"date DATE, employee_id STRING, rating DOUBLE"




The data engineering team wants data to be stored in the table with the ability to compare employees' performance across time.




Which of the following code blocks accomplishes this task ?

## Options
- A. performance_df.write.mode("append").saveAsTable("employees_performance") (Correct)
- B. performance_df.write.mode("overwrite").saveAsTable("employees_performance") 
- C. performance_df.write.partitionBy("date").saveAsTable("employees_performance") 
- D. performance_df.write.format("delta").saveAsTable("employees_performance") 

## Explanation
DataFrameWriter.mode defines the writing behaviour when data or table already exists.

Options include:
- 

`append`: Append contents of the DataFrame to existing data.
- 

`overwrite`: Overwrite existing data.
- 

`error` or `errorifexists`: Throw an exception if data already exists.
- 

`ignore`: Silently ignore this operation if data already exists.




This `errorifexists` or `error` is the default save mode. If the table already exists, it will throw the error message Error: pyspark.sql.utils.AnalysisException: table already exists.




The "employees_performance" table has a date column. So, in order to be able to compare employees' performance across time, each new batch of data with new date should be appended into the table using the `append` mode.
