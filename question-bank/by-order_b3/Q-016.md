# Question 16

## Question
The data engineering team has a Silver table called 'sales_cleaned' where new sales data is appended in near real-time.




They want to create a new Gold-layer entity against the 'sales_cleaned' table to calculate the year-to-date (YTD) of the sales amount. The new entity will have the following schema:




country_code STRING, category STRING, ytd_total_sales FLOAT, updated TIMESTAMP




It's enough for these metrics to be recalculated once daily. But since they will be queried very frequently by several business teams, the data engineering team wants to cut down the potential costs and latency associated with materializing the results.




Which of the following solutions meets these requirements?

## Options
- A. Define the new entity as a view to avoid persisting the results each time the metrics are recalculated 
- B. Create multiple tables, one per business team so the metrics can be queried quickly and efficiently. 
- C. Configuring a nightly batch job to recalculate the metrics and store them as a table overwritten with each update. (Correct)
- D. Define the new entity as a global temporary view since it can be shared between notebooks or jobs that share computing resources. 

## Explanation
Data engineers must understand how materializing results is different between views and tables on Databricks, and how to reduce total compute and storage cost associated with each materialization depending on the scenario.




Consider using a view when:
- 

Your query is not complex. Because views are computed on demand, the view is re-computed every time the view is queried. So, frequently querying complex queries with joins and subqueries increases compute costs
- 

You want to reduce storage costs. Views do not require additional storage resources.

Consider using a gold table when:
- 

Multiple downstream queries consume the table, so you want to avoid re-computing complex ad-hoc queries every time.
- 

Query results should be computed incrementally from a data source that is continuously or incrementally growing.




Study materials from our exam preparation course on Udemy:

Hands-on
