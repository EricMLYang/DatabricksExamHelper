# Question #003

---

## é¡Œç›®è³‡è¨Š
### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-003`
### ä¾†æº
**ä¾†æº:** Community
### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹
### é¡Œå¹¹
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
A data scientist from the marketing department requires read-only access to the 'customer_insights' table located in the analytics schema, which is part of the BI catalog. The data will be used to generate quarterly customer engagement reports. In accordance with the principle of least privilege, only the minimum permissions necessary to perform the required tasks should be granted.

Which SQL commands will correctly grant access with the least privileges?

### é¸é …
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
- **A.**
```sql
GRANT SELECT ON TABLE bi.analytics.insights TO marketing_team;
GRANT USE SCHEMA ON SCHEMA bi.analytics TO marketing_team;
```
- **B.**
```sql
GRANT SELECT ON TABLE bi.analytics.insights TO marketing_team;
GRANT USE SCHEMA ON SCHEMA bi.analytics TO marketing_team;
GRANT USE CATALOG ON CATALOG bi TO marketing_team;
```
- **C.**
```sql
GRANT SELECT ON TABLE bi.analytics.insights TO marketing_team;
```
- **D.**
```sql
GRANT SELECT ON TABLE bi.analytics.insights TO marketing_team;
GRANT USE CATALOG ON CATALOG bi TO marketing_team;
```

---

## æ¨™ç±¤ç³»çµ±
### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `UC-Permissions`, `Unity-Catalog`, `Access-Control`
### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Scope-Misunderstanding`
### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Security & Governance

---

## ç­”æ¡ˆèˆ‡ä¾†æº
### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`
### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** B
- **ç¤¾ç¾¤å…±è­˜:** B

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥
**æ ¸å¿ƒæŠ€è¡“:** Unity Catalog æ¬Šé™æ¨¡å‹
**é—œéµæ¦‚å¿µ:** ä¸‰å±¤æ¶æ§‹æ¬Šé™ã€æœ€å°æ¬Šé™åŸå‰‡ã€USE CATALOG/SCHEMA
**é¡Œç›®é—œéµå­—ï¼š**
- **least privilege**: æœ€å°æ¬Šé™åŸå‰‡
- **read-only access**: åªéœ€è¦ SELECT
- **three-level namespace**: Catalog.Schema.Table

---

## âœ… æ­£è§£èªªæ˜
### ç‚ºä»€éº¼ B æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

åœ¨ Unity Catalog ä¸­ï¼Œè¦å­˜å–ä¸€å€‹è¡¨æ ¼ï¼Œéœ€è¦**ä¸‰å±¤æ¬Šé™**ï¼š
1. `USE CATALOG` on Catalog
2. `USE SCHEMA` on Schema
3. `SELECT` on Table

#### Unity Catalog æ¬Šé™éšå±¤
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Unity Catalog               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Catalog: bi                â”‚  â”‚
â”‚  â”‚  â† GRANT USE CATALOG ON CATALOG bi â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚    Schema: analytics         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ â† GRANT USE SCHEMA ON SCHEMA â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Table: insights       â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â† GRANT SELECT ON TABLEâ”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ¬Šé™çµ„åˆçš„å¿…è¦æ€§
| ç¼ºå°‘çš„æ¬Šé™ | çµæœ |
|------------|------|
| ç¼ºå°‘ USE CATALOG | ç„¡æ³•çœ‹åˆ° Catalog ä¸‹çš„ Schema |
| ç¼ºå°‘ USE SCHEMA | ç„¡æ³•çœ‹åˆ° Schema ä¸‹çš„ Table |
| ç¼ºå°‘ SELECT | ç„¡æ³•è®€å– Table è³‡æ–™ |

#### æ­£ç¢ºçš„æ¬Šé™æˆäºˆé †åº
```sql
-- 1. å…è¨±ä½¿ç”¨ Catalog
GRANT USE CATALOG ON CATALOG bi TO marketing_team;

-- 2. å…è¨±ä½¿ç”¨ Schema
GRANT USE SCHEMA ON SCHEMA bi.analytics TO marketing_team;

-- 3. å…è¨±è®€å– Table
GRANT SELECT ON TABLE bi.analytics.insights TO marketing_team;
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A. ç¼ºå°‘ USE CATALOG
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- æ²’æœ‰ `USE CATALOG` æ¬Šé™ï¼Œä½¿ç”¨è€…ç„¡æ³•é€²å…¥ `bi` Catalog
- å³ä½¿æœ‰ Schema å’Œ Table æ¬Šé™ï¼Œä¹Ÿç„¡æ³•å­˜å–

### C. åªæœ‰ SELECT
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- åªæˆäºˆ SELECT æ¬Šé™æ˜¯ä¸å¤ çš„
- ä½¿ç”¨è€…éœ€è¦ USE CATALOG å’Œ USE SCHEMA æ‰èƒ½ã€Œçœ‹åˆ°ã€é€™å€‹è¡¨æ ¼
- æ¬Šé™ä¸æœƒè‡ªå‹•ç¹¼æ‰¿

### D. ç¼ºå°‘ USE SCHEMA
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- æ²’æœ‰ `USE SCHEMA` æ¬Šé™ï¼Œä½¿ç”¨è€…ç„¡æ³•é€²å…¥ `analytics` Schema
- å³ä½¿å¯ä»¥ä½¿ç”¨ Catalog å’Œæœ‰ Table SELECT æ¬Šé™ï¼Œä¹Ÿç„¡æ³•å­˜å–

---

## ğŸ§  è¨˜æ†¶æ³•
### å£è¨£
**ã€ŒCatalog â†’ Schema â†’ Tableï¼Œä¸‰å±¤éƒ½è¦æœ‰ã€**

### æœ€å°æ¬Šé™åŸå‰‡
```
å­˜å–è¡¨æ ¼çš„æœ€å°æ¬Šé™ï¼š
â”œâ”€â”€ USE CATALOG on Catalog â† é€²å…¥ Catalog
â”œâ”€â”€ USE SCHEMA on Schema   â† é€²å…¥ Schema
â””â”€â”€ SELECT on Table        â† è®€å–è³‡æ–™

æ³¨æ„ï¼š
â”œâ”€â”€ ä¸éœ€è¦ ALL PRIVILEGES
â”œâ”€â”€ ä¸éœ€è¦ MODIFY
â””â”€â”€ ä¸éœ€è¦ CREATE
```

### USE vs SELECT çš„å€åˆ¥
| æ¬Šé™ | ç”¨é€” |
|------|------|
| `USE CATALOG` | å…è¨±çœ‹åˆ° Catalog ä¸‹çš„ Schema |
| `USE SCHEMA` | å…è¨±çœ‹åˆ° Schema ä¸‹çš„ Table |
| `SELECT` | å…è¨±è®€å– Table è³‡æ–™ |

### å¸¸è¦‹éŒ¯èª¤
```
éŒ¯èª¤ 1ï¼šåªæˆäºˆ SELECT
â”œâ”€â”€ å•é¡Œï¼šç„¡æ³•é€²å…¥ Catalog/Schema
â””â”€â”€ çµæœï¼šERROR - Table not found

éŒ¯èª¤ 2ï¼šå¿˜è¨˜ USE SCHEMA
â”œâ”€â”€ å•é¡Œï¼šå¯ä»¥çœ‹åˆ° Catalogï¼Œä½†çœ‹ä¸åˆ° Schema ä¸‹çš„ Table
â””â”€â”€ çµæœï¼šERROR - Schema not accessible

éŒ¯èª¤ 3ï¼šçµ¦å¤ªå¤šæ¬Šé™ï¼ˆé•åæœ€å°æ¬Šé™åŸå‰‡ï¼‰
â”œâ”€â”€ å•é¡Œï¼šçµ¦äº† ALL PRIVILEGES
â””â”€â”€ é¢¨éšªï¼šç”¨æˆ¶å¯ä»¥ä¿®æ”¹æˆ–åˆªé™¤è³‡æ–™
```

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶
- [Unity Catalog Privileges](https://docs.databricks.com/data-governance/unity-catalog/manage-privileges/privileges.html)
- [Grant Privileges](https://docs.databricks.com/sql/language-manual/security-grant.html)
- [USE CATALOG](https://docs.databricks.com/data-governance/unity-catalog/manage-privileges/privileges.html#use-catalog)

---

**[è¿”å›é¡Œç›®](#question-003)**
