# Question #001

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-001`

### ä¾†æº
**ä¾†æº:** Community

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

A data engineer is tasked with ingesting x-ray image files of type JPEG into a Delta table using Auto Loader.

Which of the following code snippets can the data engineer use to achieve this task?

### é¸é …

- **A.**
```python
df = spark.readStream.format("cloudFiles") \
          .option("cloudFiles.format", "jpg") \
          .load("/source/x-ray")
```

- **B.**
```python
df = spark.readStream.format("cloudFiles") \
          .option("cloudFiles.format", "binaryFile") \
          .option("pathGlobfilter", "*.jpg") \
          .load("/source/x-ray")
```

- **C.**
```python
df = spark.readStream.format("cloudFiles") \
          .option("cloudFiles.format", "binaryFile") \
          .load("/source/x-ray/*.jpg")
```

- **D.**
```python
df = spark.readStream.format("cloudFiles") \
          .option("cloudFiles.format", "image") \
          .option("pathGlobfilter", "*.jpg") \
          .load("/source/x-ray")
```

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Auto-Loader`, `File-Formats`, `Streaming-Sources`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Syntax-Confusion`, `Parameter-Order`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Development

---

## ç­”æ¡ˆèˆ‡ä¾†æº

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** B
- **ç¤¾ç¾¤å…±è­˜:** B

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Auto Loader / Binary File Ingestion
**é—œéµæ¦‚å¿µ:** cloudFiles format, pathGlobFilter, binaryFile æ ¼å¼

**é¡Œç›®é—œéµå­—ï¼š**
- **JPEG image files**: åœ–ç‰‡æ˜¯äºŒé€²ä½æª”æ¡ˆï¼Œä¸æ˜¯çµæ§‹åŒ–è³‡æ–™æ ¼å¼ã€‚
- **Auto Loader**: ä½¿ç”¨ `cloudFiles` æ ¼å¼é€²è¡Œä¸²æµè®€å–ã€‚
- **Delta table**: æœ€çµ‚å„²å­˜ç›®æ¨™ã€‚

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ B æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**æŠ€è¡“åŸç†ï¼š**

1. **binaryFile æ ¼å¼çš„å¿…è¦æ€§**:
   åœ–ç‰‡æª”æ¡ˆï¼ˆJPEGã€PNG ç­‰ï¼‰æ˜¯äºŒé€²ä½è³‡æ–™ï¼Œä¸æ˜¯ Spark åŸç”Ÿæ”¯æ´çš„è³‡æ–™æ ¼å¼ï¼ˆå¦‚ JSONã€CSVã€Parquetï¼‰ã€‚è¦è®€å–é€™é¡æª”æ¡ˆï¼Œå¿…é ˆä½¿ç”¨ `binaryFile` æ ¼å¼ï¼Œå®ƒæœƒå°‡æ¯å€‹æª”æ¡ˆä½œç‚ºä¸€ç­†è¨˜éŒ„è®€å…¥ï¼ŒåŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š
   - `path`: æª”æ¡ˆè·¯å¾‘
   - `modificationTime`: ä¿®æ”¹æ™‚é–“
   - `length`: æª”æ¡ˆå¤§å°
   - `content`: äºŒé€²ä½å…§å®¹ï¼ˆbyte arrayï¼‰

2. **pathGlobFilter çš„ç”¨é€”**:
   `pathGlobFilter` é¸é …å…è¨±ä½ æ ¹æ“šæª”æ¡ˆåç¨±æ¨¡å¼éæ¿¾è¦è®€å–çš„æª”æ¡ˆã€‚è¨­å®š `*.jpg` å¯ä»¥ç¢ºä¿åªè®€å– JPEG æª”æ¡ˆï¼Œå¿½ç•¥ç›®éŒ„ä¸­çš„å…¶ä»–æª”æ¡ˆé¡å‹ã€‚

**æ­£ç¢ºç¨‹å¼ç¢¼çµæ§‹ï¼š**

```python
df = spark.readStream.format("cloudFiles") \
          .option("cloudFiles.format", "binaryFile") \  # âœ… ä½¿ç”¨ binaryFile æ ¼å¼
          .option("pathGlobFilter", "*.jpg") \          # âœ… éæ¿¾ JPEG æª”æ¡ˆ
          .load("/source/x-ray")                        # âœ… è¼‰å…¥ç›®éŒ„
```

**è¼¸å‡º Schemaï¼š**

```
root
 |-- path: string
 |-- modificationTime: timestamp
 |-- length: long
 |-- content: binary
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A - `cloudFiles.format = "jpg"`

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **æ ¼å¼ä¸å­˜åœ¨**: Auto Loader ä¸æ”¯æ´ `jpg` ä½œç‚º `cloudFiles.format` çš„å€¼ã€‚
- **æ”¯æ´çš„æ ¼å¼**: åŒ…æ‹¬ `json`, `csv`, `parquet`, `avro`, `text`, `binaryFile` ç­‰ï¼Œä½†æ²’æœ‰ `jpg` æˆ– `image`ã€‚
- **åŸ·è¡Œçµæœ**: æœƒæ‹‹å‡º `DataSourceNotFoundError` æˆ–é¡ä¼¼éŒ¯èª¤ã€‚

### C - åœ¨ load() ä¸­ä½¿ç”¨ glob pattern

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **Auto Loader ä¸æ”¯æ´**: åœ¨ `load()` è·¯å¾‘ä¸­ä½¿ç”¨ glob patternï¼ˆå¦‚ `*.jpg`ï¼‰å° Auto Loader ç„¡æ•ˆã€‚
- **æ­£ç¢ºåšæ³•**: Auto Loader éœ€è¦ä½¿ç”¨ `pathGlobFilter` é¸é …ä¾†éæ¿¾æª”æ¡ˆï¼Œè€Œä¸æ˜¯åœ¨è·¯å¾‘ä¸­æŒ‡å®š patternã€‚
- **åŸå› **: Auto Loader éœ€è¦ç›£æ§æ•´å€‹ç›®éŒ„ä»¥åµæ¸¬æ–°æª”æ¡ˆï¼Œglob pattern æ‡‰è©²é€éé¸é …æŒ‡å®šã€‚

### D - `cloudFiles.format = "image"`

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **æ ¼å¼ä¸å­˜åœ¨**: `image` ä¸æ˜¯ Auto Loader æ”¯æ´çš„æ ¼å¼ã€‚
- **èˆ‡ A ç›¸ä¼¼**: é€™æ˜¯å¸¸è¦‹çš„èª¤è§£ï¼Œèªç‚ºæœ‰å°ˆé–€çš„åœ–ç‰‡æ ¼å¼ï¼Œä½†å¯¦éš›ä¸Šæ‡‰ä½¿ç”¨ `binaryFile`ã€‚

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£

**ã€Œåœ–ç‰‡äºŒé€²ä½ï¼ŒGlob ä¾†éæ¿¾ã€**

- **åœ–ç‰‡/äºŒé€²ä½æª”æ¡ˆ** â†’ ä½¿ç”¨ `binaryFile` æ ¼å¼
- **éæ¿¾æª”æ¡ˆé¡å‹** â†’ ä½¿ç”¨ `pathGlobFilter` é¸é …

### æ¯”è¼ƒè¡¨

| éœ€æ±‚ | æ­£ç¢ºåšæ³• | éŒ¯èª¤åšæ³• |
|------|----------|----------|
| è®€å–åœ–ç‰‡æª”æ¡ˆ | `cloudFiles.format = "binaryFile"` | `"jpg"` æˆ– `"image"` |
| éæ¿¾ç‰¹å®šå‰¯æª”å | `.option("pathGlobFilter", "*.jpg")` | `.load("path/*.jpg")` |
| è®€å–çµæ§‹åŒ–è³‡æ–™ | `"json"`, `"csv"`, `"parquet"` | `"binaryFile"` |

### Auto Loader æ”¯æ´çš„æ ¼å¼

```
çµæ§‹åŒ–æ ¼å¼: json, csv, parquet, avro, orc
åŠçµæ§‹åŒ–:   text, xml (with library)
äºŒé€²ä½:     binaryFile âœ… (ç”¨æ–¼åœ–ç‰‡ã€PDF ç­‰)
```

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶

- [Auto Loader Options](https://docs.databricks.com/ingestion/auto-loader/options.html)
- [Binary File Data Source](https://docs.databricks.com/ingestion/binary.html)
- [pathGlobFilter Option](https://docs.databricks.com/ingestion/auto-loader/options.html#pathglobfilter)

---

**[è¿”å›é¡Œç›®](#question-001)**
