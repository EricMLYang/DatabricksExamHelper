# Question #027

---

## é¡Œç›®è³‡è¨Š
### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-027`

### ä¾†æº
**ä¾†æº:** Sample / Batch 1

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L1-Basic`

---

## é¡Œç›®å…§å®¹
### é¡Œå¹¹
A data engineer is working on a project where they need to integrate data from an external API into a Databricks workspace. For security reasons, they do not want to hardcode the API Key directly in their notebooks. Instead, they want to use Databricks Secrets to securely store and manage sensitive credentials.

Which Databricks CLI commands should they use to accomplish this goal?

### é¸é …
- **A.**
```
databricks secrets create-secret api_secrets
databricks secrets put-scope api_key api_secrets
```

- **B.**
```
databricks secrets create-scope api_scope
databricks secrets put-secret api_key api_scope
```

- **C.**
```
databricks secrets create-secret api_secrets
databricks secrets put-scope api_secrets api_key
```

- **D.**
```
databricks secrets create-scope api_scope
databricks secrets put-secret api_scope api_key
```

---

## æ¨™ç±¤ç³»çµ±
### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Databricks-Secrets`, `Databricks-CLI`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Parameter-Order`, `Syntax-Confusion`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Security

---

## ç­”æ¡ˆèˆ‡ä¾†æº
### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `D`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** D
- **ç¤¾ç¾¤å…±è­˜:** D

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Databricks Secrets CLI æŒ‡ä»¤

**é—œéµæ¦‚å¿µ:**
- Secret Scope èˆ‡ Secret çš„å±¤ç´šé—œä¿‚
- CLI æŒ‡ä»¤çš„æ­£ç¢ºèªæ³•
- åƒæ•¸é †åºï¼šSCOPE åœ¨å‰ï¼ŒKEY åœ¨å¾Œ

**é¡Œç›®é—œéµå­—ï¼š**
- **Databricks Secrets**: å¯†é‘°ç®¡ç†æœå‹™
- **create-scope**: å»ºç«‹ Secret Scope
- **put-secret**: æ–°å¢ Secret åˆ° Scope

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ D æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**æŠ€è¡“åŸç†ï¼š**

Databricks Secrets ä½¿ç”¨**å…©å±¤æ¶æ§‹**ï¼š
1. **Scopeï¼ˆç¯„åœï¼‰**ï¼šSecret çš„å®¹å™¨ï¼Œç”¨æ–¼çµ„ç¹”å’Œç®¡ç†æ¬Šé™
2. **Secretï¼ˆå¯†é‘°ï¼‰**ï¼šå¯¦éš›å„²å­˜çš„æ•æ„Ÿè³‡æ–™

#### æ­£ç¢ºçš„ CLI æŒ‡ä»¤

```bash
# æ­¥é©Ÿ 1: å»ºç«‹ Secret Scope
databricks secrets create-scope SCOPE_NAME

# æ­¥é©Ÿ 2: æ–°å¢ Secret åˆ° Scope
databricks secrets put-secret SCOPE_NAME KEY_NAME
# åŸ·è¡Œå¾Œæœƒæç¤ºè¼¸å…¥ Secret å€¼
```

#### é¡Œç›®ç­”æ¡ˆåˆ†æ

```bash
# æ­£ç¢ºç­”æ¡ˆ D
databricks secrets create-scope api_scope      # å»ºç«‹åç‚º api_scope çš„ Scope
databricks secrets put-secret api_scope api_key # åœ¨ api_scope ä¸­æ–°å¢åç‚º api_key çš„ Secret
```

#### å®Œæ•´ä½¿ç”¨æµç¨‹

```bash
# 1. å»ºç«‹ Scope
databricks secrets create-scope my_api_scope

# 2. æ–°å¢ Secretï¼ˆæœƒæç¤ºè¼¸å…¥å€¼ï¼‰
databricks secrets put-secret my_api_scope api_key
# æˆ–ä½¿ç”¨ç®¡é“è¼¸å…¥
echo "my-secret-value" | databricks secrets put-secret my_api_scope api_key

# 3. åœ¨ Notebook ä¸­ä½¿ç”¨
```

```python
# åœ¨ Databricks Notebook ä¸­è®€å– Secret
api_key = dbutils.secrets.get(scope="my_api_scope", key="api_key")

# ä½¿ç”¨ API Key
import requests
response = requests.get(
    "https://api.example.com/data",
    headers={"Authorization": f"Bearer {api_key}"}
)
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### é¸é … A
```
databricks secrets create-secret api_secrets
databricks secrets put-scope api_key api_secrets
```

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

1. **æŒ‡ä»¤åç¨±éŒ¯èª¤**ï¼š
   - `create-secret` ä¸å­˜åœ¨ï¼Œæ­£ç¢ºæ˜¯ `create-scope`
   - `put-scope` ä¸å­˜åœ¨ï¼Œæ­£ç¢ºæ˜¯ `put-secret`

2. **æ¦‚å¿µæ··æ·†**ï¼š
   - æ‡‰è©²å…ˆå»ºç«‹ Scopeï¼Œå† put Secret
   - ä¸æ˜¯å…ˆå»ºç«‹ Secretï¼Œå† put Scope

---

### é¸é … B
```
databricks secrets create-scope api_scope
databricks secrets put-secret api_key api_scope
```

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

1. **åƒæ•¸é †åºéŒ¯èª¤**ï¼š
   - æ­£ç¢ºé †åºï¼š`put-secret SCOPE KEY`
   - éŒ¯èª¤é †åºï¼š`put-secret KEY SCOPE`

2. **è¨˜æ†¶æŠ€å·§**ï¼š
   - Scope æ˜¯ã€Œå®¹å™¨ã€ï¼Œè¦å…ˆæŒ‡å®šæ”¾åˆ°å“ªå€‹å®¹å™¨
   - Key æ˜¯ã€Œç‰©å“åç¨±ã€ï¼Œæ”¾åœ¨å¾Œé¢

```bash
# âŒ éŒ¯èª¤ï¼ˆé¸é … Bï¼‰
databricks secrets put-secret api_key api_scope
# é€™æœƒå˜—è©¦åœ¨åç‚º "api_key" çš„ scope ä¸­å»ºç«‹åç‚º "api_scope" çš„ secret

# âœ… æ­£ç¢ºï¼ˆé¸é … Dï¼‰
databricks secrets put-secret api_scope api_key
# åœ¨ "api_scope" é€™å€‹ scope ä¸­å»ºç«‹åç‚º "api_key" çš„ secret
```

---

### é¸é … C
```
databricks secrets create-secret api_secrets
databricks secrets put-scope api_secrets api_key
```

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

1. **é›™é‡éŒ¯èª¤**ï¼š
   - `create-secret` ä¸æ˜¯æœ‰æ•ˆæŒ‡ä»¤
   - `put-scope` ä¸æ˜¯æœ‰æ•ˆæŒ‡ä»¤

2. **æ­£ç¢ºæŒ‡ä»¤å°ç…§**ï¼š

| éŒ¯èª¤æŒ‡ä»¤ | æ­£ç¢ºæŒ‡ä»¤ |
|---------|---------|
| `create-secret` | `create-scope` |
| `put-scope` | `put-secret` |

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£
**ã€Œå…ˆå»º Scope å†æ”¾ Secretï¼ŒSCOPE KEY é †åºè¨˜ã€**
â†’ create-scope å»ºå®¹å™¨ï¼Œput-secret SCOPE KEY æ”¾å¯†é‘°

### Databricks Secrets CLI æŒ‡ä»¤è¡¨

| æ“ä½œ | æŒ‡ä»¤ | èªæ³• |
|------|------|------|
| **å»ºç«‹ Scope** | `create-scope` | `databricks secrets create-scope SCOPE` |
| **åˆ—å‡º Scopes** | `list-scopes` | `databricks secrets list-scopes` |
| **åˆªé™¤ Scope** | `delete-scope` | `databricks secrets delete-scope SCOPE` |
| **æ–°å¢ Secret** | `put-secret` | `databricks secrets put-secret SCOPE KEY` |
| **åˆ—å‡º Secrets** | `list-secrets` | `databricks secrets list-secrets SCOPE` |
| **åˆªé™¤ Secret** | `delete-secret` | `databricks secrets delete-secret SCOPE KEY` |

### åœ¨ Notebook ä¸­ä½¿ç”¨ Secrets

```python
# è®€å– Secret
secret_value = dbutils.secrets.get(scope="SCOPE", key="KEY")

# åˆ—å‡ºå¯ç”¨çš„ Scopes
dbutils.secrets.listScopes()

# åˆ—å‡º Scope ä¸­çš„ Keysï¼ˆä¸æœƒé¡¯ç¤ºå€¼ï¼‰
dbutils.secrets.list("SCOPE")

# æ³¨æ„ï¼šSecret å€¼åœ¨ Notebook è¼¸å‡ºä¸­æœƒè¢«é®è”½ç‚º [REDACTED]
print(secret_value)  # è¼¸å‡º: [REDACTED]
```

### å®‰å…¨æœ€ä½³å¯¦è¸

1. **ä½¿ç”¨ Secret Scope è€Œéç¡¬ç·¨ç¢¼**
2. **é™åˆ¶ Scope çš„å­˜å–æ¬Šé™**
3. **å®šæœŸè¼ªæ› Secrets**
4. **ä½¿ç”¨ Azure Key Vault æˆ– AWS Secrets Manager æ•´åˆ**

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶

- [Databricks Secrets](https://docs.databricks.com/security/secrets/index.html)
- [Databricks CLI - Secrets](https://docs.databricks.com/dev-tools/cli/secrets-cli.html)
- [Secret Scopes](https://docs.databricks.com/security/secrets/secret-scopes.html)

---

**[è¿”å›é¡Œç›®](#question-027)**
