# Question #008

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-008`

### ä¾†æº
**ä¾†æº:** Community

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L1-Basic`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

A data engineer wants to store passwords securely in a Unity Catalog managed table. They need to hash user passwords using `SHA2(password, 256)` before storing them. To ensure proper storage, the engineer must also set a constraint on the column length to accommodate the full hash value.

The engineer tests hashing the passwords "spark123" and "ApacheSpark111".

What will the engineer notice about the resulting hash lengths?

### é¸é …

- **A.** Both hashes will have the same length, regardless of input size.
- **B.** Both hashes will have the same length because hash length depends on the number of numeric characters.
- **C.** The hash of "spark123" will be shorter than the hash of "ApacheSpark111".
- **D.** The hash of "ApacheSpark111" will be shorter than the hash of "spark123".

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Security`, `Spark-SQL`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Concept-Confusion`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Security

---

## ç­”æ¡ˆèˆ‡ä¾†æº

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `A`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** A
- **ç¤¾ç¾¤å…±è­˜:** A

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Cryptographic Hash Functions / SHA-256
**é—œéµæ¦‚å¿µ:** Fixed-length output, Hash function properties

**é¡Œç›®é—œéµå­—ï¼š**
- **SHA2(password, 256)**: SHA-256 é›œæ¹Šå‡½æ•¸ã€‚
- **hash lengths**: è€ƒå¯Ÿé›œæ¹Šè¼¸å‡ºé•·åº¦çš„ç‰¹æ€§ã€‚
- **constraint on column length**: éœ€è¦çŸ¥é“è¼¸å‡ºé•·åº¦ä¾†è¨­å®šæ¬„ä½å¤§å°ã€‚

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ A æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**æŠ€è¡“åŸç†ï¼š**

1. **é›œæ¹Šå‡½æ•¸çš„å›ºå®šè¼¸å‡ºç‰¹æ€§**:
   å¯†ç¢¼å­¸é›œæ¹Šå‡½æ•¸çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€æ˜¯ï¼šç„¡è«–è¼¸å…¥å¤šé•·æˆ–å¤šçŸ­ï¼Œè¼¸å‡ºé•·åº¦æ°¸é å›ºå®šã€‚

2. **SHA-256 çš„è¼¸å‡º**:
   - è¼¸å‡ºå›ºå®šç‚º **256 bits**
   - ä»¥åå…­é€²ä½è¡¨ç¤ºç‚º **64 å€‹å­—å…ƒ**
   - èˆ‡è¼¸å…¥é•·åº¦å®Œå…¨ç„¡é—œ

3. **å¯¦éš›ç¯„ä¾‹**:
   ```sql
   SELECT sha2('spark123', 256);
   -- çµæœ: 92f55da1cdca0fd9811daa0bc97455c9e9e2b16d29e4e142c56e5924a1446175
   -- é•·åº¦: 64 å­—å…ƒ

   SELECT sha2('ApacheSpark111', 256);
   -- çµæœ: 5385cb3eb8907791fe9efad61f847bb9af6145a6db5689f7687bf7f1c3e25086
   -- é•·åº¦: 64 å­—å…ƒ
   ```

**æ¬„ä½è¨­å®šå»ºè­°ï¼š**

```sql
CREATE TABLE users (
    username STRING,
    password_hash STRING  -- æˆ– CHAR(64) / VARCHAR(64)
);
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### B - é•·åº¦å–æ±ºæ–¼æ•¸å­—å­—å…ƒæ•¸é‡

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **å®Œå…¨ç„¡é—œ**: é›œæ¹Šè¼¸å‡ºèˆ‡è¼¸å…¥çš„å…§å®¹é¡å‹ï¼ˆæ•¸å­—ã€å­—æ¯ã€ç¬¦è™Ÿï¼‰ç„¡é—œã€‚
- **å›ºå®šé•·åº¦**: ç„¡è«–è¼¸å…¥æ˜¯ä»€éº¼ï¼ŒSHA-256 è¼¸å‡ºæ°¸é æ˜¯ 64 å€‹åå…­é€²ä½å­—å…ƒã€‚

### C - "spark123" çš„é›œæ¹Šæ¯”è¼ƒçŸ­

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **é•åé›œæ¹Šç‰¹æ€§**: é›œæ¹Šå‡½æ•¸ä¸æœƒå› ç‚ºè¼¸å…¥è¼ƒçŸ­å°±ç”¢ç”Ÿè¼ƒçŸ­çš„è¼¸å‡ºã€‚
- **éƒ½æ˜¯ 64 å­—å…ƒ**: å…©å€‹è¼¸å…¥çš„é›œæ¹Šé•·åº¦ç›¸åŒã€‚

### D - "ApacheSpark111" çš„é›œæ¹Šæ¯”è¼ƒçŸ­

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **åŒæ¨£éŒ¯èª¤**: è¼¸å…¥è¼ƒé•·ä¸ä»£è¡¨è¼¸å‡ºè¼ƒçŸ­ï¼ˆæˆ–è¼ƒé•·ï¼‰ã€‚
- **é›œæ¹Šé•·åº¦å›ºå®š**: SHA-256 æ°¸é è¼¸å‡º 256 bitsã€‚

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£

**ã€Œé›œæ¹Šå›ºå®šé•·ï¼Œè¼¸å…¥ä¸å½±éŸ¿ã€**

- SHA-**256** â†’ 256 bits â†’ **64** åå…­é€²ä½å­—å…ƒ

### å¸¸è¦‹é›œæ¹Šå‡½æ•¸è¼¸å‡ºé•·åº¦

| æ¼”ç®—æ³• | è¼¸å‡ºé•·åº¦ (bits) | åå…­é€²ä½å­—å…ƒæ•¸ |
|--------|-----------------|----------------|
| MD5 | 128 | 32 |
| SHA-1 | 160 | 40 |
| **SHA-256** | **256** | **64** |
| SHA-384 | 384 | 96 |
| SHA-512 | 512 | 128 |

### é›œæ¹Šå‡½æ•¸æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | èªªæ˜ |
|------|------|
| **å›ºå®šé•·åº¦** | è¼¸å‡ºé•·åº¦ä¸è®Šï¼Œèˆ‡è¼¸å…¥ç„¡é—œ |
| **å–®å‘æ€§** | ç„¡æ³•å¾é›œæ¹Šå€¼åæ¨åŸå§‹è¼¸å…¥ |
| **é›ªå´©æ•ˆæ‡‰** | è¼¸å…¥å¾®å°è®ŠåŒ–ï¼Œè¼¸å‡ºå®Œå…¨ä¸åŒ |
| **æŠ—ç¢°æ’** | ä¸åŒè¼¸å…¥ç”¢ç”Ÿç›¸åŒè¼¸å‡ºçš„æ©Ÿç‡æ¥µä½ |

### Spark SQL é›œæ¹Šå‡½æ•¸

```sql
-- SHA-2 ç³»åˆ—
sha2(string, numBits)  -- numBits: 224, 256, 384, 512

-- å…¶ä»–é›œæ¹Šå‡½æ•¸
md5(string)            -- ä¸å»ºè­°ç”¨æ–¼å®‰å…¨å ´æ™¯
sha1(string)           -- ä¸å»ºè­°ç”¨æ–¼å®‰å…¨å ´æ™¯
hash(expr, ...)        -- Spark å…§éƒ¨é›œæ¹Šï¼ˆéå¯†ç¢¼å­¸ï¼‰
xxhash64(expr, ...)    -- å¿«é€Ÿé›œæ¹Šï¼ˆéå¯†ç¢¼å­¸ï¼‰
```

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶

- [Spark SQL sha2 Function](https://spark.apache.org/docs/latest/api/sql/index.html#sha2)
- [Cryptographic Hash Functions](https://en.wikipedia.org/wiki/Cryptographic_hash_function)
- [Data Security Best Practices](https://docs.databricks.com/security/index.html)

---

**[è¿”å›é¡Œç›®](#question-008)**
