# Question #036

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-036`

### ä¾†æº
**ä¾†æº:** Community

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

The data engineering team wants to create a multiplex bronze Delta table from a Kafka source. The Delta Table has the following schema:

```
key BINARY, value BINARY, topic STRING, partition LONG, offset LONG, timestamp LONG
```

Since the "value" column contains Personal Identifiable Information (PII) for some topics, the team wants to apply Access Control Lists (ACLs) at partition boundaries to restrict access to this PII data.

Based on the above schema and the specified requirement, which column is a good candidate for partitioning?

### é¸é …

- **A.** timestamp
- **B.** key
- **C.** partition
- **D.** topic

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Delta-Lake-Partitioning`, `Access-Control`, `Security`, `Medallion-Architecture`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Keyword-Match`, `Context-Dependent`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Security

---

## ç­”æ¡ˆèˆ‡ä¾†æº

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `D`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** D
- **ç¤¾ç¾¤å…±è­˜:** D

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Delta Lake Partitioning / Security Design
**é—œéµæ¦‚å¿µ:** Partition-based ACL, PII protection, Multiplex bronze table

**é¡Œç›®é—œéµå­—ï¼š**
- **PII for some topics**: æŸäº› topic åŒ…å« PIIã€‚
- **ACLs at partition boundaries**: åœ¨åˆ†å€é‚Šç•Œå¥—ç”¨å­˜å–æ§åˆ¶ã€‚
- **restrict access to PII data**: é™åˆ¶å° PII è³‡æ–™çš„å­˜å–ã€‚

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ D æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**æŠ€è¡“åŸç†ï¼š**

1. **éœ€æ±‚åˆ†æ**:
   - æŸäº› Kafka topics åŒ…å« PII
   - éœ€è¦å° PII topics é™åˆ¶å­˜å–
   - å¸Œæœ›ç”¨åˆ†å€é‚Šç•Œä¾†å¯¦ç¾ ACL

2. **ç‚ºä»€éº¼é¸ topic**:
   - **é‚è¼¯åˆ†é›¢**: ä¸åŒ topic ä»£è¡¨ä¸åŒçš„è³‡æ–™é¡å‹/ä¾†æº
   - **PII å€åˆ†**: PII è³‡æ–™é›†ä¸­åœ¨ç‰¹å®š topics
   - **åˆ†å€å¾Œå¯é‡å° topic è¨­å®šä¸åŒæ¬Šé™**

3. **åˆ†å€å¾Œçš„çµæ§‹**:
   ```
   bronze_table/
   â”œâ”€â”€ topic=orders/          # é PII
   â”œâ”€â”€ topic=inventory/       # é PII
   â”œâ”€â”€ topic=user_profiles/   # PII - éœ€è¦é™åˆ¶å­˜å–
   â””â”€â”€ topic=transactions/    # PII - éœ€è¦é™åˆ¶å­˜å–
   ```

4. **ACL æ‡‰ç”¨**:
   ```sql
   -- å¯ä»¥é‡å°ç‰¹å®š topic åˆ†å€è¨­å®šæ¬Šé™
   GRANT SELECT ON TABLE bronze_table
   WHERE topic IN ('orders', 'inventory') TO `analysts`;
   ```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A - timestamp

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **ç„¡æ³•å€åˆ† PII**: æ™‚é–“æˆ³è¨˜ç„¡æ³•å€åˆ†å“ªäº›è³‡æ–™åŒ…å« PIIã€‚
- **ç”¨æ–¼æ™‚é–“æŸ¥è©¢**: timestamp é©åˆç”¨æ–¼æ™‚é–“ç¯„åœæŸ¥è©¢å„ªåŒ–ï¼Œä¸æ˜¯å®‰å…¨æ§åˆ¶ã€‚
- **é«˜åŸºæ•¸å•é¡Œ**: æ™‚é–“æˆ³è¨˜å€¼å¤ªå¤šï¼Œæœƒç”¢ç”Ÿéå¤šåˆ†å€ã€‚

### B - key

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **é«˜åŸºæ•¸**: key é€šå¸¸æ˜¯å”¯ä¸€å€¼ï¼Œæœƒç”¢ç”Ÿå¤ªå¤šåˆ†å€ã€‚
- **ç„¡é‚è¼¯åˆ†çµ„**: key ç„¡æ³•å°‡è³‡æ–™æŒ‰ PII/é PII åˆ†çµ„ã€‚
- **æ•ˆèƒ½å•é¡Œ**: å¤§é‡å°åˆ†å€æœƒé™ä½æŸ¥è©¢æ•ˆèƒ½ã€‚

### C - partitionï¼ˆKafka partitionï¼‰

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **èˆ‡å®‰å…¨ç„¡é—œ**: Kafka partition æ˜¯åŸºæ–¼è² è¼‰å¹³è¡¡ï¼Œä¸æ˜¯è³‡æ–™é¡å‹ã€‚
- **åŒä¸€ topic çš„ PII å¯èƒ½åˆ†æ•£åœ¨å¤šå€‹ partition**: ç„¡æ³•æœ‰æ•ˆéš”é›¢ã€‚
- **æ··æ·†æ¦‚å¿µ**: Kafka partition â‰  Delta Lake partitionã€‚

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£

**ã€Œtopic åˆ† PIIï¼Œå®‰å…¨å¥½ç®¡ç†ã€**

### åˆ†å€æ¬„ä½é¸æ“‡åŸå‰‡

| è€ƒé‡å› ç´  | å¥½çš„åˆ†å€æ¬„ä½ | ä¸å¥½çš„åˆ†å€æ¬„ä½ |
|----------|-------------|---------------|
| åŸºæ•¸ | ä½åˆ°ä¸­ç­‰ | é«˜åŸºæ•¸ï¼ˆå¦‚ IDï¼‰ |
| æŸ¥è©¢æ¨¡å¼ | ç¶“å¸¸ç”¨æ–¼éæ¿¾ | å¾ˆå°‘ç”¨æ–¼éæ¿¾ |
| **å®‰å…¨éœ€æ±‚** | **èƒ½å€åˆ†æ•æ„Ÿ/éæ•æ„Ÿ** | ç„¡æ³•å€åˆ† |
| è³‡æ–™åˆ†å¸ƒ | å‡å‹» | æ¥µåº¦ä¸å‡å‹» |

### Multiplex Bronze Table è¨­è¨ˆ

```
Kafka Sources (å¤šå€‹ topics)
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Multiplex Bronze Table â”‚
â”‚  PARTITIONED BY (topic) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ topic=pii_data     ğŸ”’   â”‚ â† é™åˆ¶å­˜å–
â”‚ topic=public_data  ğŸ”“   â”‚ â† é–‹æ”¾å­˜å–
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½•æ™‚ä½¿ç”¨ topic åˆ†å€

| å ´æ™¯ | æ˜¯å¦é©åˆ |
|------|----------|
| éœ€è¦æŒ‰ topic è¨­å®šä¸åŒæ¬Šé™ | âœ… |
| ç¶“å¸¸æŒ‰ topic éæ¿¾æŸ¥è©¢ | âœ… |
| topic æ•¸é‡é©ä¸­ï¼ˆæ•¸åå€‹ï¼‰| âœ… |
| topic æ•¸é‡éå¤šï¼ˆæ•¸åƒå€‹ï¼‰| âŒ |

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶

- [Delta Lake Partitioning](https://docs.databricks.com/delta/best-practices.html#choose-the-right-partition-column)
- [Multiplex Bronze Tables](https://docs.databricks.com/structured-streaming/delta-lake.html#multiplex-bronze-table-pattern)

---

**[è¿”å›é¡Œç›®](#question-036)**
