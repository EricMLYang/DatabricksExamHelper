# Question #050

---

## é¡Œç›®è³‡è¨Š
### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-050`
### ä¾†æº
**ä¾†æº:** Community
### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹
### é¡Œå¹¹
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
A financial services firm manages highly sensitive client investment portfolios in Oracle databases and maintains its transactional market data in Microsoft SQL Server. Due to HIPAA regulations, data must remain in place and not be duplicated or exported unnecessarily. However, internal audit teams need to generate unified reports across both systems in Databricks while maintaining tight access control.

What solution should the data team use to enable direct querying to these databases without duplicating the data?

### é¸é …
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
- **A.** Delta Sharing
- **B.** Lakehouse Federation
- **C.** Partner Connect
- **D.** Shallow clone

---

## æ¨™ç±¤ç³»çµ±
### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Unity-Catalog`, `Security`
### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** (ç„¡)
### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Data Architecture

---

## ç­”æ¡ˆèˆ‡ä¾†æº
### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`
### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** B
- **ç¤¾ç¾¤å…±è­˜:** B

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥
**æ ¸å¿ƒæŠ€è¡“:** Lakehouse Federation
**é—œéµæ¦‚å¿µ:** å¤–éƒ¨è³‡æ–™åº«è¯åˆæŸ¥è©¢ã€é›¶è¤‡è£½å­˜å–
**é¡Œç›®é—œéµå­—ï¼š**
- **direct querying to these databases**: ç›´æ¥æŸ¥è©¢å¤–éƒ¨è³‡æ–™åº«
- **without duplicating the data**: ä¸è¤‡è£½è³‡æ–™
- **HIPAA regulations**: æ³•è¦è¦æ±‚è³‡æ–™ä¸èƒ½ç§»å‹•

---

## âœ… æ­£è§£èªªæ˜
### ç‚ºä»€éº¼ B æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**Lakehouse Federation** å…è¨±ç›´æ¥æŸ¥è©¢å¤–éƒ¨è³‡æ–™åº«ï¼ˆå¦‚ Oracleã€SQL Serverï¼‰ï¼Œ**ç„¡éœ€è¤‡è£½è³‡æ–™**ã€‚

#### Lakehouse Federation çš„ç‰¹æ€§
| ç‰¹æ€§ | èªªæ˜ |
|------|------|
| **é›¶è¤‡è£½** | è³‡æ–™ä¿ç•™åœ¨åŸå§‹è³‡æ–™åº« |
| **è¯åˆæŸ¥è©¢** | è·¨å¤šå€‹è³‡æ–™ä¾†æºçµ±ä¸€æŸ¥è©¢ |
| **çµ±ä¸€æ²»ç†** | é€é Unity Catalog ç®¡ç†å­˜å–æ¬Šé™ |
| **æ”¯æ´å¤šç¨®è³‡æ–™åº«** | Oracleã€SQL Serverã€PostgreSQLã€MySQL ç­‰ |

#### Lakehouse Federation æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Databricks Workspace            â”‚
â”‚                     â”‚                        â”‚
â”‚             Unity Catalog                    â”‚
â”‚                     â”‚                        â”‚
â”‚         Lakehouse Federation                 â”‚
â”‚        /           â”‚           \             â”‚
â”‚       â†“            â†“            â†“            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚Oracle â”‚   â”‚SQL Serverâ”‚   â”‚PostgreSQLâ”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚   è³‡æ–™ä¿ç•™åœ¨åŸè™•ï¼Œä¸éœ€è¤‡è£½                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç‚ºä»€éº¼é©åˆæœ¬é¡Œå ´æ™¯ï¼Ÿ
```
é¡Œç›®éœ€æ±‚ï¼š
â”œâ”€â”€ è³‡æ–™åœ¨ Oracle å’Œ SQL Server
â”œâ”€â”€ HIPAA è¦æ±‚è³‡æ–™ä¸èƒ½ç§»å‹•
â”œâ”€â”€ éœ€è¦çµ±ä¸€å ±è¡¨
â””â”€â”€ éœ€è¦å­˜å–æ§åˆ¶

Lakehouse Federation æ»¿è¶³æ‰€æœ‰éœ€æ±‚ï¼š
â”œâ”€â”€ âœ… ç›´æ¥æŸ¥è©¢ï¼Œä¸è¤‡è£½è³‡æ–™
â”œâ”€â”€ âœ… è³‡æ–™ä¿ç•™åŸè™•ï¼Œç¬¦åˆ HIPAA
â”œâ”€â”€ âœ… è·¨è³‡æ–™åº«çµ±ä¸€æŸ¥è©¢
â””â”€â”€ âœ… Unity Catalog æä¾›å­˜å–æ§åˆ¶
```

#### ä½¿ç”¨ç¯„ä¾‹
```sql
-- å»ºç«‹å¤–éƒ¨é€£ç·š
CREATE CONNECTION oracle_conn TYPE oracle
OPTIONS (host 'oracle.example.com', port '1521', ...);

-- å»ºç«‹å¤–éƒ¨ç›®éŒ„
CREATE FOREIGN CATALOG oracle_catalog
USING CONNECTION oracle_conn;

-- ç›´æ¥æŸ¥è©¢å¤–éƒ¨è³‡æ–™
SELECT * FROM oracle_catalog.schema.table
JOIN sqlserver_catalog.schema.table
ON ...
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A. Delta Sharing
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Delta Sharing ç”¨æ–¼**åˆ†äº« Delta Lake è³‡æ–™**çµ¦å¤–éƒ¨
- ä¸æ˜¯ç”¨æ–¼ã€ŒæŸ¥è©¢å¤–éƒ¨è³‡æ–™åº«ã€
- æ–¹å‘ç›¸åï¼šSharing æ˜¯å‘å¤–åˆ†äº«ï¼ŒFederation æ˜¯å‘å…§è¯åˆ

```
Delta Sharing:  Databricks â†’ å¤–éƒ¨ï¼ˆåˆ†äº«å‡ºå»ï¼‰
Federation:     å¤–éƒ¨è³‡æ–™åº« â†’ Databricksï¼ˆè¯åˆæŸ¥è©¢ï¼‰
```

### C. Partner Connect
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Partner Connect ç”¨æ–¼**é€£æ¥ç¬¬ä¸‰æ–¹å·¥å…·**ï¼ˆå¦‚ Tableauã€Power BIï¼‰
- ä¸æ˜¯ç”¨æ–¼é€£æ¥å¤–éƒ¨è³‡æ–™åº«
- æ˜¯ BI/åˆ†æå·¥å…·çš„æ•´åˆï¼Œä¸æ˜¯è³‡æ–™ä¾†æºæ•´åˆ

### D. Shallow clone
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Shallow Clone æ˜¯ Delta Lake çš„**è¤‡è£½åŠŸèƒ½**
- è¤‡è£½çš„æ˜¯ Delta è¡¨æ ¼çš„ metadata
- ä¸é©ç”¨æ–¼å¤–éƒ¨è³‡æ–™åº«ï¼ˆOracleã€SQL Serverï¼‰
- é¡Œç›®æ˜ç¢ºè¦æ±‚ã€Œä¸è¤‡è£½è³‡æ–™ã€

---

## ğŸ§  è¨˜æ†¶æ³•
### å£è¨£
**ã€ŒFederation è¯åˆæŸ¥ï¼Œè³‡æ–™åŸåœ°ä¸ç”¨æ¬ã€**

### Databricks é€£æ¥æ–¹æ¡ˆæ¯”è¼ƒ
| åŠŸèƒ½ | ç”¨é€” | è³‡æ–™æµå‘ |
|------|------|---------|
| **Lakehouse Federation** | æŸ¥è©¢å¤–éƒ¨ DB | å¤–éƒ¨ â†’ Databricks |
| **Delta Sharing** | åˆ†äº« Delta è³‡æ–™ | Databricks â†’ å¤–éƒ¨ |
| **Partner Connect** | é€£æ¥ BI å·¥å…· | Databricks â†’ BI å·¥å…· |

### é¸æ“‡æ±ºç­–æ¨¹
```
éœ€æ±‚æ˜¯ä»€éº¼ï¼Ÿ
â”‚
â”œâ”€â”€ æŸ¥è©¢å¤–éƒ¨è³‡æ–™åº«ï¼ˆOracle/SQL Serverï¼‰
â”‚   â””â”€â”€ Lakehouse Federation â† æœ¬é¡Œç­”æ¡ˆ
â”‚
â”œâ”€â”€ åˆ†äº« Delta Lake è³‡æ–™çµ¦å¤–éƒ¨
â”‚   â””â”€â”€ Delta Sharing
â”‚
â”œâ”€â”€ é€£æ¥ BI/åˆ†æå·¥å…·
â”‚   â””â”€â”€ Partner Connect
â”‚
â””â”€â”€ è¤‡è£½ Delta è¡¨æ ¼
    â””â”€â”€ Clone (Deep/Shallow)
```

### æ³•è¦åˆè¦å ´æ™¯
```
HIPAA/GDPR è¦æ±‚è³‡æ–™ä¸èƒ½ç§»å‹•æ™‚ï¼š
â”œâ”€â”€ å•é¡Œï¼šéœ€è¦åˆ†æå¤–éƒ¨è³‡æ–™åº«çš„è³‡æ–™
â”œâ”€â”€ è§£æ±ºï¼šLakehouse Federation
â””â”€â”€ åŸå› ï¼šé›¶è¤‡è£½ï¼Œè³‡æ–™ä¿ç•™åŸè™•
```

### è¨˜æ†¶æŠ€å·§
- **Federation** = ã€Œè¯é‚¦ã€= å¤šå€‹ç¨ç«‹å¯¦é«”è¯åˆ
- **Sharing** = ã€Œåˆ†äº«ã€= çµ¦åˆ¥äºº
- **Partner** = ã€Œå¤¥ä¼´ã€= å·¥å…·é€£æ¥

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶
- [Lakehouse Federation](https://docs.databricks.com/en/query-federation/index.html)
- [Create a connection for federated queries](https://docs.databricks.com/en/query-federation/create-connections.html)

---

**[è¿”å›é¡Œç›®](#question-050)**
