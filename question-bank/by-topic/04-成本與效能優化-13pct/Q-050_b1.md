# Question #050

---

## é¡Œç›®è³‡è¨Š
### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-050`
### ä¾†æº
**ä¾†æº:** Community
### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L1-Basic`

---

## é¡Œç›®å…§å®¹
### é¡Œå¹¹
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
Which of the following is the benefit of Delta Lake File Statistics?

### é¸é …
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
- **A.** They are used as checksums to check data corruption in parquet files.
- **B.** They are leveraged for data skipping when executing selective queries.
- **C.** They are leveraged for process time forecasting when executing selective queries.
- **D.** They are leveraged for data compression in order to improve Delta Caching.

---

## æ¨™ç±¤ç³»çµ±
### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Delta-Lake`, `Delta-Optimization`
### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** (ç„¡)
### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Delta Lake Internals

---

## ç­”æ¡ˆèˆ‡ä¾†æº
### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`
### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** B
- **ç¤¾ç¾¤å…±è­˜:** B

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥
**æ ¸å¿ƒæŠ€è¡“:** Delta Lake File Statistics
**é—œéµæ¦‚å¿µ:** Data Skippingã€æŸ¥è©¢å„ªåŒ–
**é¡Œç›®é—œéµå­—ï¼š**
- **File Statistics**: æ¯å€‹è³‡æ–™æª”æ¡ˆçš„çµ±è¨ˆè³‡è¨Š
- **Data skipping**: è·³éä¸ç›¸é—œæª”æ¡ˆçš„å„ªåŒ–æŠ€è¡“
- **selective queries**: å¸¶æœ‰éæ¿¾æ¢ä»¶çš„æŸ¥è©¢

---

## âœ… æ­£è§£èªªæ˜
### ç‚ºä»€éº¼ B æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

Delta Lake File Statistics çš„ä¸»è¦ç”¨é€”æ˜¯**Data Skippingï¼ˆè³‡æ–™è·³éï¼‰**ï¼Œé€™æ˜¯ä¸€ç¨®æŸ¥è©¢å„ªåŒ–æŠ€è¡“ã€‚

#### File Statistics åŒ…å«çš„è³‡è¨Š
| çµ±è¨ˆé¡å‹ | èªªæ˜ | ç”¨é€” |
|---------|------|------|
| **numRecords** | æ¯å€‹æª”æ¡ˆçš„è¨˜éŒ„æ•¸ | å¿«é€Ÿè¨ˆç®— COUNT(*) |
| **minValues** | æ¯æ¬„çš„æœ€å°å€¼ | ç¯„åœéæ¿¾è·³é |
| **maxValues** | æ¯æ¬„çš„æœ€å¤§å€¼ | ç¯„åœéæ¿¾è·³é |
| **nullCount** | æ¯æ¬„çš„ NULL æ•¸é‡ | NULL éæ¿¾å„ªåŒ– |

#### Data Skipping é‹ä½œç¯„ä¾‹
```sql
-- æŸ¥è©¢æ¢ä»¶
SELECT * FROM orders WHERE order_date = '2024-01-15'

-- File Statistics ç¯„ä¾‹ï¼š
-- File 1: order_date min=2024-01-01, max=2024-01-10
-- File 2: order_date min=2024-01-11, max=2024-01-20
-- File 3: order_date min=2024-01-21, max=2024-01-31

-- å„ªåŒ–çµæœï¼š
-- File 1: min=01-01, max=01-10, æŸ¥è©¢ 01-15 â†’ è·³é âœ“
-- File 2: min=01-11, max=01-20, åŒ…å« 01-15 â†’ è®€å–
-- File 3: min=01-21, max=01-31, æŸ¥è©¢ 01-15 â†’ è·³é âœ“

-- çµæœï¼šåªè®€å– 1/3 çš„æª”æ¡ˆï¼Œæ•ˆèƒ½æå‡ 3 å€
```

#### COUNT(*) å„ªåŒ–ç¯„ä¾‹
```sql
-- ä¸éœ€è¦æƒæè³‡æ–™æª”æ¡ˆ
SELECT COUNT(*) FROM orders

-- Delta Lake ç›´æ¥å¾çµ±è¨ˆè³‡è¨Šè¨ˆç®—ï¼š
-- File 1: numRecords = 1000
-- File 2: numRecords = 1500
-- File 3: numRecords = 800
-- Total = 3300ï¼ˆç„¡éœ€è®€å–ä»»ä½• Parquet æª”æ¡ˆï¼‰
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A. ...used as checksums to check data corruption...
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- çµ±è¨ˆè³‡è¨Šç”¨æ–¼**æŸ¥è©¢å„ªåŒ–**ï¼Œä¸æ˜¯è³‡æ–™å®Œæ•´æ€§é©—è­‰
- Parquet æª”æ¡ˆæœ¬èº«æœ‰å…§å»ºçš„ checksum æ©Ÿåˆ¶
- File Statistics åŒ…å« min/max/countï¼Œä¸æ˜¯ checksum

### C. ...process time forecasting...
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- çµ±è¨ˆè³‡è¨Šä¸ç”¨æ–¼é æ¸¬åŸ·è¡Œæ™‚é–“
- Databricks ä½¿ç”¨å…¶ä»–æ©Ÿåˆ¶ï¼ˆå¦‚ Query Profileï¼‰ä¾†åˆ†æåŸ·è¡Œæ™‚é–“
- é€™ä¸æ˜¯ File Statistics çš„è¨­è¨ˆç›®çš„

### D. ...data compression to improve Delta Caching.
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- çµ±è¨ˆè³‡è¨Šèˆ‡è³‡æ–™å£“ç¸®ç„¡é—œ
- Delta Caching æ˜¯åŸºæ–¼è³‡æ–™å­˜å–é »ç‡çš„å¿«å–æ©Ÿåˆ¶
- å£“ç¸®ç”± Parquet æ ¼å¼å’Œå£“ç¸®ç·¨ç¢¼æ§åˆ¶

---

## ğŸ§  è¨˜æ†¶æ³•
### å£è¨£
**ã€Œçµ±è¨ˆè³‡è¨Šä¸‰åŠŸèƒ½ï¼šè·³éæª”æ¡ˆã€å¿«é€Ÿè¨ˆæ•¸ã€ç¯„åœéæ¿¾ã€**

### File Statistics æ•ˆç›Šåœ–
```
æŸ¥è©¢åŸ·è¡Œæµç¨‹ï¼ˆæœ‰ File Statisticsï¼‰ï¼š

1. è§£ææŸ¥è©¢æ¢ä»¶
      â†“
2. è®€å– Transaction Log ä¸­çš„çµ±è¨ˆè³‡è¨Š
      â†“
3. æ¯”è¼ƒæ¢ä»¶èˆ‡ min/max å€¼
      â†“
4. è·³éä¸ç›¸é—œæª”æ¡ˆ â† Data Skipping!
      â†“
5. åªè®€å–å¯èƒ½åŒ…å«è³‡æ–™çš„æª”æ¡ˆ
      â†“
6. è¿”å›çµæœ

æ•ˆç›Šï¼šæ¸›å°‘ I/Oï¼Œæå‡æŸ¥è©¢é€Ÿåº¦
```

### Delta Lake å„ªåŒ–æŠ€è¡“å°æ¯”
| æŠ€è¡“ | ä½œç”¨ | ä¾è³´ |
|------|------|------|
| **File Statistics** | Data Skipping | Transaction Log |
| **Z-Order** | æ”¹å–„è³‡æ–™æ’åˆ— | OPTIMIZE æŒ‡ä»¤ |
| **Partitioning** | å¯¦é«”åˆ†å€ | è¡¨æ ¼è¨­è¨ˆ |
| **Delta Cache** | å¿«å–ç†±è³‡æ–™ | å¢é›†è¨˜æ†¶é«” |

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶
- [Delta Lake data skipping](https://docs.databricks.com/en/delta/data-skipping.html)
- [Delta Lake table properties](https://docs.databricks.com/en/delta/table-properties.html)

---

**[è¿”å›é¡Œç›®](#question-050)**
