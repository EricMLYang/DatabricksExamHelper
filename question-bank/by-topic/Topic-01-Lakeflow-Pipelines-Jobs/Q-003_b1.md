# Question #003

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-003`

### ä¾†æº
**ä¾†æº:** Sample / Community

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L1-Basic`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

A data engineer wants to pass multiple parameters from a Databricks Job to a notebook. They already configured the key and value of each parameter in the configurations of the job.

Which of the following utilities can the data engineer use to read the passed parameters inside the notebook?

### é¸é …

- **A.** `dbutils.library`
- **B.** `dbutils.notebook`
- **C.** `dbutils.widgets`
- **D.** `dbutils.secrets`

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Databricks-Workflows`, `ETL-Patterns`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Command-Purpose`, `Similar-Function`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Development

---

## ç­”æ¡ˆèˆ‡ä¾†æº

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `C`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** C
- **ç¤¾ç¾¤å…±è­˜:** C

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Databricks Workflows (Jobs) / DBUtils  
**é—œéµæ¦‚å¿µ:** Notebook Parameterization (Task Parameters)

**é¡Œç›®é—œéµå­—ï¼š**
- **Pass parameters from a Databricks Job**: å¾ Job å‚³éåƒæ•¸ã€‚
- **Read the passed parameters**: åœ¨ Notebook å…§éƒ¨è®€å–åƒæ•¸ã€‚
- **Utilities**: æŒ‡çš„æ˜¯ `dbutils` å·¥å…·çµ„ã€‚

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ C (`dbutils.widgets`) æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**æŠ€è¡“åŸç†ï¼š**

åœ¨ Databricks ä¸­ï¼Œå°‡åƒæ•¸å‚³éçµ¦ Notebook Task çš„æ¨™æº–æ–¹å¼æ˜¯é€é **Widgets** æ©Ÿåˆ¶ã€‚
ç•¶ä½ åœ¨ Job Task configuration ä¸­è¨­å®š "Parameters" (Key-Value pairs) æ™‚ï¼Œé€™äº›åƒæ•¸åœ¨ Notebook åŸ·è¡Œæ™‚æœƒè¢«å°æ‡‰åˆ°åŒåçš„ widget ä¸­ã€‚

**ç¨‹å¼ç¢¼å¯¦ä½œï¼š**

è¦åœ¨ Notebook ä¸­æ¥æ”¶é€™äº›åƒæ•¸ï¼Œå¿…é ˆä½¿ç”¨ `dbutils.widgets` APIï¼š

```python
# 1. åˆå§‹åŒ–/å®šç¾©åƒæ•¸ (è¨­å®šé è¨­å€¼ï¼Œæ–¹ä¾¿äº’å‹•å¼æ¸¬è©¦)
dbutils.widgets.text("env", "dev", "Environment")
dbutils.widgets.text("start_date", "2023-01-01", "Start Date")

# 2. ç²å–åƒæ•¸å€¼ (å¾ Job å‚³å…¥çš„å€¼æœƒè¦†è“‹é è¨­å€¼)
env = dbutils.widgets.get("env")
start_date_str = dbutils.widgets.get("start_date")

print(f"Running for environment: {env}")
```

**é‹ä½œæµç¨‹ï¼š**
1. **Job è¨­å®š**: åœ¨ Job UI çš„ Parameters å€å¡ŠåŠ å…¥ `"env": "prod"`ã€‚
2. **Runtime**: Job å•Ÿå‹• Notebook æ™‚ï¼Œæœƒè‡ªå‹•æ³¨å…¥é€™å€‹ Widget å€¼ã€‚
3. **Notebook**: `dbutils.widgets.get("env")` æœƒè®€å–åˆ° `"prod"`ã€‚

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A - `dbutils.library`

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- **ç”¨é€”**: ç”¨æ–¼ç®¡ç† Python, JAR, R ç¨‹å¼åº«çš„å®‰è£èˆ‡é‡å•Ÿ (ä¾‹å¦‚ `dbutils.library.restartPython()`)ã€‚
- **ç„¡é—œ**: èˆ‡åƒæ•¸å‚³éå®Œå…¨ç„¡é—œã€‚

### B - `dbutils.notebook`

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- **ç”¨é€”**: ä¸»è¦ç”¨æ–¼æ§åˆ¶ Notebook çš„åŸ·è¡Œæµç¨‹ã€‚
    - `dbutils.notebook.run()`: å‘¼å«å¦ä¸€å€‹ Notebook (é€™è£¡å¯ä»¥**å‚³å‡º**åƒæ•¸ï¼Œä½†é¡Œç›®å•çš„æ˜¯**è®€å–**åƒæ•¸)ã€‚
    - `dbutils.notebook.exit()`: é€€å‡º Notebook ä¸¦è¿”å›çµæœã€‚
- **é™·é˜±**: é›–ç„¶ `dbutils.notebook.run` å¯ä»¥å‚³éåƒæ•¸ï¼Œä½†**æ¥æ”¶ç«¯**ä»ç„¶æ˜¯ä¾è³´ `dbutils.widgets` ä¾†è®€å–é€™äº›å€¼ã€‚

### D - `dbutils.secrets`

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- **ç”¨é€”**: ç”¨æ–¼å®‰å…¨åœ°å­˜å–å„²å­˜åœ¨ Secret Scope ä¸­çš„æ©Ÿæ•è³‡æ–™ï¼ˆå¦‚å¯†ç¢¼ã€é‡‘é‘°ï¼‰ã€‚
    - `dbutils.secrets.get(scope="my-scope", key="my-password")`
- **å€åˆ¥**: é›–ç„¶ Secret ä¹Ÿæ˜¯ä¸€ç¨®ã€Œåƒæ•¸ã€ï¼Œä½†é¡Œç›®èªªçš„æ˜¯ "Parameters in the configurations of the job" (ä¸€èˆ¬éµå€¼å°)ï¼Œé€šå¸¸æ˜¯ç”¨æ–¼éæ©Ÿæ•çš„é…ç½®ï¼ˆå¦‚æ—¥æœŸã€è¡¨æ ¼åç¨±ï¼‰ï¼Œä¸” Secret ä¸æ˜¯é€é Job Parameters å€å¡Šç›´æ¥å‚³éæ˜æ–‡å€¼ã€‚

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£

**ã€ŒJob å‚³åƒæ•¸é  Widgetï¼Œget ä¸€ä¸‹å°±æ‹¿åˆ°ã€**

- **Parameters** â†” **Widgets**
- **Secrets** â†” **Passwords/Tokens**

### DBUtils å¸¸ç”¨åŠŸèƒ½å°ç…§

| æ¨¡çµ„ | ä¸»è¦åŠŸèƒ½ | é—œéµæ–¹æ³• |
|------|---------|---------|
| `dbutils.widgets` | åƒæ•¸å‚³é | `.get()`, `.text()`, `.dropdown()` |
| `dbutils.fs` | æª”æ¡ˆç³»çµ± | `.ls()`, `.cp()`, `.mv()` |
| `dbutils.secrets` | æ©Ÿå¯†ç®¡ç† | `.get()`, `.list()` |
| `dbutils.notebook`| åŸ·è¡Œæ§åˆ¶ | `.run()`, `.exit()` |

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶

- [Databricks Widgets](https://docs.databricks.com/notebooks/widgets.html)
- [Pass parameters to a notebook job](https://docs.databricks.com/workflows/jobs/jobs.html#pass-parameters-to-a-notebook-job)

---

**[è¿”å›é¡Œç›®](#question-003)**
