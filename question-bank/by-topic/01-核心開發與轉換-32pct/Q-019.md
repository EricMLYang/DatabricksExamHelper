# Question #19

---

## 題目資訊

### 題目編號
**ID:** `Q-01-019`

### 來源
**來源:** Real Exam Recall

### 難度等級
**難度:** `L2-Intermediate`

---

## 題目內容

### 題幹

A junior data engineer has been asked to develop a streaming data pipeline with a grouped aggregation using DataFrame df.

The pipeline needs to calculate the average humidity and average temperature for each non-overlapping five-minute interval.

Events are recorded once per minute per device.

Streaming DataFrame df has the following schema:

```
"device_id INT, event_time TIMESTAMP, temp FLOAT, humidity FLOAT"
```

Code block:

```python
df.withWatermark("event_time", "10 minutes")
  .groupBy(
      __________,
      "device_id"
  )
  .agg(
      avg("temp").alias("avg_temp"),
      avg("humidity").alias("avg_humidity")
  )
  .writeStream
  .format("delta")
  .saveAsTable("sensor_avg")
```

Choose the response that correctly fills in the blank within the code block to complete this task.

### 選項

- **A.** `to_interval("event_time", "5 minutes").alias("time")`
- **B.** `window("event_time", "5 minutes").alias("time")`
- **C.** `"event_time"`
- **D.** `window("event_time", "10 minutes").alias("time")`
- **E.** `lag("event_time", "10 minutes").alias("time")`

---

## 標籤系統

### Topic Tags (技術主題標籤)
**Topics:** `Structured-Streaming`, `Window-Functions`, `Aggregations`, `Watermark`

### Trap Tags (陷阱類型標籤)
**Traps:** `Window-vs-Watermark`, `Time-Interval`

### Knowledge Domain (知識領域)
**Domain:** `Structured Streaming`

---

## 答案與解析連結

### 正確答案
**正解:** `B`

### 解析檔案
**詳細解析:** [點此查看解析](../analysis/Q-01-019-analysis.md)

---

## 相關資源

### 官方文件
- [Window Operations on Event Time](https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#window-operations-on-event-time)
- [Watermarking](https://docs.databricks.com/structured-streaming/watermarking.html)
