# Question #027

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-027`

### ä¾†æº
**ä¾†æº:** Community

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

A data engineer is designing a streaming ingestion pipeline using Auto Loader. The requirement is that the pipeline should never fail on schema changes but must capture any new columns that arrive in the data for later inspection.

Which configuration should the engineer use?

### é¸é …

- **A.** none
- **B.** addNewColumns
- **C.** rescue
- **D.** failOnNewColumns

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Auto-Loader`, `Schema-Evolution`, `Streaming-Sources`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Similar-Options`, `Keyword-Match`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Development

---

## ç­”æ¡ˆèˆ‡ä¾†æº

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `C`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** C
- **ç¤¾ç¾¤å…±è­˜:** C

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Auto Loader / schemaEvolutionMode
**é—œéµæ¦‚å¿µ:** rescue mode, _rescued_data column, Schema stability

**é¡Œç›®é—œéµå­—ï¼š**
- **never fail on schema changes**: ä¸èƒ½å›  schema è®Šæ›´è€Œå¤±æ•—ã€‚
- **capture any new columns**: æ•ç²æ–°æ¬„ä½ã€‚
- **later inspection**: ç¨å¾Œæª¢æŸ¥ã€‚

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ C æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**æŠ€è¡“åŸç†ï¼š**

1. **rescue æ¨¡å¼çš„è¡Œç‚º**:
   - Schema **ä¸æœƒæ¼”é€²**ï¼ˆä¿æŒç©©å®šï¼‰
   - æ–°æ¬„ä½çš„è³‡æ–™æœƒè¢«æ”¾å…¥ `_rescued_data` æ¬„ä½
   - ä¸²æµ**ä¸æœƒå¤±æ•—**

2. **_rescued_data æ¬„ä½**:
   ```json
   åŸå§‹è³‡æ–™: {"id": 1, "name": "Alice", "new_field": "value"}

   rescue æ¨¡å¼çµæœ:
   | id | name  | _rescued_data                |
   |----|-------|------------------------------|
   | 1  | Alice | {"new_field": "value"}       |
   ```

3. **æ»¿è¶³æ‰€æœ‰éœ€æ±‚**:
   - âœ… ä¸æœƒå¤±æ•—ï¼šschema å›ºå®šï¼Œæ–°æ¬„ä½ä¸æœƒå°è‡´éŒ¯èª¤
   - âœ… æ•ç²æ–°æ¬„ä½ï¼šæ”¾å…¥ _rescued_data
   - âœ… ç¨å¾Œæª¢æŸ¥ï¼šå¯ä»¥æŸ¥è©¢ _rescued_data åˆ†ææ–°æ¬„ä½

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A - none

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **ä¸Ÿå¤±è³‡æ–™**: æ–°æ¬„ä½æœƒè¢«ç›´æ¥å¿½ç•¥/ä¸Ÿæ£„ã€‚
- **ç„¡æ³•æª¢æŸ¥**: æ²’æœ‰ä»»ä½•æ–¹å¼å–å¾—æ–°æ¬„ä½çš„è³‡æ–™ã€‚

### B - addNewColumns

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **å¯èƒ½å°è‡´å¤±æ•—**: å¦‚æœä¸‹æ¸¸ Delta è¡¨æ²’æœ‰å•Ÿç”¨ mergeSchemaï¼Œæœƒå¤±æ•—ã€‚
- **Schema ä¸ç©©å®š**: æ¯æ¬¡æœ‰æ–°æ¬„ä½éƒ½æœƒæ”¹è®Š schemaã€‚
- **ä¸é©åˆå¾ŒçºŒæª¢æŸ¥**: æ–°æ¬„ä½ç›´æ¥åŠ å…¥ schemaï¼Œä¸æ˜¯ã€Œcapture for later inspectionã€ã€‚

### D - failOnNewColumns

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **ç›´æ¥é•åéœ€æ±‚**: é¡Œç›®æ˜ç¢ºè¦æ±‚ã€Œnever failã€ã€‚
- **ç”¨é€”ç›¸å**: é€™å€‹æ¨¡å¼å°ˆé–€ç”¨ä¾†åœ¨é‡åˆ°æ–°æ¬„ä½æ™‚è®“ä¸²æµå¤±æ•—ã€‚

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£

**ã€Œrescue æ•‘è³‡æ–™ï¼Œæ–°æ¬„ä½ä¸ä¸Ÿå¤±ã€**

### schemaEvolutionMode å®Œæ•´å°ç…§è¡¨

| æ¨¡å¼ | Schema è®ŠåŒ– | æ–°æ¬„ä½è™•ç† | ä¸²æµå¤±æ•— |
|------|-------------|------------|----------|
| **none** | ä¸è®Š | ä¸Ÿæ£„ | å¦ |
| **addNewColumns** | æ–°å¢æ¬„ä½ | åŠ å…¥ schema | å¯èƒ½ |
| **rescue** | ä¸è®Š | æ”¾å…¥ _rescued_data | **å¦** |
| **failOnNewColumns** | ä¸è®Š | è§¸ç™¼å¤±æ•— | **æ˜¯** |

### ä½¿ç”¨å ´æ™¯å»ºè­°

| å ´æ™¯ | å»ºè­°æ¨¡å¼ |
|------|----------|
| åš´æ ¼ schema æ§åˆ¶ | failOnNewColumns |
| è‡ªå‹•é©æ‡‰æ–°æ¬„ä½ | addNewColumns |
| **ç©©å®š + ä¸ä¸Ÿè³‡æ–™** | **rescue** |
| å¿½ç•¥æ–°æ¬„ä½ | none |

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶

- [Auto Loader Schema Evolution](https://docs.databricks.com/ingestion/auto-loader/schema.html#schema-evolution)
- [Rescued Data Column](https://docs.databricks.com/ingestion/auto-loader/schema.html#rescued-data-column)

---

**[è¿”å›é¡Œç›®](#question-027)**
