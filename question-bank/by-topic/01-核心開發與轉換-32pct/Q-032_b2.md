# Question #032

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-032`

### ä¾†æº
**ä¾†æº:** Community

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L1-Basic`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

"A feature built into Delta Lake that allows to automatically generate CDC feeds about Delta Lake tables"

Which of the following is being described in the above statement?

### é¸é …

- **A.** Optimized writes
- **B.** Slowly Changing Dimension (SCD)
- **C.** Auto Optimize
- **D.** Change Data Feed (CDF)

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Change-Data-Feed`, `Delta-Lake`, `CDC`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Definition-Match`, `Similar-Acronyms`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Development

---

## ç­”æ¡ˆèˆ‡ä¾†æº

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `D`

### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** D
- **ç¤¾ç¾¤å…±è­˜:** D

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥

**æ ¸å¿ƒæŠ€è¡“:** Delta Lake / Change Data Feed
**é—œéµæ¦‚å¿µ:** CDF, CDC feeds, Row-level changes tracking

**é¡Œç›®é—œéµå­—ï¼š**
- **automatically generate CDC feeds**: è‡ªå‹•ç”¢ç”Ÿ CDC è³‡æ–™æµã€‚
- **built into Delta Lake**: Delta Lake å…§å»ºåŠŸèƒ½ã€‚
- **about Delta Lake tables**: é—œæ–¼ Delta Lake è¡¨çš„è®Šæ›´ã€‚

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ D æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**æŠ€è¡“åŸç†ï¼š**

1. **Change Data Feed (CDF) çš„å®šç¾©**:
   - Delta Lake å…§å»ºåŠŸèƒ½
   - è‡ªå‹•è¿½è¹¤è¡¨çš„è¡Œç´šè®Šæ›´
   - ç”¢ç”Ÿ CDC (Change Data Capture) æ ¼å¼çš„è³‡æ–™æµ

2. **CDF è¨˜éŒ„çš„å…§å®¹**:
   ```
   | id | name  | _change_type | _commit_version | _commit_timestamp |
   |----|-------|--------------|-----------------|-------------------|
   | 1  | Alice | insert       | 1               | 2024-01-01 10:00  |
   | 1  | Alice | update_preimage | 2            | 2024-01-02 10:00  |
   | 1  | Alicia| update_postimage | 2           | 2024-01-02 10:00  |
   | 2  | Bob   | delete       | 3               | 2024-01-03 10:00  |
   ```

3. **å•Ÿç”¨æ–¹å¼**:
   ```sql
   -- å»ºç«‹è¡¨æ™‚å•Ÿç”¨
   CREATE TABLE my_table (...)
   TBLPROPERTIES (delta.enableChangeDataFeed = true);

   -- æˆ–å°ç¾æœ‰è¡¨å•Ÿç”¨
   ALTER TABLE my_table SET TBLPROPERTIES (delta.enableChangeDataFeed = true);
   ```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A - Optimized writes

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **ç”¨é€”ä¸åŒ**: Optimized writes ç”¨æ–¼å„ªåŒ–å¯«å…¥æ•ˆèƒ½ï¼Œæ¸›å°‘å°æª”æ¡ˆã€‚
- **ä¸ç”¢ç”Ÿ CDC**: èˆ‡è®Šæ›´è¿½è¹¤ç„¡é—œã€‚

### B - Slowly Changing Dimension (SCD)

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **æ¦‚å¿µä¸åŒ**: SCD æ˜¯è³‡æ–™å€‰å„²çš„è¨­è¨ˆæ¨¡å¼ï¼ˆType 1, 2, 3ï¼‰ã€‚
- **ä¸æ˜¯ Delta Lake åŠŸèƒ½**: SCD æ˜¯æ–¹æ³•è«–ï¼ŒCDF æ˜¯æŠ€è¡“åŠŸèƒ½ã€‚
- **CDF å¯ç”¨æ–¼å¯¦ä½œ SCD**: ä½†å…©è€…æ˜¯ä¸åŒå±¤æ¬¡çš„æ¦‚å¿µã€‚

### C - Auto Optimize

**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**

- **ç”¨é€”ä¸åŒ**: Auto Optimize è‡ªå‹•åŸ·è¡Œ OPTIMIZE å’Œæª”æ¡ˆå£“ç¸®ã€‚
- **æ•ˆèƒ½å„ªåŒ–**: å°ˆæ³¨æ–¼è®€å–æ•ˆèƒ½ï¼Œä¸æ¶‰åŠè®Šæ›´è¿½è¹¤ã€‚

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£

**ã€ŒCDF è¿½è®Šæ›´ï¼ŒCDC è‡ªå‹•ç”Ÿã€**

### CDC vs CDF å€åˆ†

| æ¦‚å¿µ | å…¨å | èªªæ˜ |
|------|------|------|
| **CDC** | Change Data Capture | é€šç”¨æ¦‚å¿µï¼šæ•ç²è³‡æ–™è®Šæ›´çš„æ–¹æ³• |
| **CDF** | Change Data Feed | Delta Lake çš„å…·é«”å¯¦ä½œ |

### CDF è®Šæ›´é¡å‹

| _change_type | èªªæ˜ |
|--------------|------|
| `insert` | æ–°å¢çš„è¨˜éŒ„ |
| `update_preimage` | æ›´æ–°å‰çš„è¨˜éŒ„å€¼ |
| `update_postimage` | æ›´æ–°å¾Œçš„è¨˜éŒ„å€¼ |
| `delete` | åˆªé™¤çš„è¨˜éŒ„ |

### CDF è®€å–æ–¹å¼

```python
# è®€å–ç‰¹å®šç‰ˆæœ¬ç¯„åœçš„è®Šæ›´
df = spark.read.format("delta") \
    .option("readChangeFeed", "true") \
    .option("startingVersion", 0) \
    .option("endingVersion", 10) \
    .table("my_table")

# æˆ–ä½¿ç”¨æ™‚é–“æˆ³è¨˜
df = spark.read.format("delta") \
    .option("readChangeFeed", "true") \
    .option("startingTimestamp", "2024-01-01") \
    .table("my_table")
```

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶

- [Change Data Feed](https://docs.databricks.com/delta/delta-change-data-feed.html)
- [Read Change Data Feed](https://docs.databricks.com/delta/delta-change-data-feed.html#read-changes-in-batch-queries)

---

**[è¿”å›é¡Œç›®](#question-032)**
