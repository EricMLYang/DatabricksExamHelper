# Question #041

---

## é¡Œç›®è³‡è¨Š
### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-041`
### ä¾†æº
**ä¾†æº:** Community
### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L1-Basic`

---

## é¡Œç›®å…§å®¹
### é¡Œå¹¹
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
A data analyst at a retail company is responsible for generating daily reports on sales performance across multiple regions and product categories. The company ingests transaction data continuously from its online stores using Lakeflow Declarative Pipelines. The analyst needs to create a relational object that can efficiently precompute business-level aggregations, such as total revenue, average order value, and units sold per category, so that downstream reporting and dashboards can access the data quickly without recalculating it every time.

Which of the following objects is most suitable for this use case?

### é¸é …
<!-- âš ï¸ ä¿æŒè‹±æ–‡åŸæ–‡ï¼Œä¸è¦ç¿»è­¯ -->
- **A.** Standard view
- **B.** Temporary view
- **C.** Materialized view
- **D.** Streaming table

---

## æ¨™ç±¤ç³»çµ±
### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Lakeflow-Declarative-Pipelines`, `Delta-Lake`
### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** (ç„¡)
### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** Data Engineering / Data Modeling

---

## ç­”æ¡ˆèˆ‡ä¾†æº
### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `C`
### ç­”æ¡ˆä¾†æº
- **ä¾†æºæ¨™è¨»ç­”æ¡ˆ:** C
- **ç¤¾ç¾¤å…±è­˜:** C

---

# é¡Œç›®è§£æ

---

## ğŸ“ è€ƒé»è­˜åˆ¥
**æ ¸å¿ƒæŠ€è¡“:** Materialized Viewï¼ˆç‰©åŒ–è¦–åœ–ï¼‰
**é—œéµæ¦‚å¿µ:** é è¨ˆç®—èšåˆã€View é¡å‹æ¯”è¼ƒã€æ•ˆèƒ½å„ªåŒ–
**é¡Œç›®é—œéµå­—ï¼š**
- **precompute business-level aggregations**: é å…ˆè¨ˆç®—æ¥­å‹™èšåˆ
- **access the data quickly**: å¿«é€Ÿå­˜å–è³‡æ–™
- **without recalculating**: ä¸éœ€é‡æ–°è¨ˆç®—

---

## âœ… æ­£è§£èªªæ˜
### ç‚ºä»€éº¼ C æ˜¯æ­£ç¢ºç­”æ¡ˆï¼Ÿ

**Materialized Viewï¼ˆç‰©åŒ–è¦–åœ–ï¼‰** æ˜¯å°ˆé–€è¨­è¨ˆç”¨æ–¼é è¨ˆç®—ä¸¦å„²å­˜èšåˆçµæœçš„ç‰©ä»¶ã€‚

#### Materialized View çš„ç‰¹æ€§
| ç‰¹æ€§ | èªªæ˜ |
|------|------|
| **é è¨ˆç®—å„²å­˜** | æŸ¥è©¢çµæœæœƒå¯¦éš›å„²å­˜åœ¨ç£ç¢Ÿä¸Š |
| **è‡ªå‹•æ›´æ–°** | ç•¶ä¾†æºè³‡æ–™è®Šæ›´æ™‚ï¼Œæœƒè‡ªå‹•åˆ·æ–° |
| **å¿«é€ŸæŸ¥è©¢** | ä¸éœ€é‡æ–°è¨ˆç®—ï¼Œç›´æ¥è®€å–çµæœ |
| **é©åˆèšåˆ** | ç‰¹åˆ¥é©åˆ SUMã€AVGã€COUNT ç­‰èšåˆ |

#### ç‚ºä»€éº¼ Materialized View é©åˆæ­¤å ´æ™¯ï¼Ÿ
```sql
-- å»ºç«‹ Materialized View ç¯„ä¾‹
CREATE MATERIALIZED VIEW sales_summary AS
SELECT
    region,
    category,
    SUM(revenue) AS total_revenue,
    AVG(order_value) AS avg_order_value,
    SUM(units) AS units_sold
FROM transactions
GROUP BY region, category;

-- æŸ¥è©¢æ™‚ç›´æ¥è®€å–é è¨ˆç®—çµæœ
SELECT * FROM sales_summary WHERE region = 'North';
-- ä¸éœ€é‡æ–°åŸ·è¡Œèšåˆé‹ç®—ï¼
```

#### Materialized View åœ¨ LDP ä¸­çš„è§’è‰²
```
è³‡æ–™æµç¨‹ï¼š
Streaming Table (åŸå§‹äº¤æ˜“)
        â†“
Materialized View (èšåˆæ‘˜è¦)  â† é è¨ˆç®—å„²å­˜
        â†“
Dashboard / Reports (å¿«é€Ÿè®€å–)
```

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### A. Standard view
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Standard View åªæ˜¯**å„²å­˜æŸ¥è©¢å®šç¾©**ï¼Œä¸å„²å­˜è³‡æ–™
- æ¯æ¬¡æŸ¥è©¢éƒ½éœ€è¦**é‡æ–°åŸ·è¡Œ**å®Œæ•´çš„èšåˆè¨ˆç®—
- ä¸é©åˆéœ€è¦ã€Œå¿«é€Ÿå­˜å–ã€çš„å ´æ™¯

```sql
-- Standard View æ¯æ¬¡éƒ½è¦é‡æ–°è¨ˆç®—
CREATE VIEW sales_view AS
SELECT region, SUM(revenue) FROM transactions GROUP BY region;

SELECT * FROM sales_view;  -- æ¯æ¬¡éƒ½åŸ·è¡Œå®Œæ•´èšåˆ
```

### B. Temporary view
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Temporary View åªå­˜åœ¨æ–¼**ç•¶å‰ Session**
- Session çµæŸå¾Œå°±æ¶ˆå¤±
- ä¸é©åˆéœ€è¦æŒçºŒå­˜åœ¨çš„å ±è¡¨å ´æ™¯
- åŒæ¨£ä¸æœƒé è¨ˆç®—å„²å­˜çµæœ

### D. Streaming table
**ç‚ºä»€éº¼éŒ¯èª¤ï¼Ÿ**
- Streaming Table ç”¨æ–¼**è™•ç†å³æ™‚ä¸²æµè³‡æ–™**
- è¨­è¨ˆç›®çš„æ˜¯**æ¥æ”¶å’Œå„²å­˜åŸå§‹äº‹ä»¶**
- ä¸æ˜¯ç”¨æ–¼é è¨ˆç®—èšåˆæ‘˜è¦
- é¡Œç›®å ´æ™¯éœ€è¦çš„æ˜¯èšåˆçµæœï¼Œä¸æ˜¯åŸå§‹è³‡æ–™

---

## ğŸ§  è¨˜æ†¶æ³•
### å£è¨£
**ã€Œèšåˆè¦å¿«ç”¨ MVï¼Œé å…ˆè¨ˆç®—ä¸ç”¨ç­‰ã€**

### View é¡å‹æ¯”è¼ƒè¡¨
| é¡å‹ | å„²å­˜è³‡æ–™ | ç”Ÿå‘½é€±æœŸ | é©ç”¨å ´æ™¯ |
|------|---------|---------|---------|
| Standard View | âŒ åªå­˜æŸ¥è©¢ | æ°¸ä¹… | ç°¡åŒ–æŸ¥è©¢ã€å®‰å…¨æ§åˆ¶ |
| Temporary View | âŒ åªå­˜æŸ¥è©¢ | Session | è‡¨æ™‚åˆ†æ |
| Materialized View | âœ… å„²å­˜çµæœ | æ°¸ä¹… | é è¨ˆç®—èšåˆ |

### é¸æ“‡æ±ºç­–æ¨¹
```
éœ€è¦é è¨ˆç®—èšåˆå—ï¼Ÿ
â”œâ”€â”€ æ˜¯ â†’ Materialized View âœ“
â””â”€â”€ å¦ â†’ éœ€è¦æŒä¹…åŒ–å—ï¼Ÿ
          â”œâ”€â”€ æ˜¯ â†’ Standard View
          â””â”€â”€ å¦ â†’ Temporary View
```

### LDP ç‰©ä»¶è§’è‰²
```
Lakeflow Declarative Pipelines å¸¸è¦‹ç‰©ä»¶ï¼š
â”œâ”€â”€ Streaming Table    â†’ æ¥æ”¶å³æ™‚è³‡æ–™
â”œâ”€â”€ Materialized View  â†’ é è¨ˆç®—èšåˆ â† æœ¬é¡Œè€ƒé»
â””â”€â”€ Live Table         â†’ æ‰¹æ¬¡è™•ç†è³‡æ–™
```

### è¨˜æ†¶æŠ€å·§
- **Materialized** = ã€Œç‰©è³ªåŒ–ã€= å¯¦éš›å„²å­˜
- **View** = ã€Œè¦–åœ–ã€= åªæ˜¯çª—å£ï¼Œä¸å„²å­˜
- **Streaming** = ã€Œä¸²æµã€= è™•ç†æµå‹•è³‡æ–™

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶
- [Materialized views](https://docs.databricks.com/en/sql/user/materialized-views.html)
- [What are streaming tables and materialized views?](https://docs.databricks.com/en/lakeflow-declarative-pipelines/index.html)

---

**[è¿”å›é¡Œç›®](#question-041)**
