# Question #15

---

## 題目資訊

### 題目編號
**ID:** `Q-01-015`

### 來源
**來源:** Real Exam Recall

### 難度等級
**難度:** `L3-Advanced`

---

## 題目內容

### 題幹

A table in the Lakehouse named customer_churn_params is used in churn prediction by the machine learning team.

The table contains information about customers derived from a number of upstream sources.

Currently, the data engineering team populates this table nightly by overwriting the table with the current valid values derived from upstream data sources.

The churn prediction model used by the ML team is fairly stable in production.

The team is only interested in making predictions on records that have changed in the past 24 hours.

Which approach would simplify the identification of these changed records?

### 選項

- **A.** Apply the churn model to all rows in the customer_churn_params table, but implement logic to perform an upsert into the predictions table that ignores rows where predictions have not changed.
- **B.** Convert the batch job to a Structured Streaming job using the complete output mode; configure a Structured Streaming job to read from the customer_churn_params table and incrementally predict against the churn model.
- **C.** Calculate the difference between the previous model predictions and the current customer_churn_params on a key identifying unique customers before making new predictions; only make predictions on those customers not in the previous predictions.
- **D.** Modify the overwrite logic to include a field populated by calling spark.sql.functions.current_timestamp() as data are being written; use this field to identify records written on a particular date.
- **E.** Replace the current overwrite logic with a merge statement to modify only those records that have changed; write logic to make predictions on the changed records identified by the change data feed.

---

## 標籤系統

### Topic Tags (技術主題標籤)
**Topics:** `Change-Data-Feed`, `MERGE`, `ML-Integration`, `Incremental-Processing`

### Trap Tags (陷阱類型標籤)
**Traps:** `Change-Detection-Method`, `Overwrite-vs-Merge`

### Knowledge Domain (知識領域)
**Domain:** `Machine Learning`

---

## 答案與解析連結

### 正確答案
**正解:** `E`

### 解析檔案
**詳細解析:** [點此查看解析](../analysis/Q-01-015-analysis.md)

---

## 相關資源

### 官方文件
- [Change Data Feed](https://docs.databricks.com/delta/delta-change-data-feed.html)
- [Delta Lake with ML](https://docs.databricks.com/machine-learning/feature-store/time-series.html)
