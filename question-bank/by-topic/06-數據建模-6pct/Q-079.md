# Q-079 - Delta Lake å¤–éƒ¨è¡¨é…ç½®

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-079`

### ä¾†æº
**ä¾†æº:** Mock Exam

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

```
The data architect has mandated that all tables in the Lakehouse should be configured as external (also known as "unmanaged") Delta Lake tables.

Which approach will ensure that this requirement is met?
```

### é¸é …

- **A.** When a database is being created, make sure that the LOCATION keyword is used.
- **B.** When configuring an external data warehouse for all table storage, leverage Databricks for all ELT.
- **C.** When data is saved to a table, make sure that a full file path is specified alongside the Delta format.
- **D.** When tables are created, make sure that the EXTERNAL keyword is used in the CREATE TABLE statement.
- **E.** When the workspace is being configured, make sure that external cloud object storage has been mounted.

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Delta-Lake`, `Data-Modeling`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Concept-Confusion`, `Keyword-Confusion`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** `Data Modeling`

---

## ç­”æ¡ˆèˆ‡è§£æ

**æ­£è§£:** `C`

---

## ğŸ“ è€ƒé»è­˜åˆ¥

### ä¸»è¦è€ƒé»
**æ ¸å¿ƒæŠ€è¡“:** Delta Lake å¤–éƒ¨è¡¨ï¼ˆUnmanaged Tablesï¼‰
**çŸ¥è­˜é ˜åŸŸ:** æ•¸æ“šå»ºæ¨¡èˆ‡è¡¨æ ¼ç®¡ç†
**é—œéµæ¦‚å¿µ:** ç®¡ç†å¼è¡¨æ ¼ vs å¤–éƒ¨è¡¨æ ¼ã€LOCATION åƒæ•¸ã€è³‡æ–™å­˜å„²ä½ç½®

### æ¬¡è¦è€ƒé»
- Databricks Metastore çš„è³‡æ–™ç®¡ç†æ©Ÿåˆ¶
- è¡¨æ ¼åˆªé™¤æ™‚çš„è³‡æ–™ä¿è­·

---

## âœ… æ­£è§£èªªæ˜

### é¸é … C æ­£ç¢ºçš„åŸå› ï¼š

**ğŸ¯ å¤–éƒ¨è¡¨çš„æœ¬è³ªå®šç¾©**
- åœ¨ Delta Lake ä¸­ï¼Œå¤–éƒ¨è¡¨ï¼ˆunmanaged tableï¼‰çš„å®šç¾©æ ¸å¿ƒåœ¨æ–¼ã€Œ**è³‡æ–™å­˜å„²ä½ç½®**ã€
- ç•¶å„²å­˜è³‡æ–™æ™‚æŒ‡å®š**å®Œæ•´æª”æ¡ˆè·¯å¾‘**ï¼Œå°±èƒ½ç¢ºä¿è©²è¡¨æ ¼æˆç‚ºå¤–éƒ¨è¡¨
- é€™èˆ‡ SQL ä¸­ä½¿ç”¨ `LOCATION` å­å¥çš„æ•ˆæœç›¸åŒ

**ğŸ“ è³‡æ–™ç®¡ç†æ©Ÿåˆ¶**
```sql
-- å¤–éƒ¨è¡¨ç¯„ä¾‹ï¼šæŒ‡å®šå­˜å„²ä½ç½®
CREATE TABLE external_sales 
USING DELTA 
LOCATION '/mnt/data/sales/'

-- æˆ–é€é DataFrame API æŒ‡å®šè·¯å¾„
df.write.format("delta").mode("overwrite").save("/mnt/data/sales/")
```

**ğŸ”’ è³‡æ–™å®‰å…¨ä¿è­·**
- å¤–éƒ¨è¡¨ï¼šåŸ·è¡Œ `DROP TABLE` æ™‚ï¼Œ**åªåˆªé™¤ metadata**ï¼Œå¯¦éš›è³‡æ–™æª”æ¡ˆä¿ç•™
- ç®¡ç†å¼è¡¨ï¼šåŸ·è¡Œ `DROP TABLE` æ™‚ï¼Œ**åŒæ™‚åˆªé™¤ metadata å’Œå¯¦éš›è³‡æ–™**

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### é¸é … A: å»ºç«‹è³‡æ–™åº«æ™‚ä½¿ç”¨ LOCATION
**ç‚ºä»€éº¼éŒ¯èª¤ï¼š**
- `LOCATION` ç”¨æ–¼**å»ºç«‹è³‡æ–™åº«**æ™‚åªæ˜¯è¨­å®šé è¨­å­˜å„²è·¯å¾‘
- ä¸èƒ½ä¿è­‰**æ‰€æœ‰è¡¨æ ¼**éƒ½æˆç‚ºå¤–éƒ¨è¡¨
- è¡¨æ ¼æ˜¯å¦ç‚ºå¤–éƒ¨è¡¨å–æ±ºæ–¼å»ºç«‹è¡¨æ ¼æ™‚çš„è¨­å®š

### é¸é … B: é…ç½®å¤–éƒ¨è³‡æ–™å€‰å„²
**ç‚ºä»€éº¼éŒ¯èª¤ï¼š**
- æè¿°éæ–¼æ¨¡ç³Šï¼Œæ²’æœ‰å…·é«”çš„æŠ€è¡“å¯¦ä½œæ–¹æ³•
- ã€Œå¤–éƒ¨è³‡æ–™å€‰å„²ã€ä¸ç­‰åŒæ–¼ã€Œå¤–éƒ¨è¡¨æ ¼ã€æ¦‚å¿µ
- ELT ä½œæ¥­èˆ‡è¡¨æ ¼ç®¡ç†é¡å‹ç„¡ç›´æ¥é—œè¯

### é¸é … D: ä½¿ç”¨ EXTERNAL é—œéµå­—
**ç‚ºä»€éº¼éŒ¯èª¤ï¼š**
- **é™·é˜±è¨­è¨ˆï¼š** å…¶ä»– SQL ç³»çµ±ï¼ˆå¦‚ Hiveï¼‰ç¢ºå¯¦ä½¿ç”¨ `EXTERNAL` é—œéµå­—
- **Databricks å¯¦éš›èªæ³•ï¼š** ä¸ä½¿ç”¨ `EXTERNAL` é—œéµå­—ï¼Œè€Œæ˜¯é€é `LOCATION` åƒæ•¸
- é€™æ˜¯å…¸å‹çš„**èªæ³•æ··æ·†é™·é˜±**

### é¸é … E: æ›è¼‰å¤–éƒ¨é›²ç«¯å„²å­˜
**ç‚ºä»€éº¼éŒ¯èª¤ï¼š**
- æ›è¼‰å„²å­˜åªæ˜¯**å‰ç½®ä½œæ¥­**ï¼Œä¸ä¿è­‰è¡¨æ ¼é¡å‹
- å³ä½¿æ›è¼‰å¤–éƒ¨å„²å­˜ï¼Œè¡¨æ ¼ä¾ç„¶å¯èƒ½æ˜¯ç®¡ç†å¼è¡¨æ ¼
- è¡¨æ ¼é¡å‹ç”±**å»ºç«‹è¡¨æ ¼æ™‚çš„è¨­å®š**æ±ºå®šï¼Œè€Œéå„²å­˜æ›è¼‰ç‹€æ…‹

---

## ğŸ§  è¨˜æ†¶æ³•

### å£è¨£è¨˜æ†¶
**ã€Œå¤–éƒ¨è¡¨æ ¼çœ‹ä½ç½®ï¼ŒæŒ‡å®šè·¯å¾‘å°±æå®šã€**
- **å¤–éƒ¨** = éœ€è¦æ˜ç¢º**æŒ‡å®šä½ç½®**
- **è·¯å¾‘** = å®Œæ•´æª”æ¡ˆè·¯å¾‘æˆ– LOCATION åƒæ•¸

### æ¦‚å¿µå°æ¯”è¡¨

| æ¯”è¼ƒé …ç›® | ç®¡ç†å¼è¡¨æ ¼ (Managed) | å¤–éƒ¨è¡¨æ ¼ (Unmanaged) |
|----------|---------------------|----------------------|
| **å»ºç«‹æ–¹å¼** | ä¸æŒ‡å®š LOCATION | æŒ‡å®š LOCATION æˆ–å®Œæ•´è·¯å¾‘ |
| **è³‡æ–™å­˜æ”¾** | ç³»çµ±é è¨­ä½ç½® | ä½¿ç”¨è€…æŒ‡å®šä½ç½® |
| **DROP è¡Œç‚º** | åˆªé™¤ metadata + è³‡æ–™ | åªåˆªé™¤ metadata |
| **é©ç”¨å ´æ™¯** | é–‹ç™¼æ¸¬è©¦ | ç”Ÿç”¢ç’°å¢ƒã€è·¨ç³»çµ±å…±äº« |

### å¯¦å‹™è¨˜æ†¶é»
1. **ç”Ÿç”¢ç’°å¢ƒå»ºè­°ï¼š** ä½¿ç”¨å¤–éƒ¨è¡¨æ ¼ä¿è­·è³‡æ–™å®‰å…¨
2. **èªæ³•é‡é»ï¼š** Databricks ä¸ç”¨ `EXTERNAL` é—œéµå­—
3. **æ ¸å¿ƒåŸå‰‡ï¼š** æœ‰æŒ‡å®šä½ç½® = å¤–éƒ¨è¡¨æ ¼

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶åƒè€ƒ

### ä¸»è¦åƒè€ƒæ–‡ä»¶
- [Delta Lake Managed and Unmanaged Tables](https://docs.databricks.com/delta/table-details.html#managed-and-unmanaged-tables)
- [CREATE TABLE Syntax](https://docs.databricks.com/sql/language-manual/sql-ref-syntax-ddl-create-table.html)

### ç›¸é—œæ¦‚å¿µæ–‡ä»¶
- [Table Properties and Location](https://docs.databricks.com/delta/table-properties.html)
- [Data Governance Best Practices](https://docs.databricks.com/data-governance/index.html)

---

## ğŸ¯ è€ƒè©¦æŠ€å·§

### å‡ºé¡Œé™·é˜±è­˜åˆ¥
1. **èªæ³•é™·é˜±ï¼š** èˆ‡å…¶ä»– SQL ç³»çµ±çš„ EXTERNAL é—œéµå­—æ··æ·†
2. **æ¦‚å¿µé™·é˜±ï¼š** æ··æ·†è³‡æ–™åº« LOCATION èˆ‡è¡¨æ ¼ LOCATION çš„ä½œç”¨
3. **ç¯„åœé™·é˜±ï¼š** ä»¥ç‚ºå–®ä¸€è¨­å®šå°±èƒ½å½±éŸ¿æ‰€æœ‰è¡¨æ ¼é¡å‹

### è§£é¡Œç­–ç•¥
1. **é—œéµå­—è­˜åˆ¥ï¼š** çœ‹åˆ°ã€Œå¤–éƒ¨è¡¨æ ¼ã€ç«‹å³æ€è€ƒã€Œè³‡æ–™å­˜å„²ä½ç½®ã€
2. **èªæ³•é©—è­‰ï¼š** Databricks ä½¿ç”¨ LOCATION è€Œé EXTERNAL
3. **å¯¦å‹™æ‡‰ç”¨ï¼š** è€ƒæ…®ç”Ÿç”¢ç’°å¢ƒçš„è³‡æ–™å®‰å…¨éœ€æ±‚