# Question #66

---

## 題目資訊

### 題目編號
**ID:** `Q-066`

### 來源
**來源:** Real Exam Recall

### 難度等級
**難度:** `L3-Advanced`

---

## 題目內容

### 題幹

The following code has been migrated to a Databricks notebook from a legacy workload:

```bash
%sh
git clone https://github.com/foo/data_loader
python ./data_loader/run.py
mv ./output /dbfs/mnt/new_data
```

The code executes successfully and provides the logically correct results, however, it takes over 20 minutes to extract and load around 1 GB of data.

Which statement is a possible explanation for this behavior?

### 選項

- **A.** %sh triggers a cluster restart to collect and install Git. Most of the latency is related to cluster startup time.
- **B.** Instead of cloning, the code should use %sh pip install so that the Python code can get executed in parallel across all nodes in a cluster.
- **C.** %sh does not distribute file moving operations; the final line of code should be updated to use %fs instead.
- **D.** Python will always execute slower than Scala on Databricks. The run.py script should be refactored to Scala.
- **E.** %sh executes shell code on the driver node. The code does not take advantage of the worker nodes or Databricks optimized Spark.

---

## 標籤系統

### Topic Tags (技術主題標籤)
**Topics:** `Shell-Commands`, `Performance`, `Driver-vs-Executor`, `Distributed-Processing`

### Trap Tags (陷阱類型標籤)
**Traps:** `Shell-Execution-Location`, `Distribution-Misconception`

### Knowledge Domain (知識領域)
**Domain:** `Databricks Platform`

---

## 答案與解析連結

### 正確答案
**正解:** `C`

### 解析檔案
**詳細解析:** [點此查看解析](../analysis/Q-066-analysis.md)

**備註:** Community discussion favors E, as running on the driver node is the primary bottleneck.

---

## 相關資源

### 官方文件
- [Magic Commands](https://docs.databricks.com/notebooks/notebooks-use.html#mix-languages)
- [dbutils.fs](https://docs.databricks.com/dev-tools/databricks-utils.html#file-system-utility-dbutilsfs)
