# Q-EXAMPLE-001: Delta Lake VACUUM æŒ‡ä»¤ç¯„ä¾‹é¡Œç›®

> æ­¤ç‚ºç¯„ä¾‹é¡Œç›®ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ question-template.md å’Œ analysis-template.md

---

## é¡Œç›®è³‡è¨Š

### é¡Œç›®ç·¨è™Ÿ
**ID:** `Q-EXAMPLE-001`

### ä¾†æº
**ä¾†æº:** Official Practice Exam - Databricks Certified Data Engineer Associate

### é›£åº¦ç­‰ç´š
**é›£åº¦:** `L2-Intermediate`

---

## é¡Œç›®å…§å®¹

### é¡Œå¹¹

åœ¨ Delta Lake ä¸­ï¼Œæ‚¨éœ€è¦æ°¸ä¹…åˆªé™¤è¶…é 30 å¤©çš„èˆŠç‰ˆæœ¬è³‡æ–™ä»¥ç¯€çœå„²å­˜ç©ºé–“ã€‚ä»¥ä¸‹å“ªå€‹æŒ‡ä»¤å¯ä»¥é”æˆæ­¤ç›®çš„ï¼Ÿ

### é¸é …

- **A.** `VACUUM table_name RETAIN 30 HOURS`
- **B.** `VACUUM table_name RETAIN 720 HOURS`
- **C.** `DELETE FROM table_name WHERE _commit_timestamp < current_date() - 30`
- **D.** `OPTIMIZE table_name ZORDER BY (date_column)`

---

## æ¨™ç±¤ç³»çµ±

### Topic Tags (æŠ€è¡“ä¸»é¡Œæ¨™ç±¤)
**Topics:** `Delta-Lake`, `Data-Retention`, `Storage-Management`

### Trap Tags (é™·é˜±é¡å‹æ¨™ç±¤)
**Traps:** `Unit-Confusion`, `Number-Trap`

### Knowledge Domain (çŸ¥è­˜é ˜åŸŸ)
**Domain:** `Delta Lake`

---

## ç­”æ¡ˆèˆ‡è§£æ

### æ­£ç¢ºç­”æ¡ˆ
**æ­£è§£:** `B`

---

## ğŸ“ è€ƒé»è­˜åˆ¥

### ä¸»è¦è€ƒé»
**æ ¸å¿ƒæŠ€è¡“:** Delta Lake VACUUM æŒ‡ä»¤
**çŸ¥è­˜é ˜åŸŸ:** Delta Lake - Data Retention
**é—œéµæ¦‚å¿µ:**
- VACUUM çš„é è¨­ä¿ç•™æœŸé™
- æ™‚é–“å–®ä½æ›ç®— (HOURS)
- å„²å­˜ç©ºé–“ç®¡ç†

### æ¬¡è¦è€ƒé»
- VACUUM èˆ‡ DELETEã€OPTIMIZE çš„å·®ç•°
- Delta Lake ç‰ˆæœ¬ç®¡ç†æ©Ÿåˆ¶

---

## âœ… æ­£è§£èªªæ˜

### ç‚ºä»€éº¼ B (VACUUM table_name RETAIN 720 HOURS) æ˜¯æ­£ç¢ºçš„ï¼Ÿ

**æŠ€è¡“åŸç†:**
VACUUM æœƒæ°¸ä¹…åˆªé™¤ä¸å†è¢«ä»»ä½•ç‰ˆæœ¬åƒç…§çš„èˆŠè³‡æ–™æª”æ¡ˆã€‚RETAIN åƒæ•¸æŒ‡å®šè¦ä¿ç•™çš„æœ€å°æ™‚é–“é–¾å€¼ï¼Œé è¨­ç‚º 168 å°æ™‚ï¼ˆ7 å¤©ï¼‰ã€‚

**ç¬¦åˆéœ€æ±‚:**
é¡Œç›®è¦æ±‚ã€Œåˆªé™¤è¶…é 30 å¤©çš„èˆŠç‰ˆæœ¬ã€ï¼Œ30 å¤© = 30 Ã— 24 = 720 å°æ™‚ï¼Œå› æ­¤ `RETAIN 720 HOURS` æ­£ç¢ºã€‚

**å¯¦å‹™æ‡‰ç”¨:**
```sql
VACUUM my_table RETAIN 720 HOURS;  -- ä¿ç•™ 30 å¤©å…§çš„è³‡æ–™
```

åŸ·è¡Œå¾Œï¼Œ30 å¤©å‰çš„èˆŠç‰ˆæœ¬æª”æ¡ˆå°‡è¢«æ°¸ä¹…åˆªé™¤ï¼Œç„¡æ³•é€é Time Travel å¾©åŸã€‚

---

## âŒ éŒ¯èª¤é¸é …æ’é™¤

### é¸é … A - VACUUM table_name RETAIN 30 HOURS
**éŒ¯èª¤åŸå› :** æ™‚é–“å–®ä½æ›ç®—éŒ¯èª¤

**è©³ç´°åˆ†æ:**
æ­¤é¸é …åƒ…ä¿ç•™ 30 å°æ™‚ï¼ˆç´„ 1.25 å¤©ï¼‰çš„è³‡æ–™ï¼Œè€Œé 30 å¤©ã€‚
é€™æ˜¯å…¸å‹çš„ã€Œæ•¸å­—é™·é˜±ã€ï¼Œèª¤å°‡å¤©æ•¸ç›´æ¥ç•¶ä½œå°æ™‚æ•¸ä½¿ç”¨ã€‚

**æ˜“æ··æ·†é»:**
- é¡Œç›®ä¸­çš„ã€Œ30 å¤©ã€æ•¸å­—èˆ‡é¸é …ä¸­çš„ã€Œ30ã€æ•¸å­—ç›¸åŒï¼Œä½†å–®ä½ä¸åŒ
- VACUUM åªæ¥å— HOURS ä½œç‚ºå–®ä½ï¼Œéœ€è‡ªè¡Œæ›ç®—å¤©æ•¸

---

### é¸é … C - DELETE FROM table_name WHERE _commit_timestamp < current_date() - 30
**éŒ¯èª¤åŸå› :** æ··æ·†é‚è¼¯åˆªé™¤èˆ‡å¯¦é«”åˆªé™¤

**è©³ç´°åˆ†æ:**
1. DELETE åªæœƒæ¨™è¨˜è³‡æ–™ç‚ºåˆªé™¤ï¼ˆé‚è¼¯åˆªé™¤ï¼‰ï¼Œ**ä¸æœƒå¯¦éš›é‡‹æ”¾å„²å­˜ç©ºé–“**
2. `_commit_timestamp` ä¸æ˜¯æ¨™æº–æ¬„ä½ï¼Œç„¡æ³•ç›´æ¥ä½¿ç”¨
3. å³ä½¿åˆªé™¤æˆåŠŸï¼ŒèˆŠç‰ˆæœ¬æª”æ¡ˆä»ä¿ç•™ï¼Œéœ€é…åˆ VACUUM æ‰èƒ½æ¸…ç†

**æ˜“æ··æ·†é»:**
- DELETE: é‚è¼¯åˆªé™¤ï¼Œè³‡æ–™ä»å¯é€é Time Travel å¾©åŸ
- VACUUM: å¯¦é«”åˆªé™¤ï¼Œæ°¸ä¹…é‡‹æ”¾ç©ºé–“

---

### é¸é … D - OPTIMIZE table_name ZORDER BY (date_column)
**éŒ¯èª¤åŸå› :** æŒ‡ä»¤ç”¨é€”éŒ¯èª¤

**è©³ç´°åˆ†æ:**
OPTIMIZE ç”¨æ–¼åˆä½µå°æª”æ¡ˆèˆ‡é‡æ–°æ’åºè³‡æ–™ï¼ˆZ-Orderï¼‰ï¼Œ**ä¸æœƒåˆªé™¤èˆŠç‰ˆæœ¬æª”æ¡ˆ**ã€‚
æ­¤é¸é …æ··æ·†äº† OPTIMIZEï¼ˆæ•ˆèƒ½å„ªåŒ–ï¼‰èˆ‡ VACUUMï¼ˆç©ºé–“æ¸…ç†ï¼‰çš„ç”¨é€”ã€‚

**æ˜“æ··æ·†é»:**
å…©è€…éƒ½æ˜¯ Delta Lake ç¶­è­·æŒ‡ä»¤ï¼Œä½†ç›®çš„å®Œå…¨ä¸åŒï¼š
- OPTIMIZE: æå‡æŸ¥è©¢æ•ˆèƒ½ï¼ˆåˆä½µæª”æ¡ˆã€é‡æ–°æ’åºï¼‰
- VACUUM: é‡‹æ”¾å„²å­˜ç©ºé–“ï¼ˆåˆªé™¤èˆŠç‰ˆæœ¬ï¼‰

---

## ğŸ§  è¨˜æ†¶æ³•èˆ‡è§£é¡ŒæŠ€å·§

### è¨˜æ†¶å£è¨£
"**VACUUM å¸å¡µå™¨ï¼Œæ¸…ç†èˆŠæª”æ¡ˆï¼›RETAIN åŠ å°æ™‚ï¼Œå¤©æ•¸è¦ä¹˜ 24**"

### è§£é¡Œæ­¥é©Ÿ
1. **è­˜åˆ¥é—œéµå­—ã€Œæ°¸ä¹…åˆªé™¤ã€** â†’ æƒ³åˆ° VACUUM
2. **æ’é™¤æ˜é¡¯éŒ¯èª¤** â†’ DELETE (é‚è¼¯åˆªé™¤) å’Œ OPTIMIZE (æ•ˆèƒ½å„ªåŒ–)
3. **è¨ˆç®—æ™‚é–“** â†’ 30 å¤© Ã— 24 å°æ™‚ = 720 å°æ™‚
4. **é¸æ“‡æ­£è§£** â†’ VACUUM ... RETAIN 720 HOURS

### å¸¸è¦‹é™·é˜±è­¦ç¤º
âš ï¸ **é™·é˜± 1:** æ™‚é–“å–®ä½æ··æ·† - VACUUM åªæ¥å— HOURSï¼Œéœ€è‡ªè¡Œæ›ç®—
âš ï¸ **é™·é˜± 2:** æŒ‡ä»¤ç”¨é€”æ··æ·† - DELETEã€VACUUMã€OPTIMIZE åŠŸèƒ½å®Œå…¨ä¸åŒ
âš ï¸ **é™·é˜± 3:** æ•¸å­—é™·é˜± - é¡Œç›®ä¸­çš„æ•¸å­—å¯èƒ½èˆ‡é¸é …æ•¸å­—ç›¸åŒä½†å–®ä½ä¸åŒ

---

## ğŸ“š å®˜æ–¹æ–‡ä»¶èˆ‡å»¶ä¼¸é–±è®€

### å®˜æ–¹æ–‡ä»¶
1. **[VACUUM | Databricks Documentation](https://docs.databricks.com/sql/language-manual/delta-vacuum.html)** - VACUUM æŒ‡ä»¤çš„å®Œæ•´èªªæ˜èˆ‡åƒæ•¸
2. **[Delta Lake Data Retention](https://docs.databricks.com/delta/history.html)** - Delta Lake ç‰ˆæœ¬ç®¡ç†æ©Ÿåˆ¶

### å»¶ä¼¸é–±è®€
- [Delta Lake Best Practices](https://docs.databricks.com/delta/best-practices.html)

### ç›¸é—œé¡Œç›®
- `Q-DELTA-018` - Delta Lake Time Travel åŠŸèƒ½
- `Q-DELTA-031` - OPTIMIZE èˆ‡ ZORDER æ•ˆèƒ½èª¿æ ¡

---

## ğŸ·ï¸ æ¨™ç±¤èˆ‡åˆ†é¡

**Topics:** `Delta-Lake`, `Data-Retention`, `Storage-Management`
**Traps:** `Unit-Confusion`, `Number-Trap`
**Difficulty:** `L2-Intermediate`

---

## ğŸ“Š å­¸ç¿’è¿½è¹¤ (é¸å¡«)

### å€‹äººç­†è¨˜
- åˆæ¬¡ä½œç­”: âœ… æ­£ç¢º / âŒ éŒ¯èª¤
- éŒ¯èª¤åŸå› : [ç‚ºä»€éº¼ç•¶æ™‚é¸éŒ¯]
- è¤‡ç¿’æ¬¡æ•¸: [X æ¬¡]
- æŒæ¡ç‹€æ…‹: ğŸ”´ ä¸ç†Ÿæ‚‰ / ğŸŸ¡ éƒ¨åˆ†æŒæ¡ / ğŸŸ¢ å·²ç²¾é€š

---

**æ­¤ç¯„ä¾‹é¡Œç›®å±•ç¤ºå¦‚ä½•ä½¿ç”¨ question-template.md å’Œ analysis-template.md å»ºç«‹æ¨™æº–åŒ–çš„é¡Œç›®èˆ‡è§£æã€‚**
