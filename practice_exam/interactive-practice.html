<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Databricks å¼±é»å¼·åŒ–ç·´ç¿’ ğŸ’ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.3);
            height: 10px;
            border-radius: 5px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: white;
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .stat-box {
            text-align: center;
            flex: 1;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            display: block;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .question-area {
            padding: 40px 30px;
        }

        .question-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .question-number {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 10px;
            margin-right: 15px;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }

        .question-topic {
            background: #e7f5ff;
            color: #1971c2;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .question-text {
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 30px;
            color: #2c3e50;
        }

        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            margin: 20px 0;
            overflow-x: auto;
            border-left: 4px solid #61dafb;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        .option {
            background: #f8f9fa;
            border: 3px solid #dee2e6;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .option::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.1), transparent);
            transition: width 0.3s ease;
        }

        .option:hover {
            transform: translateX(5px);
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .option:hover::before {
            width: 100%;
        }

        .option-label {
            display: inline-block;
            background: #667eea;
            color: white;
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 8px;
            margin-right: 15px;
            min-width: 30px;
            text-align: center;
        }

        .option.selected {
            border-color: #667eea;
            background: #e7f5ff;
        }

        .option.correct {
            border-color: #51cf66;
            background: #d3f9d8;
            animation: correctPulse 0.6s ease;
        }

        .option.wrong {
            border-color: #ff6b6b;
            background: #ffe3e3;
            animation: shake 0.5s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .result-badge {
            display: none;
            float: right;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .result-badge.show {
            display: inline-block;
        }

        .result-badge.correct {
            background: #51cf66;
            color: white;
        }

        .result-badge.wrong {
            background: #ff6b6b;
            color: white;
        }

        .explanation {
            display: none;
            background: #fff9db;
            border-left: 5px solid #ffd43b;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            animation: slideDown 0.4s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 1000px;
            }
        }

        .explanation.show {
            display: block;
        }

        .explanation h3 {
            color: #e67700;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .explanation-content {
            line-height: 1.8;
            color: #495057;
        }

        .key-concept {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #4dabf7;
        }

        .memory-tip {
            background: linear-gradient(135deg, #ffd8a8 0%, #ffc078 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-weight: 500;
        }

        .memory-tip::before {
            content: "ğŸ’¡ ";
            font-size: 1.5em;
        }

        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: space-between;
        }

        .btn {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-submit {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-next {
            background: linear-gradient(135deg, #51cf66, #37b24d);
            color: white;
        }

        .btn-prev {
            background: #e9ecef;
            color: #495057;
        }

        .completion {
            display: none;
            text-align: center;
            padding: 60px 30px;
        }

        .completion.show {
            display: block;
            animation: slideIn 0.6s ease;
        }

        .completion-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: bounce 1s ease infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .completion h2 {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 20px;
        }

        .final-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
        }

        .final-stat {
            text-align: center;
        }

        .final-stat-number {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
        }

        .final-stat-label {
            color: #6c757d;
            margin-top: 10px;
        }

        .btn-restart {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            margin-top: 30px;
        }

        .topic-badge {
            display: inline-block;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 500;
        }

        .topic-delta { background: #ffe3e3; color: #c92a2a; }
        .topic-streaming { background: #d0ebff; color: #1864ab; }
        .topic-monitoring { background: #d3f9d8; color: #2b8a3e; }
        .topic-security { background: #ffec99; color: #e67700; }
        .topic-mlflow { background: #fcc2d7; color: #a61e4d; }
        .topic-jobs { background: #e7f5ff; color: #1971c2; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ Databricks å¼±é»å¼·åŒ–ç·´ç¿’</h1>
            <p>å°ˆæ³¨æ–¼ä½ ä¸ç†Ÿæ‚‰çš„é¡Œç›®ï¼ŒåŠ å¼·è¨˜æ†¶èˆ‡ç†è§£</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-box">
                <span class="stat-number" id="currentQuestion">1</span>
                <div class="stat-label">ç›®å‰é¡Œè™Ÿ</div>
            </div>
            <div class="stat-box">
                <span class="stat-number" id="totalQuestions">8</span>
                <div class="stat-label">ç¸½é¡Œæ•¸</div>
            </div>
            <div class="stat-box">
                <span class="stat-number" id="correctCount">0</span>
                <div class="stat-label">ç­”å°æ•¸</div>
            </div>
            <div class="stat-box">
                <span class="stat-number" id="accuracy">0%</span>
                <div class="stat-label">æ­£ç¢ºç‡</div>
            </div>
        </div>

        <div class="question-area" id="questionArea">
            <!-- Questions will be loaded here -->
        </div>

        <div class="completion" id="completion">
            <div class="completion-icon">ğŸ‰</div>
            <h2>æ­å–œå®Œæˆç·´ç¿’ï¼</h2>
            <div class="final-stats">
                <div class="final-stat">
                    <div class="final-stat-number" id="finalCorrect">0</div>
                    <div class="final-stat-label">ç­”å°é¡Œæ•¸</div>
                </div>
                <div class="final-stat">
                    <div class="final-stat-number" id="finalAccuracy">0%</div>
                    <div class="final-stat-label">æ­£ç¢ºç‡</div>
                </div>
            </div>
            <p style="font-size: 1.2em; color: #495057; margin: 20px 0;">
                å»ºè­°ï¼šé‡å°ç­”éŒ¯çš„é¡Œç›®ï¼Œé‡æ–°é–±è®€å®˜æ–¹æ–‡ä»¶èˆ‡è§£æï¼Œä¸¦åšç­†è¨˜å¼·åŒ–è¨˜æ†¶ï¼
            </p>
            <button class="btn btn-restart" onclick="restartQuiz()">é‡æ–°ç·´ç¿’</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                id: "Q-092",
                number: 1,
                topic: "Table Cloning & VACUUM",
                topics: ["Delta Lake", "VACUUM", "Table Cloning"],
                topicClasses: ["topic-delta"],
                question: "ç‚ºäº†é˜²æ­¢æ„å¤–æäº¤åˆ°ç”Ÿç”¢è³‡æ–™ï¼Œè³‡æ·±è³‡æ–™å·¥ç¨‹å¸«åˆ¶å®šäº†ä¸€é …æ”¿ç­–ï¼šæ‰€æœ‰é–‹ç™¼å·¥ä½œéƒ½å°‡åƒè€ƒ Delta Lake è¡¨çš„å…‹éš†ã€‚æ¸¬è©¦äº† DEEP å’Œ SHALLOW CLONE å¾Œï¼Œé–‹ç™¼è¡¨ä½¿ç”¨ SHALLOW CLONE å»ºç«‹ã€‚<br><br>åœ¨åˆå§‹è¡¨å»ºç«‹å¹¾é€±å¾Œï¼Œå¹¾å€‹å¯¦ä½œç‚º Type 1 SCD çš„å…‹éš†è¡¨åœæ­¢å·¥ä½œã€‚ä¾†æºè¡¨çš„äº‹å‹™æ—¥èªŒé¡¯ç¤ºå‰ä¸€å¤©åŸ·è¡Œäº† VACUUMã€‚<br><br>å“ªå€‹é™³è¿°æè¿°äº†å…‹éš†è¡¨ä¸å†å·¥ä½œçš„åŸå› ï¼Ÿ",
                options: [
                    { label: "A", text: "å› ç‚º Type 1 è®Šæ›´æœƒè¦†å¯«ç¾æœ‰è¨˜éŒ„ï¼ŒDelta Lake ç„¡æ³•ä¿è­‰å…‹éš†è¡¨çš„è³‡æ–™ä¸€è‡´æ€§ã€‚" },
                    { label: "B", text: "åŸ·è¡Œ VACUUM æœƒè‡ªå‹•ä½¿è¡¨çš„ä»»ä½•æ·ºå…‹éš†å¤±æ•ˆï¼›ç•¶å…‹éš†è¡¨éœ€è¦é‡è¤‡æŸ¥è©¢æ™‚ï¼Œæ‡‰å§‹çµ‚ä½¿ç”¨ DEEP CLONEã€‚" },
                    { label: "C", text: "ä½¿ç”¨ SHALLOW CLONE å»ºç«‹çš„è¡¨æœƒåœ¨é è¨­ä¿ç•™é–¾å€¼ 7 å¤©å¾Œè‡ªå‹•åˆªé™¤ã€‚" },
                    { label: "D", text: "CLONE æ“ä½œå»ºç«‹çš„ metadata å¼•ç”¨çš„è³‡æ–™æª”æ¡ˆè¢« VACUUM æŒ‡ä»¤æ¸…é™¤äº†ã€‚", correct: true },
                    { label: "E", text: "VACUUM å£“ç¸®çš„è³‡æ–™æª”æ¡ˆæœªè¢«å…‹éš†çš„ metadata è¿½è¹¤ï¼›åœ¨å…‹éš†è¡¨ä¸ŠåŸ·è¡Œ REFRESH å°‡æ‹‰å–æœ€è¿‘çš„è®Šæ›´ã€‚" }
                ],
                correctAnswer: "D",
                explanation: `
                    <h3>ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ</h3>
                    <div class="key-concept">
                        <strong>SHALLOW CLONE çš„é‹ä½œæ©Ÿåˆ¶ï¼š</strong><br>
                        â€¢ SHALLOW CLONE åªè¤‡è£½ metadataï¼ˆäº¤æ˜“æ—¥èªŒï¼‰ï¼Œä¸è¤‡è£½è³‡æ–™æª”æ¡ˆ<br>
                        â€¢ å…‹éš†è¡¨å¼•ç”¨ä¾†æºè¡¨çš„è³‡æ–™æª”æ¡ˆï¼ˆpointer referenceï¼‰<br>
                        â€¢ ç•¶ä¾†æºè¡¨çš„è³‡æ–™æª”æ¡ˆè¢«åˆªé™¤æ™‚ï¼Œå…‹éš†è¡¨æœƒå¤±æ•ˆ
                    </div>
                    
                    <div class="key-concept">
                        <strong>VACUUM çš„å½±éŸ¿ï¼š</strong><br>
                        â€¢ VACUUM åˆªé™¤ä¸å†è¢«ä¾†æºè¡¨å¼•ç”¨çš„èˆŠè³‡æ–™æª”æ¡ˆ<br>
                        â€¢ VACUUM <strong>ä¸çŸ¥é“ SHALLOW CLONE çš„å­˜åœ¨</strong><br>
                        â€¢ å› æ­¤æœƒèª¤åˆª shallow clone éœ€è¦çš„æª”æ¡ˆ
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶å£è¨£ï¼š</strong><br>
                        ã€ŒSHALLOW = åªæœ‰å½±å­ï¼ˆmetadataï¼‰ï¼ŒVACUUM æ¸…æƒæ™‚ä¸æœƒçœ‹å½±å­çš„éœ€æ±‚ã€<br><br>
                        <strong>å°æ¯”ï¼š</strong><br>
                        â€¢ SHALLOW CLONE = ç§Ÿæˆ¿ï¼ˆåƒè€ƒåˆ¥äººçš„æª”æ¡ˆï¼‰<br>
                        â€¢ DEEP CLONE = è²·æˆ¿ï¼ˆè‡ªå·±çš„æª”æ¡ˆå‰¯æœ¬ï¼‰<br>
                        æˆ¿æ±ï¼ˆä¾†æºè¡¨ï¼‰æ¸…ç†åƒåœ¾æ™‚ï¼Œä¸æœƒè€ƒæ…®ç§Ÿå®¢ï¼ˆshallow cloneï¼‰æ˜¯å¦é‚„åœ¨ç”¨ï¼
                    </div>
                `,
                link: "Q-092"
            },
            {
                id: "Q-093",
                number: 2,
                topic: "Stream-Static Join",
                topics: ["Streaming", "Spark Joins"],
                topicClasses: ["topic-streaming"],
                question: "ä½ æ­£åœ¨åŸ·è¡Œä¸€å€‹ join æ“ä½œï¼Œå°‡éœæ…‹ <code>userLookup</code> è¡¨çš„å€¼èˆ‡ä¸²æµ DataFrame <code>streamingDF</code> çµåˆã€‚<br><br>å“ªå€‹ç¨‹å¼ç¢¼å€å¡Šå˜—è©¦åŸ·è¡Œ<strong>ç„¡æ•ˆçš„</strong> stream-static joinï¼Ÿ",
                options: [
                    { label: "A", text: "<code>userLookup.join(streamingDF, ['userid'], how='inner')</code>" },
                    { label: "B", text: "<code>streamingDF.join(userLookup, ['user_id'], how='outer')</code>", correct: true },
                    { label: "C", text: "<code>streamingDF.join(userLookup, ['user_id'], how='left')</code>" },
                    { label: "D", text: "<code>streamingDF.join(streamingDF, ['userid'], how='inner')</code>" },
                    { label: "E", text: "<code>userLookup.join(streamingDF, ['user_id'], how='right')</code>" }
                ],
                correctAnswer: "B",
                explanation: `
                    <h3>ğŸ¯ Structured Streaming Join æ”¯æ´çŸ©é™£</h3>
                    <div class="key-concept">
                        <strong>Stream-Static Join æ”¯æ´çš„é¡å‹ï¼š</strong><br>
                        âœ… Stream LEFT JOIN Staticï¼ˆStream ä¿ç•™æ‰€æœ‰è¨˜éŒ„ï¼‰<br>
                        âœ… Stream INNER JOIN Static<br>
                        âœ… Static RIGHT JOIN Streamï¼ˆç­‰åŒæ–¼ä¸Šé¢çš„ Stream LEFT JOINï¼‰<br>
                        âœ… Static INNER JOIN Stream<br>
                        <br>
                        âŒ Stream RIGHT JOIN Staticï¼ˆä¸æ”¯æ´ï¼‰<br>
                        âŒ Stream FULL OUTER JOIN Staticï¼ˆä¸æ”¯æ´ï¼‰<br>
                        âŒ Static LEFT JOIN Streamï¼ˆä¸æ”¯æ´ï¼‰<br>
                        âŒ Static FULL OUTER JOIN Streamï¼ˆä¸æ”¯æ´ï¼‰
                    </div>
                    
                    <div class="key-concept">
                        <strong>ç‚ºä½•ä¸æ”¯æ´ OUTER JOINï¼Ÿ</strong><br>
                        â€¢ Streaming æ˜¯ç„¡ç•Œçš„ï¼ˆè³‡æ–™æŒçºŒæµå…¥ï¼‰<br>
                        â€¢ OUTER JOIN éœ€è¦ã€ŒçŸ¥é“æ‰€æœ‰è³‡æ–™ã€æ‰èƒ½æ±ºå®šæœªåŒ¹é…è¨˜éŒ„<br>
                        â€¢ ç„¡æ³•ç¢ºå®šéœæ…‹è³‡æ–™ã€Œæ°¸é ä¸æœƒã€èˆ‡æœªä¾†ä¸²æµè³‡æ–™åŒ¹é…<br>
                        â€¢ State ç®¡ç†è¤‡é›œåº¦èˆ‡è¨˜æ†¶é«”æˆæœ¬ç„¡æ³•æ‰¿å—
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶æ³•ï¼š</strong><br>
                        ã€Œä¸²æµåªèƒ½ä¿ç•™<strong>è‡ªå·±</strong>çš„è¨˜éŒ„ï¼ˆLEFTï¼‰ï¼Œä¸èƒ½ä¿ç•™<strong>åˆ¥äºº</strong>çš„è¨˜éŒ„ï¼ˆRIGHT/OUTERï¼‰ã€<br><br>
                        æƒ³åƒä¸²æµæ˜¯ä¸€æ¢æ²³æµï¼Œåªèƒ½å¸¶èµ°è‡ªå·±çš„æ±è¥¿ï¼Œä¸èƒ½å›é ­æ’ˆéœæ…‹æ¹–æ³Šçš„æ±è¥¿ï¼
                    </div>
                `,
                link: "Q-093"
            },
            {
                id: "Q-094",
                number: 3,
                topic: "Spill è¨ºæ–·",
                topics: ["Monitoring", "Performance"],
                topicClasses: ["topic-monitoring"],
                question: "Spill æ˜¯åŸ·è¡Œå„ç¨®å¯¬è½‰æ›ï¼ˆwide transformationsï¼‰çš„çµæœã€‚ç„¶è€Œï¼Œè¨ºæ–· spill éœ€è¦ä¸»å‹•æŸ¥æ‰¾é—œéµæŒ‡æ¨™ã€‚<br><br>åœ¨ Spark UI ä¸­çš„å“ªè£¡å¯ä»¥æ‰¾åˆ° partition æº¢å‡ºåˆ°ç£ç¢Ÿçš„å…©å€‹ä¸»è¦æŒ‡æ¨™ï¼Ÿ",
                options: [
                    { label: "A", text: "Query's detail screen å’Œ Job's detail screen" },
                    { label: "B", text: "Stage's detail screen å’Œ Executor's log files", correct: true },
                    { label: "C", text: "Driver's å’Œ Executor's log files" },
                    { label: "D", text: "Executor's detail screen å’Œ Executor's log files" },
                    { label: "E", text: "Stage's detail screen å’Œ Query's detail screen" }
                ],
                correctAnswer: "B",
                explanation: `
                    <h3>ğŸ¯ è¨ºæ–· Spill çš„å…©å€‹é—œéµä½ç½®</h3>
                    <div class="key-concept">
                        <strong>ä½ç½® 1: Stage Detail Screen</strong><br>
                        è·¯å¾‘ï¼šSpark UI â†’ Jobs â†’ [Job ID] â†’ [Stage ID]<br><br>
                        é—œéµæŒ‡æ¨™ï¼š<br>
                        â€¢ Shuffle Spill (Memory) - è¨˜æ†¶é«”æº¢å‡ºé‡<br>
                        â€¢ Shuffle Spill (Disk) - å¯«å…¥ç£ç¢Ÿé‡<br>
                        â€¢ å¯çœ‹åˆ° Min/Median/Max å€¼ï¼Œè­˜åˆ¥å“ªäº› partition æœ‰å•é¡Œ
                    </div>
                    
                    <div class="key-concept">
                        <strong>ä½ç½® 2: Executor Log Files</strong><br>
                        è·¯å¾‘ï¼šSpark UI â†’ Executors â†’ [Executor ID] â†’ View Logs<br><br>
                        å…¸å‹è¨Šæ¯ï¼š<br>
                        â€¢ <code>INFO ExternalSorter: Thread 123 spilling in-memory map of 128.0 MB to disk</code><br>
                        â€¢ <code>WARN ShuffleExternalSorter: Spilling data because...</code><br>
                        â€¢ æä¾›è©³ç´°çš„ spill åŸå› èˆ‡è³‡æ–™é‡
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶å£è¨£ï¼š</strong><br>
                        ã€ŒStage çœ‹<strong>æ•¸å­—</strong>ï¼ˆé‡åŒ–æŒ‡æ¨™ï¼‰ï¼ŒLog çœ‹<strong>åŸå› </strong>ï¼ˆè©³ç´°è¨Šæ¯ï¼‰ã€<br><br>
                        Stage = é«”æª¢å ±å‘Šçš„æ•¸å€¼ï¼ˆè¡€å£“ã€è¡€ç³–ï¼‰<br>
                        Log = é†«ç”Ÿçš„è¨ºæ–·èªªæ˜ï¼ˆç‚ºä»€éº¼é«˜ã€æ€éº¼æ²»ç™‚ï¼‰
                    </div>
                `,
                link: "Q-094"
            },
            {
                id: "Q-100",
                number: 4,
                topic: "Secrets æ¬Šé™ç®¡ç†",
                topics: ["Security", "Access Control", "Secrets"],
                topicClasses: ["topic-security"],
                question: "è³‡æ–™å·¥ç¨‹åœ˜éšŠè¢«è¦æ±‚è¨­å®šé€£æ¥åˆ°å¤–éƒ¨è³‡æ–™åº«ï¼ˆè©²è³‡æ–™åº«æ²’æœ‰ Databricks åŸç”Ÿé€£æ¥å™¨ï¼‰ã€‚å¤–éƒ¨è³‡æ–™åº«å·²é€éç¾¤çµ„æˆå“¡èº«ä»½é…ç½®è³‡æ–™å®‰å…¨æ€§ã€‚é€™äº›ç¾¤çµ„ç›´æ¥å°æ‡‰åˆ° Databricks ä¸­å·²å»ºç«‹çš„ä½¿ç”¨è€…ç¾¤çµ„ã€‚<br><br>å·²ç‚ºå¤–éƒ¨è³‡æ–™åº«ä¸­çš„æ¯å€‹ç¾¤çµ„å»ºç«‹æ–°çš„ç™»å…¥æ†‘è­‰ã€‚å°‡ä½¿ç”¨ Databricks Utilities Secrets æ¨¡çµ„ä½¿é€™äº›æ†‘è­‰å¯ä¾› Databricks ä½¿ç”¨è€…ä½¿ç”¨ã€‚<br><br>å‡è¨­æ‰€æœ‰æ†‘è­‰åœ¨å¤–éƒ¨è³‡æ–™åº«ä¸Šé…ç½®æ­£ç¢ºï¼Œä¸” Databricks ä¸Šçš„ç¾¤çµ„æˆå“¡èº«ä»½é…ç½®æ­£ç¢ºï¼Œå“ªå€‹é™³è¿°æè¿°äº†å¦‚ä½•æˆäºˆåœ˜éšŠ<strong>æœ€å°å¿…è¦å­˜å–æ¬Šé™</strong>ä¾†ä½¿ç”¨é€™äº›æ†‘è­‰ï¼Ÿ",
                options: [
                    { label: "A", text: "æ‡‰åœ¨å°æ‡‰çµ¦å®šåœ˜éšŠå°‡ä½¿ç”¨çš„æ†‘è­‰çš„ secret key ä¸Šè¨­å®šã€ŒManageã€æ¬Šé™ã€‚" },
                    { label: "B", text: "æ‡‰åœ¨å°æ‡‰çµ¦å®šåœ˜éšŠå°‡ä½¿ç”¨çš„æ†‘è­‰çš„ secret key ä¸Šè¨­å®šã€ŒReadã€æ¬Šé™ã€‚" },
                    { label: "C", text: "æ‡‰åœ¨åƒ…åŒ…å«çµ¦å®šåœ˜éšŠå°‡ä½¿ç”¨çš„æ†‘è­‰çš„ secret scope ä¸Šè¨­å®šã€ŒReadã€æ¬Šé™ã€‚", correct: true },
                    { label: "D", text: "æ‡‰åœ¨åƒ…åŒ…å«çµ¦å®šåœ˜éšŠå°‡ä½¿ç”¨çš„æ†‘è­‰çš„ secret scope ä¸Šè¨­å®šã€ŒManageã€æ¬Šé™ã€‚" },
                    { label: "E", text: "åªè¦æ‰€æœ‰ä½¿ç”¨è€…åœ¨å·²æ–°å¢ secrets çš„å·¥ä½œå€ä¸­é…ç½®ç‚ºç®¡ç†å“¡ï¼Œå°±ä¸éœ€è¦é¡å¤–é…ç½®ã€‚" }
                ],
                correctAnswer: "C",
                explanation: `
                    <h3>ğŸ¯ Databricks Secrets æ¬Šé™æ¶æ§‹</h3>
                    <div class="key-concept">
                        <strong>é—œéµäº‹å¯¦ï¼š</strong><br>
                        âœ… å¯ä»¥å° <strong>Secret Scope</strong> è¨­å®šæ¬Šé™<br>
                        âŒ <strong>ä¸èƒ½</strong>å°å–®ä¸€ <strong>Secret Key</strong> è¨­å®šæ¬Šé™<br><br>
                        æ¬Šé™é¡å‹ï¼š<br>
                        â€¢ READ - è®€å– scope å…§çš„æ‰€æœ‰ secrets<br>
                        â€¢ WRITE - æ–°å¢/ä¿®æ”¹ scope å…§çš„ secrets<br>
                        â€¢ MANAGE - ç®¡ç† scopeï¼ˆåŒ…å« READ + WRITE + æ¬Šé™ç®¡ç†ï¼‰
                    </div>
                    
                    <div class="key-concept">
                        <strong>æœ€å°æ¬Šé™åŸå‰‡ï¼š</strong><br>
                        1. ç‚ºæ¯å€‹åœ˜éšŠå»ºç«‹<strong>ç¨ç«‹çš„ Secret Scope</strong><br>
                        2. è©² scope åªåŒ…å«è©²åœ˜éšŠéœ€è¦çš„æ†‘è­‰<br>
                        3. æˆäºˆåœ˜éšŠ <strong>READ</strong> æ¬Šé™ï¼ˆä½¿ç”¨ secretsï¼Œä¸éœ€ä¿®æ”¹ï¼‰<br>
                        4. åœ˜éšŠç„¡æ³•å­˜å–å…¶ä»–åœ˜éšŠçš„ secrets
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶æ³•ï¼š</strong><br>
                        ã€ŒSecret Scope = ä¿éšªç®±ï¼ŒKey = è£¡é¢çš„æ–‡ä»¶ã€<br>
                        ä½ åªèƒ½æ§åˆ¶èª°èƒ½æ‰“é–‹<strong>æ•´å€‹ä¿éšªç®±</strong>ï¼ˆScopeï¼‰ï¼Œ<br>
                        ä¸èƒ½æ§åˆ¶èª°èƒ½çœ‹ä¿éšªç®±è£¡çš„<strong>ç‰¹å®šæ–‡ä»¶</strong>ï¼ˆKeyï¼‰ï¼<br><br>
                        æ¶æ§‹è¨­è¨ˆï¼šä¸€å€‹åœ˜éšŠ = ä¸€å€‹ Scopeï¼ˆéš”é›¢ï¼‰+ READ æ¬Šé™ï¼ˆæœ€å°ï¼‰
                    </div>
                `,
                link: "Q-100"
            },
            {
                id: "Q-102",
                number: 5,
                topic: "Notebook æª”æ¡ˆæ ¼å¼",
                topics: ["Notebooks", "Development"],
                topicClasses: ["topic-security"],
                question: "ç•¶åœ¨æ–‡å­—ç·¨è¼¯å™¨ä¸­æŸ¥çœ‹ Databricks Python notebook æ™‚ï¼Œç¬¬ä¸€è¡Œæ˜¯ä»€éº¼ï¼Ÿ",
                options: [
                    { label: "A", text: "<code>%python</code>" },
                    { label: "B", text: "<code>// Databricks notebook source</code>" },
                    { label: "C", text: "<code># Databricks notebook source</code>", correct: true },
                    { label: "D", text: "<code>- Databricks notebook source</code>" },
                    { label: "E", text: "<code># MAGIC %python</code>" }
                ],
                correctAnswer: "C",
                explanation: `
                    <h3>ğŸ¯ Databricks Notebook æª”æ¡ˆæ ¼å¼</h3>
                    <div class="key-concept">
                        <strong>ä¸åŒèªè¨€çš„ç¬¬ä¸€è¡Œï¼š</strong><br>
                        â€¢ Python notebook: <code># Databricks notebook source</code><br>
                        â€¢ Scala notebook: <code>// Databricks notebook source</code><br>
                        â€¢ SQL notebook: <code>-- Databricks notebook source</code><br>
                        â€¢ R notebook: <code># Databricks notebook source</code><br><br>
                        ä½¿ç”¨å°æ‡‰èªè¨€çš„è¨»è§£ç¬¦è™Ÿï¼Œç¢ºä¿å¯ä½œç‚ºç´”ç¨‹å¼ç¢¼åŸ·è¡Œ
                    </div>
                    
                    <div class="key-concept">
                        <strong>é€™å€‹æ¨™è¨˜çš„ä½œç”¨ï¼š</strong><br>
                        ğŸ·ï¸ è­˜åˆ¥ Notebook é¡å‹ - å‘Šè¨´ Databricks é€™æ˜¯ notebook æª”æ¡ˆ<br>
                        ğŸ”§ èªæ³•ç¬¦åˆ Python - ä¸æœƒå½±éŸ¿ç¨‹å¼ç¢¼åŸ·è¡Œ<br>
                        ğŸŒ³ ç‰ˆæœ¬æ§åˆ¶å‹å–„ - Git å¯æ­£ç¢ºè™•ç†ç‚ºåŸå§‹ç¢¼
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶æ³•ï¼š</strong><br>
                        ã€Œ<code>#</code> = Python è¨»è§£ï¼Œ<code>%</code> = Cell Magicã€<br><br>
                        â€¢ æª”æ¡ˆç¬¬ä¸€è¡Œ = å‘Šè¨´ç³»çµ±ã€Œæˆ‘æ˜¯èª°ã€â†’ ç”¨è¨»è§£ <code>#</code><br>
                        â€¢ Cell å…§åˆ‡æ›èªè¨€ = å‘Šè¨´ Sparkã€Œé€™å€‹ cell ç”¨ä»€éº¼ã€â†’ ç”¨ magic <code>%</code><br><br>
                        èº«ä»½è­‰ï¼ˆæª”æ¡ˆï¼‰vs è‡¨æ™‚è­‰ï¼ˆcellï¼‰çš„æ¦‚å¿µï¼
                    </div>
                `,
                link: "Q-102"
            },
            {
                id: "Q-104",
                number: 6,
                topic: "Job ID vs Run ID",
                topics: ["Jobs", "Automation", "CLI"],
                topicClasses: ["topic-jobs"],
                question: "ä½¿ç”¨ Databricks CLI é€éå‚³é <code>job_id</code> åƒæ•¸ä¾†è§¸ç™¼ç¾æœ‰ä½œæ¥­çš„åŸ·è¡Œã€‚ä½œæ¥­åŸ·è¡Œè«‹æ±‚æˆåŠŸæäº¤çš„å›æ‡‰åŒ…å«ä¸€å€‹ <code>run_id</code> æ¬„ä½ã€‚<br><br>å“ªå€‹é™³è¿°æè¿°äº†è©²æ¬„ä½æ—é‚Šçš„æ•¸å­—ä»£è¡¨ä»€éº¼ï¼Ÿ",
                options: [
                    { label: "A", text: "job_id å’Œä½œæ¥­åŸ·è¡Œæ¬¡æ•¸è¢«ä¸²æ¥ä¸¦è¿”å›ã€‚" },
                    { label: "B", text: "å·¥ä½œå€ä¸­å·²åŸ·è¡Œçš„ä½œæ¥­ç¸½æ•¸ã€‚" },
                    { label: "C", text: "ä½œæ¥­å®šç¾©åœ¨æ­¤å·¥ä½œå€ä¸­è¢«åŸ·è¡Œçš„æ¬¡æ•¸ã€‚" },
                    { label: "D", text: "job_id åœ¨æ­¤æ¬„ä½ä¸­è¿”å›ã€‚" },
                    { label: "E", text: "æ–°è§¸ç™¼åŸ·è¡Œçš„å…¨åŸŸå”¯ä¸€ IDã€‚", correct: true }
                ],
                correctAnswer: "E",
                explanation: `
                    <h3>ğŸ¯ Job ID vs Run ID çš„æ ¸å¿ƒå·®ç•°</h3>
                    <div class="key-concept">
                        <table style="width:100%; border-collapse: collapse;">
                            <tr style="background:#e7f5ff;">
                                <th style="padding:10px; border:1px solid #dee2e6;">æ¦‚å¿µ</th>
                                <th style="padding:10px; border:1px solid #dee2e6;">job_id</th>
                                <th style="padding:10px; border:1px solid #dee2e6;">run_id</th>
                            </tr>
                            <tr>
                                <td style="padding:10px; border:1px solid #dee2e6;"><strong>å®šç¾©</strong></td>
                                <td style="padding:10px; border:1px solid #dee2e6;">Job <strong>å®šç¾©</strong>çš„ ID</td>
                                <td style="padding:10px; border:1px solid #dee2e6;">Job <strong>åŸ·è¡Œå¯¦ä¾‹</strong>çš„ ID</td>
                            </tr>
                            <tr>
                                <td style="padding:10px; border:1px solid #dee2e6;"><strong>ç”¢ç”Ÿæ™‚æ©Ÿ</strong></td>
                                <td style="padding:10px; border:1px solid #dee2e6;">å»ºç«‹ Job æ™‚</td>
                                <td style="padding:10px; border:1px solid #dee2e6;">æ¯æ¬¡åŸ·è¡Œæ™‚</td>
                            </tr>
                            <tr>
                                <td style="padding:10px; border:1px solid #dee2e6;"><strong>å”¯ä¸€æ€§</strong></td>
                                <td style="padding:10px; border:1px solid #dee2e6;">æ°¸ä¹…ä¸è®Š</td>
                                <td style="padding:10px; border:1px solid #dee2e6;">å…¨åŸŸå”¯ä¸€ï¼Œæ¯æ¬¡ä¸åŒ</td>
                            </tr>
                            <tr>
                                <td style="padding:10px; border:1px solid #dee2e6;"><strong>ç”¨é€”</strong></td>
                                <td style="padding:10px; border:1px solid #dee2e6;">è§¸ç™¼ Job</td>
                                <td style="padding:10px; border:1px solid #dee2e6;">è¿½è¹¤ç‰¹å®šåŸ·è¡Œ</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="key-concept">
                        <strong>run_id çš„ç‰¹æ€§ï¼š</strong><br>
                        âœ… <strong>å…¨åŸŸå”¯ä¸€</strong> - æ•´å€‹ Workspace ä¸­å”¯ä¸€<br>
                        âœ… ç”¨æ–¼æŸ¥è©¢ã€ç›£æ§ã€å–æ¶ˆç‰¹å®šåŸ·è¡Œ<br>
                        âœ… æ¯æ¬¡åŸ·è¡Œéƒ½ä¸åŒï¼ˆå³ä½¿æ˜¯åŒä¸€å€‹ Jobï¼‰
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶æ³•ï¼š</strong><br>
                        ã€ŒJob = é£Ÿè­œï¼ˆRecipeï¼‰ï¼ŒRun = æ¯æ¬¡ç…®çš„èœï¼ˆDishï¼‰ã€<br><br>
                        â€¢ job_id = é£Ÿè­œç·¨è™Ÿï¼ˆæ°¸ä¹…ä¸è®Šï¼‰<br>
                        â€¢ run_id = æ¯æ¬¡ç…®çš„èœçš„ç·¨è™Ÿï¼ˆæ¯æ¬¡éƒ½æ–°çš„ï¼‰<br><br>
                        åŒä¸€å€‹é£Ÿè­œå¯ä»¥ç…®å¾ˆå¤šæ¬¡ï¼Œæ¯æ¬¡ç…®çš„èœéƒ½æœ‰ç¨ç‰¹çš„è­˜åˆ¥ï¼
                    </div>
                `,
                link: "Q-104"
            },
            {
                id: "Q-105",
                number: 7,
                topic: "MLflow Model as UDF",
                topics: ["MLflow", "Machine Learning", "Spark UDF"],
                topicClasses: ["topic-mlflow"],
                question: "è³‡æ–™ç§‘å­¸åœ˜éšŠä½¿ç”¨ MLflow å»ºç«‹ä¸¦è¨˜éŒ„äº†ä¸€å€‹ç”Ÿç”¢æ¨¡å‹ã€‚è©²æ¨¡å‹æ¥å—æ¬„ä½åç¨±åˆ—è¡¨ä¸¦è¿”å› DOUBLE é¡å‹çš„æ–°æ¬„ä½ã€‚<br><br>ä»¥ä¸‹ç¨‹å¼ç¢¼æ­£ç¢ºåŒ¯å…¥ç”Ÿç”¢æ¨¡å‹ï¼Œå°‡åŒ…å« <code>customer_id</code> éµæ¬„ä½çš„ customers è¡¨è¼‰å…¥ DataFrameï¼Œä¸¦å®šç¾©æ¨¡å‹æ‰€éœ€çš„ç‰¹å¾µæ¬„ä½ã€‚<br><br><div class='code-block'>model = mlflow.pyfunc.spark_udf(spark, model_uri=\"models:/churn/prod\")<br>df = spark.table(\"customers\")<br>columns = [\"account_age\", \"time_since_last_seen\", \"app_rating\"]</div><br>å“ªå€‹ç¨‹å¼ç¢¼å€å¡Šå°‡è¼¸å‡º schema ç‚º \"customer_id LONG, predictions DOUBLE\" çš„ DataFrameï¼Ÿ",
                options: [
                    { label: "A", text: "<code>df.map(lambda x:model(x[columns])).select(\"customer_id, predictions\")</code>" },
                    { label: "B", text: "<code>df.select(\"customer_id\", model(*columns).alias(\"predictions\"))</code>", correct: true },
                    { label: "C", text: "<code>model.predict(df, columns)</code>" },
                    { label: "D", text: "<code>df.select(\"customer_id\", pandas_udf(model, columns).alias(\"predictions\"))</code>" },
                    { label: "E", text: "<code>df.apply(model, columns).select(\"customer_id, predictions\")</code>" }
                ],
                correctAnswer: "B",
                explanation: `
                    <h3>ğŸ¯ MLflow Spark UDF çš„ä½¿ç”¨æ–¹å¼</h3>
                    <div class="key-concept">
                        <strong>é—œéµç†è§£ï¼š</strong><br>
                        â€¢ <code>mlflow.pyfunc.spark_udf()</code> è¿”å›çš„ <code>model</code> <strong>å°±æ˜¯ä¸€å€‹ Spark UDF</strong><br>
                        â€¢ å¯ä»¥ç›´æ¥åœ¨ <code>select()</code> ä¸­å‘¼å«<br>
                        â€¢ <strong>ä¸éœ€è¦</strong>é¡å¤–çš„ <code>pandas_udf()</code> åŒ…è£
                    </div>
                    
                    <div class="key-concept">
                        <strong>å±•é–‹èªæ³•ï¼ˆ*columnsï¼‰çš„ä½œç”¨ï¼š</strong><br>
                        <code>columns = ["account_age", "time_since_last_seen", "app_rating"]</code><br><br>
                        <code>model(*columns)</code> å±•é–‹ç‚ºï¼š<br>
                        <code>model("account_age", "time_since_last_seen", "app_rating")</code><br><br>
                        UDF æ¥æ”¶ä¸‰å€‹ç¨ç«‹çš„æ¬„ä½ä½œç‚ºè¼¸å…¥ï¼Œå°æ¯ä¸€è¡ŒåŸ·è¡Œé æ¸¬
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶æ³•ï¼š</strong><br>
                        ã€Œ<code>*columns</code> = æ‰“é–‹åŒ…è£¹ï¼ˆunpackï¼‰ï¼ŒæŠŠåˆ—è¡¨è®Šæˆåƒæ•¸ã€<br><br>
                        æƒ³åƒï¼š<br>
                        â€¢ <code>columns</code> = ä¸€å€‹ç®±å­è£äº†ä¸‰å€‹è˜‹æœ<br>
                        â€¢ <code>*columns</code> = æ‰“é–‹ç®±å­ï¼ŒæŠŠä¸‰å€‹è˜‹æœåˆ†åˆ¥æ‹¿å‡ºä¾†<br><br>
                        MLflow UDF éœ€è¦ã€Œåˆ†é–‹çš„è˜‹æœã€ï¼Œä¸æ˜¯ã€Œè£åœ¨ç®±å­è£¡çš„è˜‹æœã€ï¼
                    </div>
                `,
                link: "Q-105"
            },
            {
                id: "Q-106",
                number: 8,
                topic: "å¢é‡è™•ç†æˆæœ¬å„ªåŒ–",
                topics: ["Delta Lake", "Streaming", "Cost Optimization"],
                topicClasses: ["topic-delta", "topic-streaming"],
                question: "ä¸€å€‹å¤œé–“æ‰¹æ¬¡ä½œæ¥­é…ç½®ç‚ºå¾é›²ç«¯ç‰©ä»¶å„²å­˜å®¹å™¨æ”å–æ‰€æœ‰è³‡æ–™æª”æ¡ˆï¼Œè¨˜éŒ„å„²å­˜åœ¨å·¢ç‹€ç›®éŒ„çµæ§‹ <code>YYYY/MM/DD</code> ä¸­ã€‚æ¯å€‹æ—¥æœŸçš„è³‡æ–™ä»£è¡¨ä¾†æºç³»çµ±åœ¨è©²æ—¥æœŸè™•ç†çš„æ‰€æœ‰è¨˜éŒ„ï¼Œ<strong>æ³¨æ„æŸäº›è¨˜éŒ„å¯èƒ½å› ç­‰å¾…å¯©æ ¸è€…æ‰¹å‡†è€Œå»¶é²</strong>ã€‚<br><br>æ¯å€‹æ¢ç›®ä»£è¡¨ä½¿ç”¨è€…å°ç”¢å“çš„è©•è«–ï¼Œschema ç‚ºï¼š<div class='code-block'>user_id STRING, review_id BIGINT, product_id BIGINT, review_timestamp TIMESTAMP, review_text STRING</div><br>æ”å–ä½œæ¥­é…ç½®ç‚ºå°‡å‰ä¸€å¤©çš„æ‰€æœ‰è³‡æ–™ append åˆ°ç›®æ¨™è¡¨ <code>reviews_raw</code>ã€‚ç®¡é“ä¸­çš„ä¸‹ä¸€æ­¥æ˜¯æ‰¹æ¬¡å¯«å…¥ï¼Œå°‡æ’å…¥åˆ° <code>reviews_raw</code> çš„æ‰€æœ‰æ–°è¨˜éŒ„å‚³æ’­åˆ°è³‡æ–™å®Œå…¨å»é‡ã€é©—è­‰å’Œè±å¯Œçš„è¡¨ã€‚<br><br>å“ªå€‹æ–¹æ¡ˆ<strong>æœ€å°åŒ–é‹ç®—æˆæœ¬</strong>ä¾†å‚³æ’­é€™æ‰¹è³‡æ–™ï¼Ÿ",
                options: [
                    { label: "A", text: "å° reviews_raw è¡¨åŸ·è¡Œæ‰¹æ¬¡è®€å–ï¼Œä¸¦ä½¿ç”¨è‡ªç„¶è¤‡åˆéµ user_id, review_id, product_id, review_timestamp åŸ·è¡Œ insert-only mergeã€‚" },
                    { label: "B", text: "é…ç½®å° reviews_raw è¡¨çš„ Structured Streaming è®€å–ï¼Œä½¿ç”¨ trigger once åŸ·è¡Œæ¨¡å¼å°‡æ–°è¨˜éŒ„ä½œç‚ºæ‰¹æ¬¡ä½œæ¥­è™•ç†ã€‚", correct: true },
                    { label: "C", text: "ä½¿ç”¨ Delta Lake ç‰ˆæœ¬æ­·å²å–å¾— reviews_raw æœ€æ–°ç‰ˆæœ¬èˆ‡å‰ä¸€å€‹ç‰ˆæœ¬ä¹‹é–“çš„å·®ç•°ï¼Œç„¶å¾Œå°‡é€™äº›è¨˜éŒ„å¯«å…¥ä¸‹ä¸€å€‹è¡¨ã€‚" },
                    { label: "D", text: "æ ¹æ“š review_timestamp ç¯©é¸ reviews_raw è¡¨ä¸­çš„æ‰€æœ‰è¨˜éŒ„ï¼›æ‰¹æ¬¡ append éå» 48 å°æ™‚ç”¢ç”Ÿçš„è¨˜éŒ„ã€‚" },
                    { label: "E", text: "é‡æ–°è™•ç† reviews_raw ä¸­çš„æ‰€æœ‰è¨˜éŒ„ä¸¦è¦†å¯«ç®¡é“ä¸­çš„ä¸‹ä¸€å€‹è¡¨ã€‚" }
                ],
                correctAnswer: "B",
                explanation: `
                    <h3>ğŸ¯ Structured Streaming + Trigger.Once çš„å„ªå‹¢</h3>
                    <div class="key-concept">
                        <strong>ç‚ºä»€éº¼é¸é … B æ˜¯æœ€ä½³æ–¹æ¡ˆï¼Ÿ</strong><br><br>
                        âœ… <strong>è‡ªå‹•å¢é‡è¿½è¹¤</strong> - Checkpoint è‡ªå‹•è¨˜éŒ„å·²è™•ç†çš„è³‡æ–™<br>
                        âœ… <strong>æœ€å°è³‡æ–™æƒæ</strong> - åªè®€å–è‡ªä¸Šæ¬¡åŸ·è¡Œå¾Œæ–°å¢çš„æª”æ¡ˆ<br>
                        âœ… <strong>æˆæœ¬æœ€ä½</strong> - ä¸éœ€å…¨è¡¨æƒæã€ä¸éœ€ç‰ˆæœ¬æ¯”å°ã€ä¸éœ€è¤‡é›œ MERGE<br>
                        âœ… <strong>å¯é‡è¤‡åŸ·è¡Œ</strong> - Exactly-once èªç¾©ï¼Œå¤±æ•—å¯é‡è©¦<br>
                        âœ… <strong>æ‰¹æ¬¡åŸ·è¡Œ</strong> - Trigger.Once è®“ä¸²æµä»¥æ‰¹æ¬¡æ¨¡å¼åŸ·è¡Œ
                    </div>
                    
                    <div class="key-concept">
                        <strong>å¢é‡è™•ç†æ©Ÿåˆ¶ï¼š</strong><br>
                        Day 1: reviews_raw æœ‰ 1000 ç­† â†’ è™•ç† 1000 ç­†<br>
                        Day 2: æ–°å¢ 500 ç­† â†’ <strong>åªè®€å– 500 ç­†</strong> â† æˆæœ¬æœ€ä½ï¼<br>
                        Day 3: æ–°å¢ 300 ç­† â†’ <strong>åªè®€å– 300 ç­†</strong><br><br>
                        Checkpoint è‡ªå‹•è¿½è¹¤é€²åº¦ï¼Œç„¡éœ€æ‰‹å‹•ç®¡ç†
                    </div>
                    
                    <div class="memory-tip">
                        <strong>è¨˜æ†¶æ³•ï¼š</strong><br>
                        ã€ŒTrigger.Once = è°æ˜çš„æ›¸ç±¤ã€<br><br>
                        â€¢ è‡ªå‹•è¨˜ä½ä¸Šæ¬¡è®€åˆ°å“ªè£¡ï¼ˆcheckpointï¼‰<br>
                        â€¢ æ¯æ¬¡åªè®€æ–°å¢çš„éƒ¨åˆ†ï¼ˆå¢é‡ï¼‰<br>
                        â€¢ ä¸æœƒé‡è¤‡è®€èˆŠè³‡æ–™ï¼ˆæˆæœ¬æœ€ä½ï¼‰<br><br>
                        å°±åƒçœ‹æ›¸ç”¨æ›¸ç±¤ï¼Œä¸ç”¨æ¯æ¬¡å¾é ­ç¿»ï¼
                    </div>
                `,
                link: "Q-106"
            }
        ];

        let currentQuestionIndex = 0;
        let answers = [];
        let correctCount = 0;

        function loadQuestion(index) {
            const q = questions[index];
            const questionArea = document.getElementById('questionArea');
            
            let topicBadges = '';
            q.topics.forEach((topic, i) => {
                topicBadges += `<span class="topic-badge ${q.topicClasses[i] || 'topic-delta'}">${topic}</span>`;
            });

            questionArea.innerHTML = `
                <div class="question-header">
                    <div class="question-number">é¡Œç›® ${q.number}</div>
                    <div class="question-topic">${q.topic}</div>
                </div>
                <div style="margin-bottom: 15px;">${topicBadges}</div>
                <div class="question-text">${q.question}</div>
                <div class="options" id="options">
                    ${q.options.map((opt, i) => `
                        <div class="option" data-index="${i}" onclick="selectOption(${i})">
                            <span class="option-label">${opt.label}</span>
                            ${opt.text}
                            <span class="result-badge" id="badge-${i}"></span>
                        </div>
                    `).join('')}
                </div>
                <div class="explanation" id="explanation">
                    ${q.explanation}
                </div>
                <div class="buttons">
                    <button class="btn btn-prev" onclick="prevQuestion()" ${index === 0 ? 'disabled' : ''}>
                        â† ä¸Šä¸€é¡Œ
                    </button>
                    <button class="btn btn-submit" id="submitBtn" onclick="submitAnswer()">
                        ç¢ºèªç­”æ¡ˆ
                    </button>
                    <button class="btn btn-next" id="nextBtn" onclick="nextQuestion()" style="display:none;">
                        ä¸‹ä¸€é¡Œ â†’
                    </button>
                </div>
            `;

            // Restore previous answer if any
            if (answers[index] !== undefined) {
                const options = document.querySelectorAll('.option');
                options[answers[index]].classList.add('selected');
                showResult(answers[index], true);
            }

            updateStats();
        }

        function selectOption(index) {
            if (answers[currentQuestionIndex] !== undefined) return; // Already answered

            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[index].classList.add('selected');
        }

        function submitAnswer() {
            const selectedOption = document.querySelector('.option.selected');
            if (!selectedOption) {
                alert('è«‹é¸æ“‡ä¸€å€‹ç­”æ¡ˆï¼');
                return;
            }

            const selectedIndex = parseInt(selectedOption.dataset.index);
            answers[currentQuestionIndex] = selectedIndex;

            showResult(selectedIndex, false);
        }

        function showResult(selectedIndex, skipAnimation) {
            const q = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.option');
            const isCorrect = q.options[selectedIndex].correct;

            options.forEach((opt, i) => {
                opt.style.pointerEvents = 'none';
                const badge = document.getElementById(`badge-${i}`);
                
                if (q.options[i].correct) {
                    if (!skipAnimation) opt.classList.add('correct');
                    badge.textContent = 'âœ“ æ­£ç¢º';
                    badge.classList.add('show', 'correct');
                } else if (i === selectedIndex) {
                    if (!skipAnimation) opt.classList.add('wrong');
                    badge.textContent = 'âœ— éŒ¯èª¤';
                    badge.classList.add('show', 'wrong');
                }
            });

            if (isCorrect && answers.filter((a, i) => i === currentQuestionIndex).length === 1) {
                correctCount++;
            }

            document.getElementById('explanation').classList.add('show');
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';

            updateStats();
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            } else {
                showCompletion();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
        }

        function updateStats() {
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('correctCount').textContent = correctCount;
            
            const answeredCount = answers.filter(a => a !== undefined).length;
            const accuracy = answeredCount > 0 ? Math.round((correctCount / answeredCount) * 100) : 0;
            document.getElementById('accuracy').textContent = accuracy + '%';
            
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function showCompletion() {
            document.getElementById('questionArea').style.display = 'none';
            const completion = document.getElementById('completion');
            completion.classList.add('show');

            const accuracy = Math.round((correctCount / questions.length) * 100);
            document.getElementById('finalCorrect').textContent = `${correctCount}/${questions.length}`;
            document.getElementById('finalAccuracy').textContent = accuracy + '%';
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            answers = [];
            correctCount = 0;
            
            document.getElementById('questionArea').style.display = 'block';
            document.getElementById('completion').classList.remove('show');
            
            loadQuestion(0);
            updateStats();
        }

        // Initialize
        loadQuestion(0);
    </script>
</body>
</html>